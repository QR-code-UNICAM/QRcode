{"remainingRequest":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\src\\components\\bpmnProcessDesigner\\package\\penal\\task\\task-components\\ReceiveTask.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\src\\components\\bpmnProcessDesigner\\package\\penal\\task\\task-components\\ReceiveTask.vue","mtime":1704630437728},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\babel.config.js","mtime":1704630437199},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7CnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIik7CnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoLmpzIik7CnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5maWx0ZXIuanMiKTsKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmZ1bmN0aW9uLm5hbWUuanMiKTsKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnB1c2guanMiKTsKdmFyIF9kZWZhdWx0ID0gZXhwb3J0cy5kZWZhdWx0ID0gewogIG5hbWU6ICJSZWNlaXZlVGFzayIsCiAgcHJvcHM6IHsKICAgIGlkOiBTdHJpbmcsCiAgICB0eXBlOiBTdHJpbmcKICB9LAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBiaW5kTWVzc2FnZUlkOiAiIiwKICAgICAgbmV3TWVzc2FnZUZvcm06IHt9LAogICAgICBtZXNzYWdlTWFwOiB7fSwKICAgICAgbWVzc2FnZU1vZGVsVmlzaWJsZTogZmFsc2UKICAgIH07CiAgfSwKICB3YXRjaDogewogICAgaWQ6IHsKICAgICAgaW1tZWRpYXRlOiB0cnVlLAogICAgICBoYW5kbGVyOiBmdW5jdGlvbiBoYW5kbGVyKCkgewogICAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgICAgdGhpcy4kbmV4dFRpY2soZnVuY3Rpb24gKCkgewogICAgICAgICAgcmV0dXJuIF90aGlzLmdldEJpbmRNZXNzYWdlKCk7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICB9LAogIGNyZWF0ZWQ6IGZ1bmN0aW9uIGNyZWF0ZWQoKSB7CiAgICB2YXIgX3RoaXMyID0gdGhpczsKICAgIHRoaXMuYnBtbk1lc3NhZ2VSZWZzTWFwID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKICAgIHRoaXMuYnBtblJvb3RFbGVtZW50cyA9IHdpbmRvdy5icG1uSW5zdGFuY2VzLm1vZGVsZXIuZ2V0RGVmaW5pdGlvbnMoKS5yb290RWxlbWVudHM7CiAgICB0aGlzLmJwbW5Sb290RWxlbWVudHMuZmlsdGVyKGZ1bmN0aW9uIChlbCkgewogICAgICByZXR1cm4gZWwuJHR5cGUgPT09ICJicG1uOk1lc3NhZ2UiOwogICAgfSkuZm9yRWFjaChmdW5jdGlvbiAobSkgewogICAgICBfdGhpczIuYnBtbk1lc3NhZ2VSZWZzTWFwW20uaWRdID0gbTsKICAgICAgX3RoaXMyLiRzZXQoX3RoaXMyLm1lc3NhZ2VNYXAsIG0uaWQsIG0ubmFtZSk7CiAgICB9KTsKICAgIHRoaXMuJHNldCh0aGlzLm1lc3NhZ2VNYXAsICItMSIsICLml6AiKTsgLy8g5re75Yqg5LiA5Liq56m65a+56LGh77yM5L+d6K+B5Y+v5Lul5Y+W5raI5Y6f5raI5oGv57uR5a6aCiAgfSwKICBtZXRob2RzOiB7CiAgICBnZXRCaW5kTWVzc2FnZTogZnVuY3Rpb24gZ2V0QmluZE1lc3NhZ2UoKSB7CiAgICAgIHZhciBfdGhpcyRicG1uRWxlbWVudCRidXM7CiAgICAgIHRoaXMuYnBtbkVsZW1lbnQgPSB3aW5kb3cuYnBtbkluc3RhbmNlcy5icG1uRWxlbWVudDsKICAgICAgdGhpcy5iaW5kTWVzc2FnZUlkID0gKChfdGhpcyRicG1uRWxlbWVudCRidXMgPSB0aGlzLmJwbW5FbGVtZW50LmJ1c2luZXNzT2JqZWN0KSA9PT0gbnVsbCB8fCBfdGhpcyRicG1uRWxlbWVudCRidXMgPT09IHZvaWQgMCB8fCAoX3RoaXMkYnBtbkVsZW1lbnQkYnVzID0gX3RoaXMkYnBtbkVsZW1lbnQkYnVzLm1lc3NhZ2VSZWYpID09PSBudWxsIHx8IF90aGlzJGJwbW5FbGVtZW50JGJ1cyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXMkYnBtbkVsZW1lbnQkYnVzLmlkKSB8fCAiLTEiOwogICAgfSwKICAgIG9wZW5NZXNzYWdlTW9kZWw6IGZ1bmN0aW9uIG9wZW5NZXNzYWdlTW9kZWwoKSB7CiAgICAgIHRoaXMubWVzc2FnZU1vZGVsVmlzaWJsZSA9IHRydWU7CiAgICAgIHRoaXMubmV3TWVzc2FnZUZvcm0gPSB7fTsKICAgIH0sCiAgICBjcmVhdGVOZXdNZXNzYWdlOiBmdW5jdGlvbiBjcmVhdGVOZXdNZXNzYWdlKCkgewogICAgICBpZiAodGhpcy5tZXNzYWdlTWFwW3RoaXMubmV3TWVzc2FnZUZvcm0uaWRdKSB7CiAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcigi6K+l5raI5oGv5bey5a2Y5Zyo77yM6K+35L+u5pS5aWTlkI7ph43mlrDkv53lrZgiKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgdmFyIG5ld01lc3NhZ2UgPSB3aW5kb3cuYnBtbkluc3RhbmNlcy5tb2RkbGUuY3JlYXRlKCJicG1uOk1lc3NhZ2UiLCB0aGlzLm5ld01lc3NhZ2VGb3JtKTsKICAgICAgdGhpcy5icG1uUm9vdEVsZW1lbnRzLnB1c2gobmV3TWVzc2FnZSk7CiAgICAgIHRoaXMuJHNldCh0aGlzLm1lc3NhZ2VNYXAsIHRoaXMubmV3TWVzc2FnZUZvcm0uaWQsIHRoaXMubmV3TWVzc2FnZUZvcm0ubmFtZSk7CiAgICAgIHRoaXMuYnBtbk1lc3NhZ2VSZWZzTWFwW3RoaXMubmV3TWVzc2FnZUZvcm0uaWRdID0gbmV3TWVzc2FnZTsKICAgICAgdGhpcy5tZXNzYWdlTW9kZWxWaXNpYmxlID0gZmFsc2U7CiAgICB9LAogICAgdXBkYXRlVGFza01lc3NhZ2U6IGZ1bmN0aW9uIHVwZGF0ZVRhc2tNZXNzYWdlKG1lc3NhZ2VJZCkgewogICAgICBpZiAobWVzc2FnZUlkID09PSAiLTEiKSB7CiAgICAgICAgd2luZG93LmJwbW5JbnN0YW5jZXMubW9kZWxpbmcudXBkYXRlUHJvcGVydGllcyh0aGlzLmJwbW5FbGVtZW50LCB7CiAgICAgICAgICBtZXNzYWdlUmVmOiBudWxsCiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgd2luZG93LmJwbW5JbnN0YW5jZXMubW9kZWxpbmcudXBkYXRlUHJvcGVydGllcyh0aGlzLmJwbW5FbGVtZW50LCB7CiAgICAgICAgICBtZXNzYWdlUmVmOiB0aGlzLmJwbW5NZXNzYWdlUmVmc01hcFttZXNzYWdlSWRdCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICB9LAogIGJlZm9yZURlc3Ryb3k6IGZ1bmN0aW9uIGJlZm9yZURlc3Ryb3koKSB7CiAgICB0aGlzLmJwbW5FbGVtZW50ID0gbnVsbDsKICB9Cn07"},{"version":3,"names":["name","props","id","String","type","data","bindMessageId","newMessageForm","messageMap","messageModelVisible","watch","immediate","handler","_this","$nextTick","getBindMessage","created","_this2","bpmnMessageRefsMap","Object","create","bpmnRootElements","window","bpmnInstances","modeler","getDefinitions","rootElements","filter","el","$type","forEach","m","$set","methods","_this$bpmnElement$bus","bpmnElement","businessObject","messageRef","openMessageModel","createNewMessage","$message","error","newMessage","moddle","push","updateTaskMessage","messageId","modeling","updateProperties","beforeDestroy"],"sources":["src/components/bpmnProcessDesigner/package/penal/task/task-components/ReceiveTask.vue"],"sourcesContent":["<template>\r\n  <div style=\"margin-top: 16px\">\r\n    <el-form-item label=\"消息实例\">\r\n      <div style=\"display: flex; align-items: center; justify-content: space-between; flex-wrap: nowrap\">\r\n        <el-select v-model=\"bindMessageId\" @change=\"updateTaskMessage\">\r\n          <el-option v-for=\"id in Object.keys(messageMap)\" :value=\"id\" :label=\"messageMap[id]\" :key=\"id\" />\r\n        </el-select>\r\n        <el-button size=\"mini\" type=\"primary\" icon=\"el-icon-plus\" style=\"margin-left: 8px\" @click=\"openMessageModel\" />\r\n      </div>\r\n    </el-form-item>\r\n    <el-dialog :visible.sync=\"messageModelVisible\" :close-on-click-modal=\"false\" title=\"创建新消息\" width=\"400px\" append-to-body destroy-on-close>\r\n      <el-form :model=\"newMessageForm\" size=\"mini\" label-width=\"90px\" @submit.native.prevent>\r\n        <el-form-item label=\"消息ID\">\r\n          <el-input v-model=\"newMessageForm.id\" clearable />\r\n        </el-form-item>\r\n        <el-form-item label=\"消息名称\">\r\n          <el-input v-model=\"newMessageForm.name\" clearable />\r\n        </el-form-item>\r\n      </el-form>\r\n      <template slot=\"footer\">\r\n        <el-button size=\"mini\" type=\"primary\" @click=\"createNewMessage\">确 认</el-button>\r\n      </template>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: \"ReceiveTask\",\r\n  props: {\r\n    id: String,\r\n    type: String\r\n  },\r\n  data() {\r\n    return {\r\n      bindMessageId: \"\",\r\n      newMessageForm: {},\r\n      messageMap: {},\r\n      messageModelVisible: false\r\n    };\r\n  },\r\n  watch: {\r\n    id: {\r\n      immediate: true,\r\n      handler() {\r\n        this.$nextTick(() => this.getBindMessage());\r\n      }\r\n    }\r\n  },\r\n  created() {\r\n    this.bpmnMessageRefsMap = Object.create(null);\r\n    this.bpmnRootElements = window.bpmnInstances.modeler.getDefinitions().rootElements;\r\n    this.bpmnRootElements\r\n      .filter(el => el.$type === \"bpmn:Message\")\r\n      .forEach(m => {\r\n        this.bpmnMessageRefsMap[m.id] = m;\r\n        this.$set(this.messageMap, m.id, m.name);\r\n      });\r\n    this.$set(this.messageMap, \"-1\", \"无\"); // 添加一个空对象，保证可以取消原消息绑定\r\n  },\r\n  methods: {\r\n    getBindMessage() {\r\n      this.bpmnElement = window.bpmnInstances.bpmnElement;\r\n      this.bindMessageId = this.bpmnElement.businessObject?.messageRef?.id || \"-1\";\r\n    },\r\n    openMessageModel() {\r\n      this.messageModelVisible = true;\r\n      this.newMessageForm = {};\r\n    },\r\n    createNewMessage() {\r\n      if (this.messageMap[this.newMessageForm.id]) {\r\n        this.$message.error(\"该消息已存在，请修改id后重新保存\");\r\n        return;\r\n      }\r\n      const newMessage = window.bpmnInstances.moddle.create(\"bpmn:Message\", this.newMessageForm);\r\n      this.bpmnRootElements.push(newMessage);\r\n      this.$set(this.messageMap, this.newMessageForm.id, this.newMessageForm.name);\r\n      this.bpmnMessageRefsMap[this.newMessageForm.id] = newMessage;\r\n      this.messageModelVisible = false;\r\n    },\r\n    updateTaskMessage(messageId) {\r\n      if (messageId === \"-1\") {\r\n        window.bpmnInstances.modeling.updateProperties(this.bpmnElement, {\r\n          messageRef: null\r\n        });\r\n      } else {\r\n        window.bpmnInstances.modeling.updateProperties(this.bpmnElement, {\r\n          messageRef: this.bpmnMessageRefsMap[messageId]\r\n        });\r\n      }\r\n    }\r\n  },\r\n  beforeDestroy() {\r\n    this.bpmnElement = null;\r\n  }\r\n};\r\n</script>\r\n"],"mappings":";;;;;;;;;;;iCA2BA;EACAA,IAAA;EACAC,KAAA;IACAC,EAAA,EAAAC,MAAA;IACAC,IAAA,EAAAD;EACA;EACAE,IAAA,WAAAA,KAAA;IACA;MACAC,aAAA;MACAC,cAAA;MACAC,UAAA;MACAC,mBAAA;IACA;EACA;EACAC,KAAA;IACAR,EAAA;MACAS,SAAA;MACAC,OAAA,WAAAA,QAAA;QAAA,IAAAC,KAAA;QACA,KAAAC,SAAA;UAAA,OAAAD,KAAA,CAAAE,cAAA;QAAA;MACA;IACA;EACA;EACAC,OAAA,WAAAA,QAAA;IAAA,IAAAC,MAAA;IACA,KAAAC,kBAAA,GAAAC,MAAA,CAAAC,MAAA;IACA,KAAAC,gBAAA,GAAAC,MAAA,CAAAC,aAAA,CAAAC,OAAA,CAAAC,cAAA,GAAAC,YAAA;IACA,KAAAL,gBAAA,CACAM,MAAA,WAAAC,EAAA;MAAA,OAAAA,EAAA,CAAAC,KAAA;IAAA,GACAC,OAAA,WAAAC,CAAA;MACAd,MAAA,CAAAC,kBAAA,CAAAa,CAAA,CAAA7B,EAAA,IAAA6B,CAAA;MACAd,MAAA,CAAAe,IAAA,CAAAf,MAAA,CAAAT,UAAA,EAAAuB,CAAA,CAAA7B,EAAA,EAAA6B,CAAA,CAAA/B,IAAA;IACA;IACA,KAAAgC,IAAA,MAAAxB,UAAA;EACA;EACAyB,OAAA;IACAlB,cAAA,WAAAA,eAAA;MAAA,IAAAmB,qBAAA;MACA,KAAAC,WAAA,GAAAb,MAAA,CAAAC,aAAA,CAAAY,WAAA;MACA,KAAA7B,aAAA,KAAA4B,qBAAA,QAAAC,WAAA,CAAAC,cAAA,cAAAF,qBAAA,gBAAAA,qBAAA,GAAAA,qBAAA,CAAAG,UAAA,cAAAH,qBAAA,uBAAAA,qBAAA,CAAAhC,EAAA;IACA;IACAoC,gBAAA,WAAAA,iBAAA;MACA,KAAA7B,mBAAA;MACA,KAAAF,cAAA;IACA;IACAgC,gBAAA,WAAAA,iBAAA;MACA,SAAA/B,UAAA,MAAAD,cAAA,CAAAL,EAAA;QACA,KAAAsC,QAAA,CAAAC,KAAA;QACA;MACA;MACA,IAAAC,UAAA,GAAApB,MAAA,CAAAC,aAAA,CAAAoB,MAAA,CAAAvB,MAAA,sBAAAb,cAAA;MACA,KAAAc,gBAAA,CAAAuB,IAAA,CAAAF,UAAA;MACA,KAAAV,IAAA,MAAAxB,UAAA,OAAAD,cAAA,CAAAL,EAAA,OAAAK,cAAA,CAAAP,IAAA;MACA,KAAAkB,kBAAA,MAAAX,cAAA,CAAAL,EAAA,IAAAwC,UAAA;MACA,KAAAjC,mBAAA;IACA;IACAoC,iBAAA,WAAAA,kBAAAC,SAAA;MACA,IAAAA,SAAA;QACAxB,MAAA,CAAAC,aAAA,CAAAwB,QAAA,CAAAC,gBAAA,MAAAb,WAAA;UACAE,UAAA;QACA;MACA;QACAf,MAAA,CAAAC,aAAA,CAAAwB,QAAA,CAAAC,gBAAA,MAAAb,WAAA;UACAE,UAAA,OAAAnB,kBAAA,CAAA4B,SAAA;QACA;MACA;IACA;EACA;EACAG,aAAA,WAAAA,cAAA;IACA,KAAAd,WAAA;EACA;AACA"}]}