{"remainingRequest":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\src\\views\\system\\user\\profile\\userSocial.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\src\\views\\system\\user\\profile\\userSocial.vue","mtime":1704630438101},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\babel.config.js","mtime":1704630437199},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKdmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKCJDOi9Vc2Vycy84OTQyNS9JZGVhUHJvamVjdHMvcXItY29kZS12dWUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvaW50ZXJvcFJlcXVpcmVEZWZhdWx0LmpzIikuZGVmYXVsdDsKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7CnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5wdXNoLmpzIik7CnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYy5qcyIpOwpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnJlcGxhY2UuanMiKTsKdmFyIF9vYmplY3RTcHJlYWQyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJDOi9Vc2Vycy84OTQyNS9JZGVhUHJvamVjdHMvcXItY29kZS12dWUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvb2JqZWN0U3ByZWFkMi5qcyIpKTsKdmFyIF9jb25zdGFudHMgPSByZXF1aXJlKCJAL3V0aWxzL2NvbnN0YW50cyIpOwp2YXIgX2xvZ2luID0gcmVxdWlyZSgiQC9hcGkvbG9naW4iKTsKdmFyIF9zb2NpYWxVc2VyID0gcmVxdWlyZSgiQC9hcGkvc3lzdGVtL3NvY2lhbFVzZXIiKTsKdmFyIF9kZWZhdWx0ID0gZXhwb3J0cy5kZWZhdWx0ID0gewogIHByb3BzOiB7CiAgICB1c2VyOiB7CiAgICAgIHR5cGU6IE9iamVjdAogICAgfSwKICAgIGdldFVzZXI6IHsKICAgICAgLy8g5Yi35paw55So5oi3CiAgICAgIHR5cGU6IEZ1bmN0aW9uCiAgICB9LAogICAgc2V0QWN0aXZlVGFiOiB7CiAgICAgIC8vIOiuvue9rua/gOa0u+eahAogICAgICB0eXBlOiBGdW5jdGlvbgogICAgfQogIH0sCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7fTsKICB9LAogIGNvbXB1dGVkOiB7CiAgICBzb2NpYWxVc2VyczogZnVuY3Rpb24gc29jaWFsVXNlcnMoKSB7CiAgICAgIHZhciBzb2NpYWxVc2VycyA9IFtdOwogICAgICBmb3IgKHZhciBpIGluIF9jb25zdGFudHMuU3lzdGVtVXNlclNvY2lhbFR5cGVFbnVtKSB7CiAgICAgICAgdmFyIHNvY2lhbFVzZXIgPSAoMCwgX29iamVjdFNwcmVhZDIuZGVmYXVsdCkoe30sIF9jb25zdGFudHMuU3lzdGVtVXNlclNvY2lhbFR5cGVFbnVtW2ldKTsKICAgICAgICBzb2NpYWxVc2Vycy5wdXNoKHNvY2lhbFVzZXIpOwogICAgICAgIGlmICh0aGlzLnVzZXIuc29jaWFsVXNlcnMpIHsKICAgICAgICAgIGZvciAodmFyIGogaW4gdGhpcy51c2VyLnNvY2lhbFVzZXJzKSB7CiAgICAgICAgICAgIGlmIChzb2NpYWxVc2VyLnR5cGUgPT09IHRoaXMudXNlci5zb2NpYWxVc2Vyc1tqXS50eXBlKSB7CiAgICAgICAgICAgICAgc29jaWFsVXNlci5vcGVuaWQgPSB0aGlzLnVzZXIuc29jaWFsVXNlcnNbal0ub3BlbmlkOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiBzb2NpYWxVc2VyczsKICAgIH0KICB9LAogIGNyZWF0ZWQ6IGZ1bmN0aW9uIGNyZWF0ZWQoKSB7CiAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgLy8g56S+5Lqk57uR5a6aCiAgICB2YXIgdHlwZSA9IHRoaXMuJHJvdXRlLnF1ZXJ5LnR5cGU7CiAgICB2YXIgY29kZSA9IHRoaXMuJHJvdXRlLnF1ZXJ5LmNvZGU7CiAgICB2YXIgc3RhdGUgPSB0aGlzLiRyb3V0ZS5xdWVyeS5zdGF0ZTsKICAgIGlmICghY29kZSkgewogICAgICByZXR1cm47CiAgICB9CiAgICAoMCwgX3NvY2lhbFVzZXIuc29jaWFsQmluZCkodHlwZSwgY29kZSwgc3RhdGUpLnRoZW4oZnVuY3Rpb24gKHJlc3ApIHsKICAgICAgX3RoaXMuJG1vZGFsLm1zZ1N1Y2Nlc3MoIue7keWumuaIkOWKnyIpOwogICAgICBfdGhpcy4kcm91dGVyLnJlcGxhY2UoJy91c2VyL3Byb2ZpbGUnKTsKICAgICAgLy8g6LCD55So54i257uE5Lu2LCDliLfmlrAKICAgICAgX3RoaXMuZ2V0VXNlcigpOwogICAgICBfdGhpcy5zZXRBY3RpdmVUYWIoJ3VzZXJTb2NpYWwnKTsKICAgIH0pOwogIH0sCiAgbWV0aG9kczogewogICAgYmluZDogZnVuY3Rpb24gYmluZChzb2NpYWxVc2VyKSB7CiAgICAgIC8vIOiuoeeulyByZWRpcmVjdFVyaQogICAgICB2YXIgcmVkaXJlY3RVcmkgPSBsb2NhdGlvbi5vcmlnaW4gKyAnL3VzZXIvcHJvZmlsZT90eXBlPScgKyBzb2NpYWxVc2VyLnR5cGU7CiAgICAgIC8vIOi/m+ihjOi3s+i9rAogICAgICAoMCwgX2xvZ2luLnNvY2lhbEF1dGhSZWRpcmVjdCkoc29jaWFsVXNlci50eXBlLCBlbmNvZGVVUklDb21wb25lbnQocmVkaXJlY3RVcmkpKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAvLyBjb25zb2xlLmxvZyhyZXMudXJsKTsKICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IHJlcy5kYXRhOwogICAgICB9KTsKICAgIH0sCiAgICB1bmJpbmQ6IGZ1bmN0aW9uIHVuYmluZChzb2NpYWxVc2VyKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwogICAgICAoMCwgX3NvY2lhbFVzZXIuc29jaWFsVW5iaW5kKShzb2NpYWxVc2VyLnR5cGUsIHNvY2lhbFVzZXIub3BlbmlkKS50aGVuKGZ1bmN0aW9uIChyZXNwKSB7CiAgICAgICAgX3RoaXMyLiRtb2RhbC5tc2dTdWNjZXNzKCLop6Pnu5HmiJDlip8iKTsKICAgICAgICBzb2NpYWxVc2VyLm9wZW5pZCA9IHVuZGVmaW5lZDsKICAgICAgfSk7CiAgICB9LAogICAgY2xvc2U6IGZ1bmN0aW9uIGNsb3NlKCkgewogICAgICB0aGlzLiR0YWIuY2xvc2VQYWdlKCk7CiAgICB9CiAgfQp9Ow=="},{"version":3,"names":["_constants","require","_login","_socialUser","_default","exports","default","props","user","type","Object","getUser","Function","setActiveTab","data","computed","socialUsers","i","SystemUserSocialTypeEnum","socialUser","_objectSpread2","push","j","openid","created","_this","$route","query","code","state","socialBind","then","resp","$modal","msgSuccess","$router","replace","methods","bind","redirectUri","location","origin","socialAuthRedirect","encodeURIComponent","res","window","href","unbind","_this2","socialUnbind","undefined","close","$tab","closePage"],"sources":["src/views/system/user/profile/userSocial.vue"],"sourcesContent":["<template>\r\n  <el-table :data=\"socialUsers\" :show-header=\"false\">\r\n    <el-table-column label=\"社交平台\" align=\"left\" width=\"120\">\r\n      <template v-slot=\"scope\">\r\n        <img style=\"height:20px;vertical-align: middle;\" :src=\"scope.row.img\" /> {{ scope.row.title }}\r\n      </template>\r\n    </el-table-column>\r\n    <el-table-column label=\"操作\" align=\"left\" >\r\n      <template v-slot=\"scope\">\r\n        <div v-if=\"scope.row.openid\">\r\n          已绑定\r\n          <el-button size=\"large\" type=\"text\" @click=\"unbind(scope.row)\">(解绑)</el-button>\r\n        </div>\r\n        <div v-else>\r\n          未绑定\r\n          <el-button size=\"large\" type=\"text\" @click=\"bind(scope.row)\">(绑定)</el-button>\r\n        </div>\r\n      </template>\r\n    </el-table-column>\r\n  </el-table>\r\n</template>\r\n\r\n<script>\r\n\r\nimport {SystemUserSocialTypeEnum} from \"@/utils/constants\";\r\nimport {socialAuthRedirect} from \"@/api/login\";\r\nimport {socialBind, socialUnbind} from \"@/api/system/socialUser\";\r\n\r\nexport default {\r\n  props: {\r\n    user: {\r\n      type: Object\r\n    },\r\n    getUser: { // 刷新用户\r\n      type: Function\r\n    },\r\n    setActiveTab: { // 设置激活的\r\n      type: Function\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n    };\r\n  },\r\n  computed: {\r\n    socialUsers (){\r\n      const socialUsers = [];\r\n      for (const i in SystemUserSocialTypeEnum) {\r\n        const socialUser = {...SystemUserSocialTypeEnum[i]};\r\n        socialUsers.push(socialUser);\r\n        if (this.user.socialUsers) {\r\n          for (const j in this.user.socialUsers) {\r\n            if (socialUser.type === this.user.socialUsers[j].type) {\r\n              socialUser.openid = this.user.socialUsers[j].openid;\r\n              break;\r\n            }\r\n          }\r\n        }\r\n      }\r\n      return socialUsers;\r\n    }\r\n  },\r\n  created() {\r\n    // 社交绑定\r\n    const type = this.$route.query.type;\r\n    const code = this.$route.query.code;\r\n    const state = this.$route.query.state;\r\n    if (!code) {\r\n      return;\r\n    }\r\n    socialBind(type, code, state).then(resp => {\r\n      this.$modal.msgSuccess(\"绑定成功\");\r\n      this.$router.replace('/user/profile');\r\n      // 调用父组件, 刷新\r\n      this.getUser();\r\n      this.setActiveTab('userSocial');\r\n    });\r\n  },\r\n  methods: {\r\n    bind(socialUser) {\r\n      // 计算 redirectUri\r\n      const redirectUri = location.origin + '/user/profile?type=' + socialUser.type;\r\n      // 进行跳转\r\n      socialAuthRedirect(socialUser.type, encodeURIComponent(redirectUri)).then((res) => {\r\n        // console.log(res.url);\r\n        window.location.href = res.data;\r\n      });\r\n    },\r\n    unbind(socialUser) {\r\n      socialUnbind(socialUser.type, socialUser.openid).then(resp => {\r\n        this.$modal.msgSuccess(\"解绑成功\");\r\n        socialUser.openid = undefined;\r\n      });\r\n    },\r\n    close() {\r\n      this.$tab.closePage();\r\n    }\r\n  }\r\n};\r\n</script>\r\n"],"mappings":";;;;;;;;;;;AAwBA,IAAAA,UAAA,GAAAC,OAAA;AACA,IAAAC,MAAA,GAAAD,OAAA;AACA,IAAAE,WAAA,GAAAF,OAAA;AAAA,IAAAG,QAAA,GAAAC,OAAA,CAAAC,OAAA,GAEA;EACAC,KAAA;IACAC,IAAA;MACAC,IAAA,EAAAC;IACA;IACAC,OAAA;MAAA;MACAF,IAAA,EAAAG;IACA;IACAC,YAAA;MAAA;MACAJ,IAAA,EAAAG;IACA;EACA;EACAE,IAAA,WAAAA,KAAA;IACA,QACA;EACA;EACAC,QAAA;IACAC,WAAA,WAAAA,YAAA;MACA,IAAAA,WAAA;MACA,SAAAC,CAAA,IAAAC,mCAAA;QACA,IAAAC,UAAA,OAAAC,cAAA,CAAAd,OAAA,MAAAY,mCAAA,CAAAD,CAAA;QACAD,WAAA,CAAAK,IAAA,CAAAF,UAAA;QACA,SAAAX,IAAA,CAAAQ,WAAA;UACA,SAAAM,CAAA,SAAAd,IAAA,CAAAQ,WAAA;YACA,IAAAG,UAAA,CAAAV,IAAA,UAAAD,IAAA,CAAAQ,WAAA,CAAAM,CAAA,EAAAb,IAAA;cACAU,UAAA,CAAAI,MAAA,QAAAf,IAAA,CAAAQ,WAAA,CAAAM,CAAA,EAAAC,MAAA;cACA;YACA;UACA;QACA;MACA;MACA,OAAAP,WAAA;IACA;EACA;EACAQ,OAAA,WAAAA,QAAA;IAAA,IAAAC,KAAA;IACA;IACA,IAAAhB,IAAA,QAAAiB,MAAA,CAAAC,KAAA,CAAAlB,IAAA;IACA,IAAAmB,IAAA,QAAAF,MAAA,CAAAC,KAAA,CAAAC,IAAA;IACA,IAAAC,KAAA,QAAAH,MAAA,CAAAC,KAAA,CAAAE,KAAA;IACA,KAAAD,IAAA;MACA;IACA;IACA,IAAAE,sBAAA,EAAArB,IAAA,EAAAmB,IAAA,EAAAC,KAAA,EAAAE,IAAA,WAAAC,IAAA;MACAP,KAAA,CAAAQ,MAAA,CAAAC,UAAA;MACAT,KAAA,CAAAU,OAAA,CAAAC,OAAA;MACA;MACAX,KAAA,CAAAd,OAAA;MACAc,KAAA,CAAAZ,YAAA;IACA;EACA;EACAwB,OAAA;IACAC,IAAA,WAAAA,KAAAnB,UAAA;MACA;MACA,IAAAoB,WAAA,GAAAC,QAAA,CAAAC,MAAA,2BAAAtB,UAAA,CAAAV,IAAA;MACA;MACA,IAAAiC,yBAAA,EAAAvB,UAAA,CAAAV,IAAA,EAAAkC,kBAAA,CAAAJ,WAAA,GAAAR,IAAA,WAAAa,GAAA;QACA;QACAC,MAAA,CAAAL,QAAA,CAAAM,IAAA,GAAAF,GAAA,CAAA9B,IAAA;MACA;IACA;IACAiC,MAAA,WAAAA,OAAA5B,UAAA;MAAA,IAAA6B,MAAA;MACA,IAAAC,wBAAA,EAAA9B,UAAA,CAAAV,IAAA,EAAAU,UAAA,CAAAI,MAAA,EAAAQ,IAAA,WAAAC,IAAA;QACAgB,MAAA,CAAAf,MAAA,CAAAC,UAAA;QACAf,UAAA,CAAAI,MAAA,GAAA2B,SAAA;MACA;IACA;IACAC,KAAA,WAAAA,MAAA;MACA,KAAAC,IAAA,CAAAC,SAAA;IACA;EACA;AACA"}]}