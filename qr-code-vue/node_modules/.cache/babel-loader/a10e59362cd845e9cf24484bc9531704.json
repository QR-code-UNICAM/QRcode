{"remainingRequest":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\src\\components\\bpmnProcessDesigner\\package\\penal\\base\\ElementBaseInfo.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\src\\components\\bpmnProcessDesigner\\package\\penal\\base\\ElementBaseInfo.vue","mtime":1704630437712},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\babel.config.js","mtime":1704630437199},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7CnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lLmpzIik7CnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3Qua2V5cy5qcyIpOwpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuanNvbi5zdHJpbmdpZnkuanMiKTsKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC5leGVjLmpzIik7CnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcubWF0Y2guanMiKTsKdmFyIF9kZWZhdWx0ID0gZXhwb3J0cy5kZWZhdWx0ID0gewogIG5hbWU6ICJFbGVtZW50QmFzZUluZm8iLAogIHByb3BzOiB7CiAgICBidXNpbmVzc09iamVjdDogT2JqZWN0LAogICAgbW9kZWw6IE9iamVjdCAvLyDmtYHnqIvmqKHlnovnmoTmlbDmja4KICB9LAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBlbGVtZW50QmFzZUluZm86IHt9LAogICAgICAvLyDmtYHnqIvooajljZXnmoTkuIvmi4nmoYbnmoTmlbDmja4KICAgICAgZm9ybXM6IFtdLAogICAgICAvLyDmtYHnqIvmqKHlnovnmoTmoKHpqowKICAgICAgcnVsZXM6IHsKICAgICAgICBrZXk6IFt7CiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSwKICAgICAgICAgIG1lc3NhZ2U6ICLmtYHnqIvmoIfor4bkuI3og73kuLrnqboiLAogICAgICAgICAgdHJpZ2dlcjogImJsdXIiCiAgICAgICAgfV0sCiAgICAgICAgbmFtZTogW3sKICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgICAgICAgbWVzc2FnZTogIua1geeoi+WQjeensOS4jeiDveS4uuepuiIsCiAgICAgICAgICB0cmlnZ2VyOiAiYmx1ciIKICAgICAgICB9XQogICAgICB9CiAgICB9OwogIH0sCiAgd2F0Y2g6IHsKICAgIGJ1c2luZXNzT2JqZWN0OiB7CiAgICAgIGltbWVkaWF0ZTogZmFsc2UsCiAgICAgIGhhbmRsZXI6IGZ1bmN0aW9uIGhhbmRsZXIodmFsKSB7CiAgICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgICBpZiAodmFsKSB7CiAgICAgICAgICB0aGlzLiRuZXh0VGljayhmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHJldHVybiBfdGhpcy5yZXNldEJhc2VJbmZvKCk7CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIC8vICdtb2RlbC5rZXknOiB7CiAgICAvLyAgIGltbWVkaWF0ZTogZmFsc2UsCiAgICAvLyAgIGhhbmRsZXI6IGZ1bmN0aW9uICh2YWwpIHsKICAgIC8vICAgICB0aGlzLmhhbmRsZUtleVVwZGF0ZSh2YWwpCiAgICAvLyAgIH0KICAgIC8vIH0KICB9LAogIGNyZWF0ZWQ6IGZ1bmN0aW9uIGNyZWF0ZWQoKSB7CiAgICB2YXIgX3RoaXMyID0gdGhpczsKICAgIC8vIOmSiOWvueS4iuS8oOeahCBicG1uIOa1geeoi+WbvuaXtu+8jOmcgOimgeW7tui/nyAxIOenkueahOaXtumXtO+8jOS/neivgSBrZXkg5ZKMIG5hbWUg55qE5pu05pawCiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgX3RoaXMyLmhhbmRsZUtleVVwZGF0ZShfdGhpczIubW9kZWwua2V5KTsKICAgICAgX3RoaXMyLmhhbmRsZU5hbWVVcGRhdGUoX3RoaXMyLm1vZGVsLm5hbWUpOwogICAgfSwgMTAwMCk7CiAgfSwKICBtZXRob2RzOiB7CiAgICByZXNldEJhc2VJbmZvOiBmdW5jdGlvbiByZXNldEJhc2VJbmZvKCkgewogICAgICB2YXIgX3dpbmRvdzsKICAgICAgdGhpcy5icG1uRWxlbWVudCA9IChfd2luZG93ID0gd2luZG93KSA9PT0gbnVsbCB8fCBfd2luZG93ID09PSB2b2lkIDAgfHwgKF93aW5kb3cgPSBfd2luZG93LmJwbW5JbnN0YW5jZXMpID09PSBudWxsIHx8IF93aW5kb3cgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF93aW5kb3cuYnBtbkVsZW1lbnQ7CiAgICAgIHRoaXMuZWxlbWVudEJhc2VJbmZvID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0aGlzLmJwbW5FbGVtZW50LmJ1c2luZXNzT2JqZWN0KSk7CiAgICB9LAogICAgaGFuZGxlS2V5VXBkYXRlOiBmdW5jdGlvbiBoYW5kbGVLZXlVcGRhdGUodmFsdWUpIHsKICAgICAgLy8g5qCh6aqMIHZhbHVlIOeahOWAvO+8jOWPquaciSBYTUwgTkNOYW1lIOmAmui/h+eahOaDheWGteS4i++8jOaJjei/m+ihjOi1i+WAvOOAguWQpuWIme+8jOS8muWvvOiHtOa1geeoi+WbvuaKpemUme+8jOaXoOazlee7mOWItueahOmXrumimAogICAgICBpZiAoIXZhbHVlKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGlmICghdmFsdWUubWF0Y2goL1thLXpBLVpfXVtcLV8uMC05YS16QS1aJF0qLykpIHsKICAgICAgICBjb25zb2xlLmxvZygna2V5IOS4jea7oei2syBYTUwgTkNOYW1lIOinhOWIme+8jOaJgOS7peS4jei/m+ihjOi1i+WAvCcpOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBjb25zb2xlLmxvZygna2V5IOa7oei2syBYTUwgTkNOYW1lIOinhOWIme+8jOaJgOS7pei/m+ihjOi1i+WAvCcpOwoKICAgICAgLy8g5ZyoIEJQTU4g55qEIFhNTCDkuK3vvIzmtYHnqIvmoIfor4Yga2V577yM5YW25a6e5a+55bqU55qE5pivIGlkIOiKgueCuQogICAgICB0aGlzLmVsZW1lbnRCYXNlSW5mb1snaWQnXSA9IHZhbHVlOwogICAgICB0aGlzLnVwZGF0ZUJhc2VJbmZvKCdpZCcpOwogICAgfSwKICAgIGhhbmRsZU5hbWVVcGRhdGU6IGZ1bmN0aW9uIGhhbmRsZU5hbWVVcGRhdGUodmFsdWUpIHsKICAgICAgaWYgKCF2YWx1ZSkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICB0aGlzLmVsZW1lbnRCYXNlSW5mb1snbmFtZSddID0gdmFsdWU7CiAgICAgIHRoaXMudXBkYXRlQmFzZUluZm8oJ25hbWUnKTsKICAgIH0sCiAgICBoYW5kbGVEZXNjcmlwdGlvblVwZGF0ZTogZnVuY3Rpb24gaGFuZGxlRGVzY3JpcHRpb25VcGRhdGUodmFsdWUpIHsKICAgICAgLy8gVE9ETyDoiovoib/vvJpkb2N1bWVudGF0aW9uIOaaguaXtuaXoOazleS/ruaUue+8jOWQjue7reWcqOeci+eciwogICAgICAvLyB0aGlzLmVsZW1lbnRCYXNlSW5mb1snZG9jdW1lbnRhdGlvbiddID0gdmFsdWU7CiAgICAgIC8vIHRoaXMudXBkYXRlQmFzZUluZm8oJ2RvY3VtZW50YXRpb24nKTsKICAgIH0sCiAgICB1cGRhdGVCYXNlSW5mbzogZnVuY3Rpb24gdXBkYXRlQmFzZUluZm8oa2V5KSB7CiAgICAgIC8vIOinpuWPkSBlbGVtZW50QmFzZUluZm8g5a+55bqU55qE5a2X5q61CiAgICAgIHZhciBhdHRyT2JqID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKICAgICAgYXR0ck9ialtrZXldID0gdGhpcy5lbGVtZW50QmFzZUluZm9ba2V5XTsKICAgICAgaWYgKGtleSA9PT0gImlkIikgewogICAgICAgIHdpbmRvdy5icG1uSW5zdGFuY2VzLm1vZGVsaW5nLnVwZGF0ZVByb3BlcnRpZXModGhpcy5icG1uRWxlbWVudCwgewogICAgICAgICAgaWQ6IHRoaXMuZWxlbWVudEJhc2VJbmZvW2tleV0sCiAgICAgICAgICBkaTogewogICAgICAgICAgICBpZDogIiIuY29uY2F0KHRoaXMuZWxlbWVudEJhc2VJbmZvW2tleV0sICJfZGkiKQogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIHdpbmRvdy5icG1uSW5zdGFuY2VzLm1vZGVsaW5nLnVwZGF0ZVByb3BlcnRpZXModGhpcy5icG1uRWxlbWVudCwgYXR0ck9iaik7CiAgICAgIH0KICAgIH0KICB9LAogIGJlZm9yZURlc3Ryb3k6IGZ1bmN0aW9uIGJlZm9yZURlc3Ryb3koKSB7CiAgICB0aGlzLmJwbW5FbGVtZW50ID0gbnVsbDsKICB9Cn07"},{"version":3,"names":["name","props","businessObject","Object","model","data","elementBaseInfo","forms","rules","key","required","message","trigger","watch","immediate","handler","val","_this","$nextTick","resetBaseInfo","created","_this2","setTimeout","handleKeyUpdate","handleNameUpdate","methods","_window","bpmnElement","window","bpmnInstances","JSON","parse","stringify","value","match","console","log","updateBaseInfo","handleDescriptionUpdate","attrObj","create","modeling","updateProperties","id","di","concat","beforeDestroy"],"sources":["src/components/bpmnProcessDesigner/package/penal/base/ElementBaseInfo.vue"],"sourcesContent":["<template>\r\n  <div class=\"panel-tab__content\">\r\n    <el-form\r\n      size=\"mini\"\r\n      label-width=\"90px\"\r\n      :model=\"model\"\r\n      :rules=\"rules\"\r\n      @submit.native.prevent\r\n    >\r\n      <div v-if=\"elementBaseInfo.$type === 'bpmn:Process'\">\r\n        <!-- 如果是 Process 信息的时候，使用自定义表单 -->\r\n        <el-link\r\n          href=\"https://doc.iocoder.cn/bpm/#_3-%E6%B5%81%E7%A8%8B%E5%9B%BE%E7%A4%BA%E4%BE%8B\"\r\n          type=\"danger\"\r\n          target=\"_blank\"\r\n          >如何实现实现会签、或签？</el-link\r\n        >\r\n        <el-form-item label=\"流程标识\" prop=\"key\">\r\n          <el-input\r\n            v-model=\"model.key\"\r\n            placeholder=\"请输入流标标识\"\r\n            :disabled=\"model.id !== undefined && model.id.length > 0\"\r\n            @change=\"handleKeyUpdate\"\r\n          />\r\n        </el-form-item>\r\n        <el-form-item label=\"流程名称\" prop=\"name\">\r\n          <el-input\r\n            v-model=\"model.name\"\r\n            placeholder=\"请输入流程名称\"\r\n            clearable\r\n            @change=\"handleNameUpdate\"\r\n          />\r\n        </el-form-item>\r\n      </div>\r\n      <div v-else>\r\n        <el-form-item label=\"ID\">\r\n          <el-input\r\n            v-model=\"elementBaseInfo.id\"\r\n            clearable\r\n            @change=\"updateBaseInfo('id')\"\r\n          />\r\n        </el-form-item>\r\n        <el-form-item label=\"名称\">\r\n          <el-input\r\n            v-model=\"elementBaseInfo.name\"\r\n            clearable\r\n            @change=\"updateBaseInfo('name')\"\r\n          />\r\n        </el-form-item>\r\n      </div>\r\n    </el-form>\r\n  </div>\r\n</template>\r\n<script>\r\n\r\nexport default {\r\n  name: \"ElementBaseInfo\",\r\n  props: {\r\n    businessObject: Object,\r\n    model: Object, // 流程模型的数据\r\n  },\r\n  data () {\r\n    return {\r\n      elementBaseInfo: {},\r\n      // 流程表单的下拉框的数据\r\n      forms: [],\r\n      // 流程模型的校验\r\n      rules: {\r\n        key: [{ required: true, message: \"流程标识不能为空\", trigger: \"blur\" }],\r\n        name: [{ required: true, message: \"流程名称不能为空\", trigger: \"blur\" }],\r\n      },\r\n    }\r\n  },\r\n  watch: {\r\n    businessObject: {\r\n      immediate: false,\r\n      handler: function (val) {\r\n        if (val) {\r\n          this.$nextTick(() => this.resetBaseInfo())\r\n        }\r\n      }\r\n    },\r\n    // 'model.key': {\r\n    //   immediate: false,\r\n    //   handler: function (val) {\r\n    //     this.handleKeyUpdate(val)\r\n    //   }\r\n    // }\r\n  },\r\n  created () {\r\n    // 针对上传的 bpmn 流程图时，需要延迟 1 秒的时间，保证 key 和 name 的更新\r\n    setTimeout(() => {\r\n      this.handleKeyUpdate(this.model.key)\r\n      this.handleNameUpdate(this.model.name)\r\n    }, 1000)\r\n  },\r\n  methods: {\r\n    resetBaseInfo () {\r\n      this.bpmnElement = window?.bpmnInstances?.bpmnElement\r\n      this.elementBaseInfo = JSON.parse(JSON.stringify(this.bpmnElement.businessObject))\r\n    },\r\n    handleKeyUpdate (value) {\r\n      // 校验 value 的值，只有 XML NCName 通过的情况下，才进行赋值。否则，会导致流程图报错，无法绘制的问题\r\n      if (!value) {\r\n        return\r\n      }\r\n      if (!value.match(/[a-zA-Z_][\\-_.0-9a-zA-Z$]*/)) {\r\n        console.log('key 不满足 XML NCName 规则，所以不进行赋值')\r\n        return\r\n      }\r\n      console.log('key 满足 XML NCName 规则，所以进行赋值')\r\n\r\n      // 在 BPMN 的 XML 中，流程标识 key，其实对应的是 id 节点\r\n      this.elementBaseInfo['id'] = value\r\n      this.updateBaseInfo('id')\r\n    },\r\n    handleNameUpdate (value) {\r\n      if (!value) {\r\n        return\r\n      }\r\n      this.elementBaseInfo['name'] = value\r\n      this.updateBaseInfo('name')\r\n    },\r\n    handleDescriptionUpdate (value) {\r\n      // TODO 芋艿：documentation 暂时无法修改，后续在看看\r\n      // this.elementBaseInfo['documentation'] = value;\r\n      // this.updateBaseInfo('documentation');\r\n    },\r\n    updateBaseInfo (key) {\r\n      // 触发 elementBaseInfo 对应的字段\r\n      const attrObj = Object.create(null)\r\n      attrObj[key] = this.elementBaseInfo[key]\r\n      if (key === \"id\") {\r\n        window.bpmnInstances.modeling.updateProperties(this.bpmnElement, {\r\n          id: this.elementBaseInfo[key],\r\n          di: { id: `${this.elementBaseInfo[key]}_di` }\r\n        })\r\n      } else {\r\n        window.bpmnInstances.modeling.updateProperties(this.bpmnElement, attrObj)\r\n      }\r\n    }\r\n  },\r\n  beforeDestroy () {\r\n    this.bpmnElement = null\r\n  }\r\n};\r\n</script>\r\n"],"mappings":";;;;;;;;;;;iCAuDA;EACAA,IAAA;EACAC,KAAA;IACAC,cAAA,EAAAC,MAAA;IACAC,KAAA,EAAAD,MAAA;EACA;EACAE,IAAA,WAAAA,KAAA;IACA;MACAC,eAAA;MACA;MACAC,KAAA;MACA;MACAC,KAAA;QACAC,GAAA;UAAAC,QAAA;UAAAC,OAAA;UAAAC,OAAA;QAAA;QACAZ,IAAA;UAAAU,QAAA;UAAAC,OAAA;UAAAC,OAAA;QAAA;MACA;IACA;EACA;EACAC,KAAA;IACAX,cAAA;MACAY,SAAA;MACAC,OAAA,WAAAA,QAAAC,GAAA;QAAA,IAAAC,KAAA;QACA,IAAAD,GAAA;UACA,KAAAE,SAAA;YAAA,OAAAD,KAAA,CAAAE,aAAA;UAAA;QACA;MACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;EACA;EACAC,OAAA,WAAAA,QAAA;IAAA,IAAAC,MAAA;IACA;IACAC,UAAA;MACAD,MAAA,CAAAE,eAAA,CAAAF,MAAA,CAAAjB,KAAA,CAAAK,GAAA;MACAY,MAAA,CAAAG,gBAAA,CAAAH,MAAA,CAAAjB,KAAA,CAAAJ,IAAA;IACA;EACA;EACAyB,OAAA;IACAN,aAAA,WAAAA,cAAA;MAAA,IAAAO,OAAA;MACA,KAAAC,WAAA,IAAAD,OAAA,GAAAE,MAAA,cAAAF,OAAA,gBAAAA,OAAA,GAAAA,OAAA,CAAAG,aAAA,cAAAH,OAAA,uBAAAA,OAAA,CAAAC,WAAA;MACA,KAAArB,eAAA,GAAAwB,IAAA,CAAAC,KAAA,CAAAD,IAAA,CAAAE,SAAA,MAAAL,WAAA,CAAAzB,cAAA;IACA;IACAqB,eAAA,WAAAA,gBAAAU,KAAA;MACA;MACA,KAAAA,KAAA;QACA;MACA;MACA,KAAAA,KAAA,CAAAC,KAAA;QACAC,OAAA,CAAAC,GAAA;QACA;MACA;MACAD,OAAA,CAAAC,GAAA;;MAEA;MACA,KAAA9B,eAAA,SAAA2B,KAAA;MACA,KAAAI,cAAA;IACA;IACAb,gBAAA,WAAAA,iBAAAS,KAAA;MACA,KAAAA,KAAA;QACA;MACA;MACA,KAAA3B,eAAA,WAAA2B,KAAA;MACA,KAAAI,cAAA;IACA;IACAC,uBAAA,WAAAA,wBAAAL,KAAA;MACA;MACA;MACA;IAAA,CACA;IACAI,cAAA,WAAAA,eAAA5B,GAAA;MACA;MACA,IAAA8B,OAAA,GAAApC,MAAA,CAAAqC,MAAA;MACAD,OAAA,CAAA9B,GAAA,SAAAH,eAAA,CAAAG,GAAA;MACA,IAAAA,GAAA;QACAmB,MAAA,CAAAC,aAAA,CAAAY,QAAA,CAAAC,gBAAA,MAAAf,WAAA;UACAgB,EAAA,OAAArC,eAAA,CAAAG,GAAA;UACAmC,EAAA;YAAAD,EAAA,KAAAE,MAAA,MAAAvC,eAAA,CAAAG,GAAA;UAAA;QACA;MACA;QACAmB,MAAA,CAAAC,aAAA,CAAAY,QAAA,CAAAC,gBAAA,MAAAf,WAAA,EAAAY,OAAA;MACA;IACA;EACA;EACAO,aAAA,WAAAA,cAAA;IACA,KAAAnB,WAAA;EACA;AACA"}]}