{"remainingRequest":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\src\\components\\VideoUpload\\index.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\src\\components\\VideoUpload\\index.vue","mtime":1704630437684},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\babel.config.js","mtime":1704630437199},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7CnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5udW1iZXIuY29uc3RydWN0b3IuanMiKTsKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmluY2x1ZGVzLmpzIik7CnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuaW5jbHVkZXMuanMiKTsKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmpvaW4uanMiKTsKdmFyIF9hdXRoID0gcmVxdWlyZSgiQC91dGlscy9hdXRoIik7CnZhciBfZGVmYXVsdDIgPSBleHBvcnRzLmRlZmF1bHQgPSB7CiAgcHJvcHM6IHsKICAgIHZhbHVlOiBbU3RyaW5nLCBPYmplY3RdLAogICAgLy8g5aSn5bCP6ZmQ5Yi2KE1CKQogICAgZmlsZVNpemU6IHsKICAgICAgdHlwZTogTnVtYmVyLAogICAgICBkZWZhdWx0OiAzMDAKICAgIH0sCiAgICAvLyDmlofku7bnsbvlnossIOS+i+WmgiJ2aWRlby9tcDQiCiAgICBmaWxlVHlwZTogewogICAgICB0eXBlOiBbU3RyaW5nLCBBcnJheV0sCiAgICAgIGRlZmF1bHQ6IGZ1bmN0aW9uIF9kZWZhdWx0KCkgewogICAgICAgIHJldHVybiBbInZpZGVvL21wNCJdOwogICAgICB9CiAgICB9LAogICAgLy8g5piv5ZCm5pi+56S65o+Q56S6CiAgICBpc1Nob3dUaXA6IHsKICAgICAgdHlwZTogQm9vbGVhbiwKICAgICAgZGVmYXVsdDogdHJ1ZQogICAgfQogIH0sCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHVwbG9hZEZsYWc6IG51bGwsCiAgICAgIGFjdGl2ZUhvdmVyOiB0cnVlLAogICAgICBkaWFsb2dWaXNpYmxlOiBmYWxzZSwKICAgICAgdmlkZW9Vcmw6IG51bGwsCiAgICAgIC8vIOinhumikeS4iuS8oAogICAgICB1cGxvYWRVcmw6IHByb2Nlc3MuZW52LlZVRV9BUFBfQkFTRV9BUEkgKyAiL2FkbWluLWFwaS9pbmZyYS9maWxlL3VwbG9hZCIsCiAgICAgIC8vIOivt+axguWcsOWdgAogICAgICBoZWFkZXJzOiB7CiAgICAgICAgQXV0aG9yaXphdGlvbjogIkJlYXJlciAiICsgKDAsIF9hdXRoLmdldEFjY2Vzc1Rva2VuKSgpCiAgICAgIH0sCiAgICAgIC8vIOiuvue9ruS4iuS8oOeahOivt+axguWktOmDqAogICAgICAvLyDlupTku5jlpJrkuKrnu4Tku7bnmoTmg4XlhrUg6K6w5b2V5b2T5YmN57uE5Lu255qEa2V55YC8CiAgICAgIG1lbnVLZXk6IDEgLy8g55So5p2l5by65Yi25Yi35pawLAogICAgfTsKICB9LAogIHdhdGNoOiB7CiAgICB2YWx1ZTogewogICAgICBoYW5kbGVyOiBmdW5jdGlvbiBoYW5kbGVyKHZhbCkgewogICAgICAgIGlmICh2YWwpIHsKICAgICAgICAgIHRoaXMudmlkZW9VcmwgPSB2YWw7CiAgICAgICAgICB0aGlzLnVwbG9hZEZsYWcgPSB0cnVlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLnZpZGVvVXJsID0gbnVsbDsKICAgICAgICAgIHRoaXMudXBsb2FkRmxhZyA9IG51bGw7CiAgICAgICAgfQogICAgICB9LAogICAgICBkZWVwOiB0cnVlLAogICAgICBpbW1lZGlhdGU6IHRydWUKICAgIH0KICB9LAogIGNvbXB1dGVkOiB7CiAgICAvLyDmmK/lkKbmmL7npLrmj5DnpLoKICAgIHNob3dUaXA6IGZ1bmN0aW9uIHNob3dUaXAoKSB7CiAgICAgIHJldHVybiB0aGlzLmlzU2hvd1RpcCAmJiAodGhpcy5maWxlVHlwZSB8fCB0aGlzLmZpbGVTaXplKTsKICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIC8vIOS4iuS8oOaIkOWKn+eahOWHveaVsAogICAgaGFuZGxlU3VjY2VzczogZnVuY3Rpb24gaGFuZGxlU3VjY2VzcyhyZXMpIHsKICAgICAgKyt0aGlzLm1lbnVLZXk7CiAgICAgIGlmIChyZXMuY29kZSA9PT0gMCkgewogICAgICAgIHRoaXMudXBsb2FkRmxhZyA9IHRydWU7CiAgICAgICAgdGhpcy52aWRlb1VybCA9IHJlcy5kYXRhOwogICAgICAgIHRoaXMuJGVtaXQoImlucHV0IiwgdGhpcy52aWRlb1VybCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy51cGxvYWRGbGFnID0gZmFsc2U7CiAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcigi6ZSZ6K+v77yBIiArIHJlcy5tc2cpOwogICAgICB9CiAgICB9LAogICAgaGFuZGxlRXJyb3I6IGZ1bmN0aW9uIGhhbmRsZUVycm9yKCkgewogICAgICB0aGlzLnVwbG9hZEZsYWcgPSBmYWxzZTsKICAgIH0sCiAgICBiZWZvcmVVcGxvYWQ6IGZ1bmN0aW9uIGJlZm9yZVVwbG9hZChmaWxlKSB7CiAgICAgIHZhciBpc01wNCA9IHRoaXMuZmlsZVR5cGUuaW5jbHVkZXMoZmlsZS50eXBlKTsKICAgICAgdmFyIGlzTHQzMDBNQiA9IGZpbGUuc2l6ZSAvIDEwMjQgLyAxMDI0IDwgMzAwOwogICAgICBpZiAoIWlzTXA0KSB7CiAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcigi6KeG6aKR5Y+q6IO95pivIiArIHRoaXMuZmlsZVR5cGUuam9pbigiLyIpICsgIuagvOW8jyEiKTsKICAgICAgfQogICAgICBpZiAoIWlzTHQzMDBNQikgewogICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoIuS4iuS8oOinhumikeWkp+Wwj+S4jeiDvei2hei/hyAzMDBNQiEiKTsKICAgICAgfQogICAgICByZXR1cm4gaXNNcDQgJiYgaXNMdDMwME1COwogICAgfSwKICAgIC8vIOmihOiniAogICAgaGFuZGxlUHJldmlldzogZnVuY3Rpb24gaGFuZGxlUHJldmlldygpIHsKICAgICAgdGhpcy5kaWFsb2dWaXNpYmxlID0gdHJ1ZTsKICAgIH0sCiAgICAvLyDliKDpmaTop4bpopEKICAgIGhhbmRsZVJlbW92ZTogZnVuY3Rpb24gaGFuZGxlUmVtb3ZlKCkgewogICAgICB0aGlzLnZpZGVvVXJsID0gbnVsbDsKICAgICAgdGhpcy51cGxvYWRGbGFnID0gbnVsbDsKICAgICAgdGhpcy4kZW1pdCgiaW5wdXQiLCBudWxsKTsKICAgIH0sCiAgICBtb3VzZW92ZXI6IGZ1bmN0aW9uIG1vdXNlb3ZlcigpIHsKICAgICAgdGhpcy5hY3RpdmVIb3ZlciA9IGZhbHNlOwogICAgfSwKICAgIG1vdXNlb3V0OiBmdW5jdGlvbiBtb3VzZW91dCgpIHsKICAgICAgdGhpcy5hY3RpdmVIb3ZlciA9IHRydWU7CiAgICB9CiAgfQp9Ow=="},{"version":3,"names":["_auth","require","_default2","exports","default","props","value","String","Object","fileSize","type","Number","fileType","Array","_default","isShowTip","Boolean","data","uploadFlag","activeHover","dialogVisible","videoUrl","uploadUrl","process","env","VUE_APP_BASE_API","headers","Authorization","getAccessToken","menuKey","watch","handler","val","deep","immediate","computed","showTip","methods","handleSuccess","res","code","$emit","$message","error","msg","handleError","beforeUpload","file","isMp4","includes","isLt300MB","size","join","handlePreview","handleRemove","mouseover","mouseout"],"sources":["src/components/VideoUpload/index.vue"],"sourcesContent":["<template>\r\n  <div class=\"editPage__video\">\r\n      <el-upload\r\n        class=\"uploader\"\r\n        list-type=\"picture-card\"\r\n        :action=\"uploadUrl\"\r\n        :on-success=\"handleSuccess\"\r\n        :before-upload=\"beforeUpload\"\r\n        :headers=\"headers\"\r\n        :on-error=\"handleError\"\r\n        :show-file-list=\"false\"\r\n      >\r\n\r\n        <div v-if=\"uploadFlag\" @mouseenter=\"mouseover\" @mouseleave=\"mouseout\">\r\n          <i class=\"el-icon-success success-icon\"></i>\r\n          <div :class=\"{'hide': activeHover, 'success': !activeHover}\">\r\n            <span class=\"item-actions\">\r\n              <span\r\n                class=\"item-preview\"\r\n                @click.stop=\"handlePreview()\"\r\n              >\r\n                <i class=\"el-icon-zoom-in\"></i>\r\n              </span>\r\n              <span\r\n                class=\"item-delete\"\r\n                @click.stop=\"handleRemove()\"\r\n              >\r\n                <i class=\"el-icon-delete\"></i>\r\n              </span>\r\n            </span>\r\n          </div>\r\n        </div>\r\n        <i v-else-if=\"uploadFlag === null\" class=\"el-icon-plus uploader-icon\"></i>\r\n        <i v-else-if=\"!uploadFlag\" class=\"el-icon-circle-close uploader-icon\" style=\"color: red\"></i>\r\n    </el-upload>\r\n    <!-- 上传提示 -->\r\n    <div class=\"el-upload__tip\" slot=\"tip\" v-if=\"showTip\">\r\n      请上传\r\n      <template v-if=\"fileSize\"> 大小不超过 <b style=\"color: #f56c6c\">{{ fileSize }}MB</b> </template>\r\n      <template v-if=\"fileType\"> 格式为 <b style=\"color: #f56c6c\">{{ fileType.join(\"/\") }}</b> </template>\r\n      的文件\r\n    </div>\r\n\r\n    <el-dialog :visible.sync=\"dialogVisible\" append-to-body  width=\"800\"  title=\"预览\">\r\n      <video width=\"100%\" v-if=\"videoUrl\" controls=\"controls\" :key=\"menuKey\">\r\n          <source :src=\"videoUrl\" type=\"video/mp4\" />\r\n      </video>\r\n    </el-dialog>\r\n\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n\r\nimport { getAccessToken } from \"@/utils/auth\";\r\n\r\nexport default {\r\n  props: {\r\n    value: [String, Object],\r\n    // 大小限制(MB)\r\n    fileSize: {\r\n      type: Number,\r\n      default: 300,\r\n    },\r\n    // 文件类型, 例如\"video/mp4\"\r\n    fileType: {\r\n      type: [String, Array],\r\n      default: () =>[\"video/mp4\"],\r\n    },\r\n    // 是否显示提示\r\n    isShowTip: {\r\n      type: Boolean,\r\n      default: true\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      uploadFlag: null,\r\n      activeHover: true,\r\n      dialogVisible: false,\r\n      videoUrl: null,\r\n      // 视频上传\r\n      uploadUrl: process.env.VUE_APP_BASE_API + \"/admin-api/infra/file/upload\", // 请求地址\r\n      headers: { Authorization: \"Bearer \" + getAccessToken() }, // 设置上传的请求头部\r\n      // 应付多个组件的情况 记录当前组件的key值\r\n      menuKey: 1, // 用来强制刷新,\r\n    }\r\n  },\r\n  watch: {\r\n    value: {\r\n      handler(val) {\r\n        if (val) {\r\n          this.videoUrl = val;\r\n          this.uploadFlag = true;\r\n        } else {\r\n          this.videoUrl = null;\r\n          this.uploadFlag = null;\r\n        }\r\n      },\r\n      deep: true,\r\n      immediate: true\r\n    }\r\n  },\r\n  computed: {\r\n    // 是否显示提示\r\n    showTip() {\r\n      return this.isShowTip && (this.fileType || this.fileSize);\r\n    },\r\n  },\r\n  methods: {\r\n     // 上传成功的函数\r\n     handleSuccess(res) {\r\n      ++this.menuKey;\r\n      if(res.code === 0){\r\n        this.uploadFlag = true;\r\n        this.videoUrl = res.data;\r\n        this.$emit(\"input\", this.videoUrl);\r\n      }else{\r\n        this.uploadFlag = false;\r\n        this.$message.error(\"错误！\"+ res.msg);\r\n      }\r\n    },\r\n    handleError(){\r\n      this.uploadFlag = false;\r\n    },\r\n    beforeUpload(file) {\r\n      const isMp4 = this.fileType.includes(file.type);\r\n      const isLt300MB = file.size / 1024 / 1024 < 300;\r\n      if (!isMp4) {\r\n        this.$message.error(\"视频只能是\"+ this.fileType.join(\"/\") +\"格式!\");\r\n      }\r\n      if (!isLt300MB) {\r\n        this.$message.error(\"上传视频大小不能超过 300MB!\");\r\n      }\r\n      return isMp4 && isLt300MB;\r\n    },\r\n     // 预览\r\n     handlePreview() {\r\n      this.dialogVisible = true;\r\n    },\r\n     // 删除视频\r\n    handleRemove() {\r\n      this.videoUrl = null;\r\n      this.uploadFlag = null;\r\n      this.$emit(\"input\", null);\r\n    },\r\n    mouseover(){\r\n      this.activeHover = false;\r\n    },\r\n    mouseout(){\r\n      this.activeHover = true;\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n\r\n<style lang=\"scss\">\r\n\r\n  .editPage__video {\r\n    .hide{\r\n      visibility:hidden;\r\n    }\r\n    .success{\r\n      position: relative;\r\n      width: 78px;\r\n      height: 78px;\r\n      line-height: 78px;\r\n      background-color: rgba(0,0,0,.5);\r\n      transition: opacity .3s;\r\n      cursor: default;\r\n\r\n      .item-preview .el-icon-zoom-in{\r\n        width: 30px;\r\n        font-size: 20px;\r\n        color: #f2f2f2;\r\n        cursor: pointer;\r\n      }\r\n      .item-delete .el-icon-delete{\r\n        width: 30px;\r\n        font-size: 20px;\r\n        color: #f2f2f2;\r\n        cursor: pointer;\r\n      }\r\n    }\r\n\r\n    .uploader-icon {\r\n      font-size: 28px;\r\n      color: #8c939d;\r\n      width: 80px;\r\n      height: 80px;\r\n      line-height: 80px;\r\n      text-align: center;\r\n      position: absolute;\r\n      left: 0;\r\n    }\r\n    .success-icon {\r\n      font-size: 28px;\r\n      color: green;\r\n      width: 80px;\r\n      height: 80px;\r\n      line-height: 80px;\r\n      text-align: center;\r\n      position: absolute;\r\n      left: 0;\r\n    }\r\n\r\n    .el-upload{\r\n      width: 80px;\r\n      height: 80px;\r\n    }\r\n\r\n  }\r\n</style>\r\n"],"mappings":";;;;;;;;;;AAsDA,IAAAA,KAAA,GAAAC,OAAA;AAAA,IAAAC,SAAA,GAAAC,OAAA,CAAAC,OAAA,GAEA;EACAC,KAAA;IACAC,KAAA,GAAAC,MAAA,EAAAC,MAAA;IACA;IACAC,QAAA;MACAC,IAAA,EAAAC,MAAA;MACAP,OAAA;IACA;IACA;IACAQ,QAAA;MACAF,IAAA,GAAAH,MAAA,EAAAM,KAAA;MACAT,OAAA,WAAAU,SAAA;QAAA;MAAA;IACA;IACA;IACAC,SAAA;MACAL,IAAA,EAAAM,OAAA;MACAZ,OAAA;IACA;EACA;EACAa,IAAA,WAAAA,KAAA;IACA;MACAC,UAAA;MACAC,WAAA;MACAC,aAAA;MACAC,QAAA;MACA;MACAC,SAAA,EAAAC,OAAA,CAAAC,GAAA,CAAAC,gBAAA;MAAA;MACAC,OAAA;QAAAC,aAAA,kBAAAC,oBAAA;MAAA;MAAA;MACA;MACAC,OAAA;IACA;EACA;EACAC,KAAA;IACAxB,KAAA;MACAyB,OAAA,WAAAA,QAAAC,GAAA;QACA,IAAAA,GAAA;UACA,KAAAX,QAAA,GAAAW,GAAA;UACA,KAAAd,UAAA;QACA;UACA,KAAAG,QAAA;UACA,KAAAH,UAAA;QACA;MACA;MACAe,IAAA;MACAC,SAAA;IACA;EACA;EACAC,QAAA;IACA;IACAC,OAAA,WAAAA,QAAA;MACA,YAAArB,SAAA,UAAAH,QAAA,SAAAH,QAAA;IACA;EACA;EACA4B,OAAA;IACA;IACAC,aAAA,WAAAA,cAAAC,GAAA;MACA,OAAAV,OAAA;MACA,IAAAU,GAAA,CAAAC,IAAA;QACA,KAAAtB,UAAA;QACA,KAAAG,QAAA,GAAAkB,GAAA,CAAAtB,IAAA;QACA,KAAAwB,KAAA,eAAApB,QAAA;MACA;QACA,KAAAH,UAAA;QACA,KAAAwB,QAAA,CAAAC,KAAA,SAAAJ,GAAA,CAAAK,GAAA;MACA;IACA;IACAC,WAAA,WAAAA,YAAA;MACA,KAAA3B,UAAA;IACA;IACA4B,YAAA,WAAAA,aAAAC,IAAA;MACA,IAAAC,KAAA,QAAApC,QAAA,CAAAqC,QAAA,CAAAF,IAAA,CAAArC,IAAA;MACA,IAAAwC,SAAA,GAAAH,IAAA,CAAAI,IAAA;MACA,KAAAH,KAAA;QACA,KAAAN,QAAA,CAAAC,KAAA,gBAAA/B,QAAA,CAAAwC,IAAA;MACA;MACA,KAAAF,SAAA;QACA,KAAAR,QAAA,CAAAC,KAAA;MACA;MACA,OAAAK,KAAA,IAAAE,SAAA;IACA;IACA;IACAG,aAAA,WAAAA,cAAA;MACA,KAAAjC,aAAA;IACA;IACA;IACAkC,YAAA,WAAAA,aAAA;MACA,KAAAjC,QAAA;MACA,KAAAH,UAAA;MACA,KAAAuB,KAAA;IACA;IACAc,SAAA,WAAAA,UAAA;MACA,KAAApC,WAAA;IACA;IACAqC,QAAA,WAAAA,SAAA;MACA,KAAArC,WAAA;IACA;EACA;AACA"}]}