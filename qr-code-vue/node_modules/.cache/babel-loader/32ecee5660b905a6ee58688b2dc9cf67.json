{"remainingRequest":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\src\\layout\\components\\Message\\index.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\src\\layout\\components\\Message\\index.vue","mtime":1704630437789},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\babel.config.js","mtime":1704630437199},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7CnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5wdXNoLmpzIik7CnZhciBfbWVzc2FnZSA9IHJlcXVpcmUoIkAvYXBpL3N5c3RlbS9ub3RpZnkvbWVzc2FnZSIpOwp2YXIgX2RlZmF1bHQgPSBleHBvcnRzLmRlZmF1bHQgPSB7CiAgbmFtZTogJ05vdGlmeU1lc3NhZ2UnLAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICAvLyDpga7nvanlsYIKICAgICAgbG9hZGluZzogZmFsc2UsCiAgICAgIC8vIOWIl+ihqAogICAgICBsaXN0OiBbXSwKICAgICAgLy8g5pyq6K+75pWw6YePLAogICAgICB1bnJlYWRDb3VudDogMAogICAgfTsKICB9LAogIGNyZWF0ZWQ6IGZ1bmN0aW9uIGNyZWF0ZWQoKSB7CiAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgLy8g6aaW5qyh5Yqg6L295bCP57qi54K5CiAgICB0aGlzLmdldFVucmVhZENvdW50KCk7CiAgICAvLyDova7or6LliLfmlrDlsI/nuqLngrkKICAgIHNldEludGVydmFsKGZ1bmN0aW9uICgpIHsKICAgICAgX3RoaXMuZ2V0VW5yZWFkQ291bnQoKTsKICAgIH0sIDEwMDAgKiA2MCAqIDIpOwogIH0sCiAgbWV0aG9kczogewogICAgZ2V0TGlzdDogZnVuY3Rpb24gZ2V0TGlzdCgpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CiAgICAgIHRoaXMubG9hZGluZyA9IHRydWU7CiAgICAgICgwLCBfbWVzc2FnZS5nZXRVbnJlYWROb3RpZnlNZXNzYWdlTGlzdCkoKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIF90aGlzMi5saXN0ID0gcmVzcG9uc2UuZGF0YTsKICAgICAgICBfdGhpczIubG9hZGluZyA9IGZhbHNlOwogICAgICAgIC8vIOW8uuWItuiuvue9riB1bnJlYWRDb3VudCDkuLogMO+8jOmBv+WFjeWwj+e6oueCueWboOS4uui9ruivouWkquaFou+8jOS4jea2iOmZpAogICAgICAgIF90aGlzMi51bnJlYWRDb3VudCA9IDA7CiAgICAgIH0pOwogICAgfSwKICAgIGdldFVucmVhZENvdW50OiBmdW5jdGlvbiBnZXRVbnJlYWRDb3VudCgpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CiAgICAgICgwLCBfbWVzc2FnZS5nZXRVbnJlYWROb3RpZnlNZXNzYWdlQ291bnQpKCkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICBfdGhpczMudW5yZWFkQ291bnQgPSByZXNwb25zZS5kYXRhOwogICAgICB9KTsKICAgIH0sCiAgICBnb015TGlzdDogZnVuY3Rpb24gZ29NeUxpc3QoKSB7CiAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsKICAgICAgICBuYW1lOiAnTXlOb3RpZnlNZXNzYWdlJwogICAgICB9KTsKICAgIH0KICB9Cn07"},{"version":3,"names":["_message","require","_default","exports","default","name","data","loading","list","unreadCount","created","_this","getUnreadCount","setInterval","methods","getList","_this2","getUnreadNotifyMessageList","then","response","_this3","getUnreadNotifyMessageCount","goMyList","$router","push"],"sources":["src/layout/components/Message/index.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <el-popover placement=\"bottom\" width=\"600\" trigger=\"click\">\r\n      <!-- icon 展示 -->\r\n      <el-badge slot=\"reference\" :is-dot=\"unreadCount > 0\" type=\"danger\">\r\n         <svg-icon icon-class=\"message\" @click=\"getList\"/>\r\n      </el-badge>\r\n\r\n      <!-- 弹出列表 -->\r\n      <el-table v-loading=\"loading\" :data=\"list\">\r\n        <el-table-column width=\"120\" property=\"templateNickname\" label=\"发送人\" />\r\n        <el-table-column width=\"180\" property=\"createTime\" label=\"发送时间\">\r\n          <template v-slot=\"scope\">\r\n            <span>{{ parseTime(scope.row.createTime) }}</span>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column label=\"类型\" align=\"center\" prop=\"templateType\" width=\"100\">\r\n          <template v-slot=\"scope\">\r\n            <dict-tag :type=\"DICT_TYPE.SYSTEM_NOTIFY_TEMPLATE_TYPE\" :value=\"scope.row.templateType\" />\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column property=\"templateContent\" label=\"内容\" />\r\n      </el-table>\r\n\r\n      <!-- 更多 -->\r\n      <div style=\"text-align: right; margin-top: 10px\">\r\n        <el-button type=\"primary\" size=\"mini\" @click=\"goMyList\">查看全部</el-button>\r\n      </div>\r\n    </el-popover>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {getUnreadNotifyMessageCount, getUnreadNotifyMessageList} from \"@/api/system/notify/message\";\r\n\r\nexport default {\r\n  name: 'NotifyMessage',\r\n  data() {\r\n    return {\r\n      // 遮罩层\r\n      loading: false,\r\n      // 列表\r\n      list: [],\r\n      // 未读数量,\r\n      unreadCount: 0,\r\n    }\r\n  },\r\n  created() {\r\n    // 首次加载小红点\r\n    this.getUnreadCount()\r\n    // 轮询刷新小红点\r\n    setInterval(() => {\r\n      this.getUnreadCount()\r\n    },1000 * 60 * 2)\r\n  },\r\n  methods: {\r\n    getList: function() {\r\n      this.loading = true;\r\n      getUnreadNotifyMessageList().then(response => {\r\n        this.list = response.data;\r\n        this.loading = false;\r\n        // 强制设置 unreadCount 为 0，避免小红点因为轮询太慢，不消除\r\n        this.unreadCount = 0\r\n      });\r\n    },\r\n    getUnreadCount: function() {\r\n      getUnreadNotifyMessageCount().then(response => {\r\n        this.unreadCount = response.data;\r\n      })\r\n    },\r\n    goMyList: function() {\r\n      this.$router.push({\r\n        name: 'MyNotifyMessage'\r\n      });\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style>\r\n.el-badge__content.is-fixed {\r\n  top: 10px; /* 保证徽章的位置 */\r\n}\r\n</style>\r\n"],"mappings":";;;;;;;AAiCA,IAAAA,QAAA,GAAAC,OAAA;AAAA,IAAAC,QAAA,GAAAC,OAAA,CAAAC,OAAA,GAEA;EACAC,IAAA;EACAC,IAAA,WAAAA,KAAA;IACA;MACA;MACAC,OAAA;MACA;MACAC,IAAA;MACA;MACAC,WAAA;IACA;EACA;EACAC,OAAA,WAAAA,QAAA;IAAA,IAAAC,KAAA;IACA;IACA,KAAAC,cAAA;IACA;IACAC,WAAA;MACAF,KAAA,CAAAC,cAAA;IACA;EACA;EACAE,OAAA;IACAC,OAAA,WAAAA,QAAA;MAAA,IAAAC,MAAA;MACA,KAAAT,OAAA;MACA,IAAAU,mCAAA,IAAAC,IAAA,WAAAC,QAAA;QACAH,MAAA,CAAAR,IAAA,GAAAW,QAAA,CAAAb,IAAA;QACAU,MAAA,CAAAT,OAAA;QACA;QACAS,MAAA,CAAAP,WAAA;MACA;IACA;IACAG,cAAA,WAAAA,eAAA;MAAA,IAAAQ,MAAA;MACA,IAAAC,oCAAA,IAAAH,IAAA,WAAAC,QAAA;QACAC,MAAA,CAAAX,WAAA,GAAAU,QAAA,CAAAb,IAAA;MACA;IACA;IACAgB,QAAA,WAAAA,SAAA;MACA,KAAAC,OAAA,CAAAC,IAAA;QACAnB,IAAA;MACA;IACA;EACA;AACA"}]}