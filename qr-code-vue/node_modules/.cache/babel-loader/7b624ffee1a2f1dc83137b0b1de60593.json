{"remainingRequest":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\src\\views\\mp\\components\\wx-voice-play\\main.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\src\\views\\mp\\components\\wx-voice-play\\main.vue","mtime":1704630438016},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\babel.config.js","mtime":1704630437199},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7Ci8vIOWboOS4uuW+ruS/oeivremfs+aYryBhbXIg5qC85byP77yM5omA5Lul6ZyA6KaB55So5YiwIGFtciDop6PnoIHlmajvvJpodHRwczovL3d3dy5ucG1qcy5jb20vcGFja2FnZS9iZW56LWFtci1yZWNvcmRlcgp2YXIgQmVuekFNUlJlY29yZGVyID0gcmVxdWlyZSgnYmVuei1hbXItcmVjb3JkZXInKTsKdmFyIF9kZWZhdWx0ID0gZXhwb3J0cy5kZWZhdWx0ID0gewogIG5hbWU6ICJ3eFZvaWNlUGxheWVyIiwKICBwcm9wczogewogICAgdXJsOiB7CiAgICAgIC8vIOivremfs+WcsOWdgO+8jOS+i+WmguivtO+8mmh0dHBzOi8vd3d3LmlvY29kZXIuY24veHh4LmFtcgogICAgICB0eXBlOiBTdHJpbmcsCiAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICB9LAogICAgY29udGVudDogewogICAgICAvLyDor63pn7PmlofmnKwKICAgICAgdHlwZTogU3RyaW5nLAogICAgICByZXF1aXJlZDogZmFsc2UKICAgIH0KICB9LAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBhbXI6IHVuZGVmaW5lZCwKICAgICAgLy8gQmVuekFNUlJlY29yZGVyIOWvueixoQogICAgICBwbGF5aW5nOiBmYWxzZSwKICAgICAgLy8g5piv5ZCm5Zyo5pKt5pS+5LitCiAgICAgIGR1cmF0aW9uOiB1bmRlZmluZWQgLy8g5pKt5pS+5pe26ZW/CiAgICB9OwogIH0sCiAgbWV0aG9kczogewogICAgcGxheVZvaWNlOiBmdW5jdGlvbiBwbGF5Vm9pY2UoKSB7CiAgICAgIGRlYnVnZ2VyOwogICAgICAvLyDmg4XlhrXkuIDvvJrmnKrliJ3lp4vljJbvvIzliJnliJvlu7ogQmVuekFNUlJlY29yZGVyCiAgICAgIGlmICh0aGlzLmFtciA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgdGhpcy5hbXJJbml0KCk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGlmICh0aGlzLmFtci5pc1BsYXlpbmcoKSkgewogICAgICAgIHRoaXMuYW1yU3RvcCgpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuYW1yUGxheSgpOwogICAgICB9CiAgICB9LAogICAgYW1ySW5pdDogZnVuY3Rpb24gYW1ySW5pdCgpIHsKICAgICAgdmFyIGFtciA9IG5ldyBCZW56QU1SUmVjb3JkZXIoKTsKICAgICAgdGhpcy5hbXIgPSBhbXI7CiAgICAgIC8vIOiuvue9ruaSreaUvgogICAgICB2YXIgdGhhdCA9IHRoaXM7CiAgICAgIGFtci5pbml0V2l0aFVybCh0aGlzLnVybCkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgdGhhdC5hbXJQbGF5KCk7CiAgICAgICAgdGhhdC5kdXJhdGlvbiA9IGFtci5nZXREdXJhdGlvbigpOwogICAgICB9KTsKICAgICAgLy8g55uR5ZCs5pqC5YGcCiAgICAgIGFtci5vbkVuZGVkKGZ1bmN0aW9uICgpIHsKICAgICAgICB0aGF0LnBsYXlpbmcgPSBmYWxzZTsKICAgICAgfSk7CiAgICB9LAogICAgYW1yUGxheTogZnVuY3Rpb24gYW1yUGxheSgpIHsKICAgICAgdGhpcy5wbGF5aW5nID0gdHJ1ZTsKICAgICAgdGhpcy5hbXIucGxheSgpOwogICAgfSwKICAgIGFtclN0b3A6IGZ1bmN0aW9uIGFtclN0b3AoKSB7CiAgICAgIHRoaXMucGxheWluZyA9IGZhbHNlOwogICAgICB0aGlzLmFtci5zdG9wKCk7CiAgICB9CiAgfQp9Ow=="},{"version":3,"names":["BenzAMRRecorder","require","_default","exports","default","name","props","url","type","String","required","content","data","amr","undefined","playing","duration","methods","playVoice","amrInit","isPlaying","amrStop","amrPlay","that","initWithUrl","then","getDuration","onEnded","play","stop"],"sources":["src/views/mp/components/wx-voice-play/main.vue"],"sourcesContent":["<!--\r\n  - Copyright (C) 2018-2019\r\n  - All rights reserved, Designed By www.joolun.com\r\n  【微信消息 - 语音】\r\n   芋道源码：\r\n  ① bug 修复：\r\n    1）joolun 的做法：使用 mediaId 从微信公众号，下载对应的 mp4 素材，从而播放内容；\r\n      存在的问题：mediaId 有效期是 3 天，超过时间后无法播放\r\n    2）重构后的做法：后端接收到微信公众号的视频消息后，将视频消息的 media_id 的文件内容保存到文件服务器中，这样前端可以直接使用 URL 播放。\r\n  ② 代码优化：将 props 中的 objData 调成为 data 中对应的属性，并补充相关注释\r\n-->\r\n<template>\r\n  <div class=\"wx-voice-div\" @click=\"playVoice\">\r\n    <i :class=\"playing !== true ? 'el-icon-video-play': 'el-icon-video-pause'\">\r\n      <span class=\"amr-duration\" v-if=\"duration\">{{ duration }} 秒</span>\r\n    </i>\r\n    <div v-if=\"content\">\r\n      <el-tag type=\"success\" size=\"mini\">语音识别</el-tag>\r\n      {{ content }}\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n// 因为微信语音是 amr 格式，所以需要用到 amr 解码器：https://www.npmjs.com/package/benz-amr-recorder\r\nconst BenzAMRRecorder = require('benz-amr-recorder')\r\n\r\nexport default {\r\n  name: \"wxVoicePlayer\",\r\n  props: {\r\n    url: { // 语音地址，例如说：https://www.iocoder.cn/xxx.amr\r\n      type: String,\r\n      required: true\r\n    },\r\n    content: { // 语音文本\r\n      type: String,\r\n      required: false\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      amr: undefined, // BenzAMRRecorder 对象\r\n      playing: false, // 是否在播放中\r\n      duration: undefined, // 播放时长\r\n    }\r\n  },\r\n  methods:{\r\n    playVoice() {\r\n      debugger\r\n      // 情况一：未初始化，则创建 BenzAMRRecorder\r\n      if (this.amr === undefined){\r\n        this.amrInit();\r\n        return;\r\n      }\r\n\r\n      if (this.amr.isPlaying()) {\r\n        this.amrStop();\r\n      } else {\r\n        this.amrPlay();\r\n      }\r\n    },\r\n    amrInit() {\r\n      const amr = new BenzAMRRecorder();\r\n      this.amr = amr;\r\n      // 设置播放\r\n      const that = this\r\n      amr.initWithUrl(this.url).then(function() {\r\n        that.amrPlay()\r\n        that.duration = amr.getDuration();\r\n      })\r\n      // 监听暂停\r\n      amr.onEnded(function() {\r\n        that.playing = false;\r\n      })\r\n    },\r\n    amrPlay() {\r\n      this.playing = true;\r\n      this.amr.play()\r\n    },\r\n    amrStop() {\r\n      this.playing = false;\r\n      this.amr.stop()\r\n    },\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n  .wx-voice-div {\r\n    padding: 5px;\r\n    background-color: #eaeaea;\r\n    border-radius: 10px;\r\n  }\r\n  .amr-duration {\r\n    font-size: 11px;\r\n    margin-left: 5px;\r\n  }\r\n</style>\r\n"],"mappings":";;;;;;AAwBA;AACA,IAAAA,eAAA,GAAAC,OAAA;AAAA,IAAAC,QAAA,GAAAC,OAAA,CAAAC,OAAA,GAEA;EACAC,IAAA;EACAC,KAAA;IACAC,GAAA;MAAA;MACAC,IAAA,EAAAC,MAAA;MACAC,QAAA;IACA;IACAC,OAAA;MAAA;MACAH,IAAA,EAAAC,MAAA;MACAC,QAAA;IACA;EACA;EACAE,IAAA,WAAAA,KAAA;IACA;MACAC,GAAA,EAAAC,SAAA;MAAA;MACAC,OAAA;MAAA;MACAC,QAAA,EAAAF,SAAA;IACA;EACA;EACAG,OAAA;IACAC,SAAA,WAAAA,UAAA;MACA;MACA;MACA,SAAAL,GAAA,KAAAC,SAAA;QACA,KAAAK,OAAA;QACA;MACA;MAEA,SAAAN,GAAA,CAAAO,SAAA;QACA,KAAAC,OAAA;MACA;QACA,KAAAC,OAAA;MACA;IACA;IACAH,OAAA,WAAAA,QAAA;MACA,IAAAN,GAAA,OAAAb,eAAA;MACA,KAAAa,GAAA,GAAAA,GAAA;MACA;MACA,IAAAU,IAAA;MACAV,GAAA,CAAAW,WAAA,MAAAjB,GAAA,EAAAkB,IAAA;QACAF,IAAA,CAAAD,OAAA;QACAC,IAAA,CAAAP,QAAA,GAAAH,GAAA,CAAAa,WAAA;MACA;MACA;MACAb,GAAA,CAAAc,OAAA;QACAJ,IAAA,CAAAR,OAAA;MACA;IACA;IACAO,OAAA,WAAAA,QAAA;MACA,KAAAP,OAAA;MACA,KAAAF,GAAA,CAAAe,IAAA;IACA;IACAP,OAAA,WAAAA,QAAA;MACA,KAAAN,OAAA;MACA,KAAAF,GAAA,CAAAgB,IAAA;IACA;EACA;AACA"}]}