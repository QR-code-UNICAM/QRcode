{"remainingRequest":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\src\\views\\bpm\\model\\modelEditor.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\src\\views\\bpm\\model\\modelEditor.vue","mtime":1704630437841},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\babel.config.js","mtime":1704630437199},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKdmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKCJDOi9Vc2Vycy84OTQyNS9JZGVhUHJvamVjdHMvcXItY29kZS12dWUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvaW50ZXJvcFJlcXVpcmVEZWZhdWx0LmpzIikuZGVmYXVsdDsKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7CnZhciBfb2JqZWN0U3ByZWFkMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgiQzovVXNlcnMvODk0MjUvSWRlYVByb2plY3RzL3FyLWNvZGUtdnVlL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL29iamVjdFNwcmVhZDIuanMiKSk7CnZhciBfdHJhbnNsYXRpb25zID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJAL2NvbXBvbmVudHMvYnBtblByb2Nlc3NEZXNpZ25lci9zcmMvdHJhbnNsYXRpb25zIikpOwp2YXIgX2NvbnRlbnRQYWQgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIkAvY29tcG9uZW50cy9icG1uUHJvY2Vzc0Rlc2lnbmVyL3BhY2thZ2UvZGVzaWduZXIvcGx1Z2lucy9jb250ZW50LXBhZCIpKTsKdmFyIF9wYWxldHRlID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJAL2NvbXBvbmVudHMvYnBtblByb2Nlc3NEZXNpZ25lci9wYWNrYWdlL2Rlc2lnbmVyL3BsdWdpbnMvcGFsZXR0ZSIpKTsKdmFyIF9Qcm9jZXNzUGFsZXR0ZSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgiQC9jb21wb25lbnRzL2JwbW5Qcm9jZXNzRGVzaWduZXIvcGFja2FnZS9wYWxldHRlL1Byb2Nlc3NQYWxldHRlIikpOwp2YXIgX21vZGVsID0gcmVxdWlyZSgiQC9hcGkvYnBtL21vZGVsIik7Ci8vIOiHquWumuS5ieWFg+e0oOmAieS4reaXtueahOW8ueWHuuiPnOWNle+8iOS/ruaUuSDpu5jorqTku7vliqEg5Li6IOeUqOaIt+S7u+WKoe+8iQovLyDoh6rlrprkuYnlt6bkvqfoj5zljZXvvIjkv67mlLkg6buY6K6k5Lu75YqhIOS4uiDnlKjmiLfku7vliqHvvIkKLy8gaW1wb3J0IHhtbE9iajJqc29uIGZyb20gIi4vdXRpbHMveG1sMmpzb24iOwovLyDoh6rlrprkuYnkvqfovrnmoI8KLy8gaW1wb3J0IE15UHJvY2Vzc1BhbmVsIGZyb20gIi4uL3BhY2thZ2UvcHJvY2Vzcy1wYW5lbC9Qcm9jZXNzUGFuZWwiOwp2YXIgX2RlZmF1bHQgPSBleHBvcnRzLmRlZmF1bHQgPSB7CiAgbmFtZTogIkJwbU1vZGVsRWRpdG9yIiwKICBjb21wb25lbnRzOiB7CiAgICBNeVByb2Nlc3NQYWxldHRlOiBfUHJvY2Vzc1BhbGV0dGUuZGVmYXVsdAogIH0sCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHhtbFN0cmluZzogdW5kZWZpbmVkLAogICAgICAvLyBCUE1OIFhNTAogICAgICBtb2RlbGVyOiBudWxsLAogICAgICByZWxvYWRJbmRleDogMCwKICAgICAgY29udHJvbERyYXdlclZpc2libGU6IGZhbHNlLAogICAgICB0cmFuc2xhdGlvbnNTZWxmOiBfdHJhbnNsYXRpb25zLmRlZmF1bHQsCiAgICAgIGNvbnRyb2xGb3JtOiB7CiAgICAgICAgc2ltdWxhdGlvbjogdHJ1ZSwKICAgICAgICBsYWJlbEVkaXRpbmc6IGZhbHNlLAogICAgICAgIGxhYmVsVmlzaWJsZTogZmFsc2UsCiAgICAgICAgcHJlZml4OiAiZmxvd2FibGUiLAogICAgICAgIGhlYWRlckJ1dHRvblNpemU6ICJtaW5pIiwKICAgICAgICBhZGRpdGlvbmFsTW9kZWw6IFtfY29udGVudFBhZC5kZWZhdWx0LCBfcGFsZXR0ZS5kZWZhdWx0XQogICAgICB9LAogICAgICBhZGRpczogewogICAgICAgIEN1c3RvbUNvbnRlbnRQYWRQcm92aWRlcjogX2NvbnRlbnRQYWQuZGVmYXVsdCwKICAgICAgICBDdXN0b21QYWxldHRlUHJvdmlkZXI6IF9wYWxldHRlLmRlZmF1bHQKICAgICAgfSwKICAgICAgLy8g5rWB56iL5qih5Z6L55qE5L+h5oGvCiAgICAgIG1vZGVsOiB7fQogICAgfTsKICB9LAogIGNyZWF0ZWQ6IGZ1bmN0aW9uIGNyZWF0ZWQoKSB7CiAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgLy8g5aaC5p6cIG1vZGVsSWQg6Z2e56m677yM6K+05piO5piv5L+u5pS55rWB56iL5qih5Z6LCiAgICB2YXIgbW9kZWxJZCA9IHRoaXMuJHJvdXRlLnF1ZXJ5ICYmIHRoaXMuJHJvdXRlLnF1ZXJ5Lm1vZGVsSWQ7CiAgICBpZiAobW9kZWxJZCkgewogICAgICAoMCwgX21vZGVsLmdldE1vZGVsKShtb2RlbElkKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIF90aGlzLnhtbFN0cmluZyA9IHJlc3BvbnNlLmRhdGEuYnBtblhtbDsKICAgICAgICBfdGhpcy5tb2RlbCA9ICgwLCBfb2JqZWN0U3ByZWFkMi5kZWZhdWx0KSgoMCwgX29iamVjdFNwcmVhZDIuZGVmYXVsdCkoe30sIHJlc3BvbnNlLmRhdGEpLCB7fSwgewogICAgICAgICAgYnBtblhtbDogdW5kZWZpbmVkIC8vIOa4heepuiBicG1uWG1sIOWxnuaApwogICAgICAgIH0pOwogICAgICAgIC8vIHRoaXMuY29udHJvbEZvcm0ucHJvY2Vzc0lkID0gcmVzcG9uc2UuZGF0YS5rZXkKICAgICAgfSk7CiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICBpbml0TW9kZWxlcjogZnVuY3Rpb24gaW5pdE1vZGVsZXIobW9kZWxlcikgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgX3RoaXMyLm1vZGVsZXIgPSBtb2RlbGVyOwogICAgICAgIGNvbnNvbGUubG9nKG1vZGVsZXIpOwogICAgICB9LCAxMCk7CiAgICB9LAogICAgc2F2ZTogZnVuY3Rpb24gc2F2ZShicG1uWG1sKSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwogICAgICB2YXIgZGF0YSA9ICgwLCBfb2JqZWN0U3ByZWFkMi5kZWZhdWx0KSgoMCwgX29iamVjdFNwcmVhZDIuZGVmYXVsdCkoe30sIHRoaXMubW9kZWwpLCB7fSwgewogICAgICAgIGJwbW5YbWw6IGJwbW5YbWwgLy8gdGhpcy5icG1uWG1sIOWPquaYr+WIneWni+WMlua1geeoi+Wbvu+8jOWQjue7reS/ruaUueaXoOazlemAmui/h+Wug+iOt+W+lwogICAgICB9KTsKCiAgICAgIC8vIOS/ruaUueeahOaPkOS6pAogICAgICBpZiAoZGF0YS5pZCkgewogICAgICAgICgwLCBfbW9kZWwudXBkYXRlTW9kZWwpKGRhdGEpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICBfdGhpczMuJG1vZGFsLm1zZ1N1Y2Nlc3MoIuS/ruaUueaIkOWKnyIpOwogICAgICAgICAgLy8g6Lez6L2s5Zue5Y67CiAgICAgICAgICBfdGhpczMuY2xvc2UoKTsKICAgICAgICB9KTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgLy8g5re75Yqg55qE5o+Q5LqkCiAgICAgICgwLCBfbW9kZWwuY3JlYXRlTW9kZWwpKGRhdGEpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgX3RoaXMzLiRtb2RhbC5tc2dTdWNjZXNzKCLkv53lrZjmiJDlip8iKTsKICAgICAgICAvLyDot7Povazlm57ljrsKICAgICAgICBfdGhpczMuY2xvc2UoKTsKICAgICAgfSk7CiAgICB9LAogICAgLyoqIOWFs+mXreaMiemSriAqL2Nsb3NlOiBmdW5jdGlvbiBjbG9zZSgpIHsKICAgICAgdGhpcy4kdGFiLmNsb3NlT3BlblBhZ2UoewogICAgICAgIHBhdGg6ICIvYnBtL21hbmFnZXIvbW9kZWwiCiAgICAgIH0pOwogICAgfQogIH0KfTs="},{"version":3,"names":["_translations","_interopRequireDefault","require","_contentPad","_palette","_ProcessPalette","_model","_default","exports","default","name","components","MyProcessPalette","data","xmlString","undefined","modeler","reloadIndex","controlDrawerVisible","translationsSelf","translations","controlForm","simulation","labelEditing","labelVisible","prefix","headerButtonSize","additionalModel","CustomContentPadProvider","CustomPaletteProvider","addis","model","created","_this","modelId","$route","query","getModel","then","response","bpmnXml","_objectSpread2","methods","initModeler","_this2","setTimeout","console","log","save","_this3","id","updateModel","$modal","msgSuccess","close","createModel","$tab","closeOpenPage","path"],"sources":["src/views/bpm/model/modelEditor.vue"],"sourcesContent":["<template>\r\n  <div class=\"app-container\">\r\n\r\n    <!-- 流程设计器，负责绘制流程等 -->\r\n    <my-process-designer v-if=\"xmlString !== undefined\" :key=\"`designer-${reloadIndex}`\" v-model=\"xmlString\" v-bind=\"controlForm\"\r\n      keyboard ref=\"processDesigner\" @init-finished=\"initModeler\"\r\n      @save=\"save\"/>\r\n\r\n    <!-- 流程属性器，负责编辑每个流程节点的属性 -->\r\n    <my-properties-panel :key=\"`penal-${reloadIndex}`\" :bpmn-modeler=\"modeler\" :prefix=\"controlForm.prefix\" class=\"process-panel\"\r\n      :model=\"model\" />\r\n\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport translations from \"@/components/bpmnProcessDesigner/src/translations\";\r\n// 自定义元素选中时的弹出菜单（修改 默认任务 为 用户任务）\r\nimport CustomContentPadProvider from \"@/components/bpmnProcessDesigner/package/designer/plugins/content-pad\";\r\n// 自定义左侧菜单（修改 默认任务 为 用户任务）\r\nimport CustomPaletteProvider from \"@/components/bpmnProcessDesigner/package/designer/plugins/palette\";\r\n// import xmlObj2json from \"./utils/xml2json\";\r\nimport MyProcessPalette from \"@/components/bpmnProcessDesigner/package/palette/ProcessPalette\";\r\nimport {createModel, getModel, updateModel} from \"@/api/bpm/model\";\r\n// 自定义侧边栏\r\n// import MyProcessPanel from \"../package/process-panel/ProcessPanel\";\r\n\r\nexport default {\r\n  name: \"BpmModelEditor\",\r\n  components: { MyProcessPalette },\r\n  data() {\r\n    return {\r\n      xmlString: undefined, // BPMN XML\r\n      modeler: null,\r\n      reloadIndex: 0,\r\n      controlDrawerVisible: false,\r\n      translationsSelf: translations,\r\n      controlForm: {\r\n        simulation: true,\r\n        labelEditing: false,\r\n        labelVisible: false,\r\n        prefix: \"flowable\",\r\n        headerButtonSize: \"mini\",\r\n        additionalModel: [CustomContentPadProvider, CustomPaletteProvider]\r\n      },\r\n      addis: {\r\n        CustomContentPadProvider,\r\n        CustomPaletteProvider\r\n      },\r\n      // 流程模型的信息\r\n      model: {},\r\n    };\r\n  },\r\n  created() {\r\n    // 如果 modelId 非空，说明是修改流程模型\r\n    const modelId = this.$route.query && this.$route.query.modelId\r\n    if (modelId) {\r\n      getModel(modelId).then(response => {\r\n        this.xmlString = response.data.bpmnXml\r\n        this.model = {\r\n          ...response.data,\r\n          bpmnXml: undefined, // 清空 bpmnXml 属性\r\n        }\r\n        // this.controlForm.processId = response.data.key\r\n      })\r\n    }\r\n  },\r\n  methods: {\r\n    initModeler(modeler) {\r\n      setTimeout(() => {\r\n        this.modeler = modeler;\r\n        console.log(modeler);\r\n      }, 10);\r\n    },\r\n    save(bpmnXml) {\r\n      const data = {\r\n        ...this.model,\r\n        bpmnXml: bpmnXml, // this.bpmnXml 只是初始化流程图，后续修改无法通过它获得\r\n      }\r\n\r\n      // 修改的提交\r\n      if (data.id) {\r\n        updateModel(data).then(response => {\r\n          this.$modal.msgSuccess(\"修改成功\")\r\n          // 跳转回去\r\n          this.close()\r\n        })\r\n        return\r\n      }\r\n      // 添加的提交\r\n      createModel(data).then(response => {\r\n        this.$modal.msgSuccess(\"保存成功\")\r\n        // 跳转回去\r\n        this.close()\r\n      })\r\n    },\r\n    /** 关闭按钮 */\r\n    close() {\r\n      this.$tab.closeOpenPage({ path: \"/bpm/manager/model\" });\r\n    },\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n//body {\r\n//  overflow: hidden;\r\n//  margin: 0;\r\n//  box-sizing: border-box;\r\n//}\r\n//.app {\r\n//  width: 100%;\r\n//  height: 100%;\r\n//  box-sizing: border-box;\r\n//  display: inline-grid;\r\n//  grid-template-columns: 100px auto max-content;\r\n//}\r\n.demo-control-bar {\r\n  position: fixed;\r\n  right: 8px;\r\n  bottom: 8px;\r\n  z-index: 1;\r\n  .open-control-dialog {\r\n    width: 48px;\r\n    height: 48px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    border-radius: 4px;\r\n    font-size: 32px;\r\n    background: rgba(64, 158, 255, 1);\r\n    color: #ffffff;\r\n    cursor: pointer;\r\n  }\r\n}\r\n\r\n// TODO 芋艿：去掉多余的 faq\r\n//.info-tip {\r\n//  position: fixed;\r\n//  top: 40px;\r\n//  right: 500px;\r\n//  z-index: 10;\r\n//  color: #999999;\r\n//}\r\n\r\n.control-form {\r\n  .el-radio {\r\n    width: 100%;\r\n    line-height: 32px;\r\n  }\r\n}\r\n.element-overlays {\r\n  box-sizing: border-box;\r\n  padding: 8px;\r\n  background: rgba(0, 0, 0, 0.6);\r\n  border-radius: 4px;\r\n  color: #fafafa;\r\n}\r\n\r\n.my-process-designer {\r\n  height: calc(100vh - 84px);\r\n}\r\n.process-panel__container {\r\n  position: absolute;\r\n  right: 0;\r\n  top: 55px;\r\n  height: calc(100vh - 84px);\r\n}\r\n\r\n</style>\r\n"],"mappings":";;;;;;;;AAgBA,IAAAA,aAAA,GAAAC,sBAAA,CAAAC,OAAA;AAEA,IAAAC,WAAA,GAAAF,sBAAA,CAAAC,OAAA;AAEA,IAAAE,QAAA,GAAAH,sBAAA,CAAAC,OAAA;AAEA,IAAAG,eAAA,GAAAJ,sBAAA,CAAAC,OAAA;AACA,IAAAI,MAAA,GAAAJ,OAAA;AANA;AAEA;AAEA;AAGA;AACA;AAAA,IAAAK,QAAA,GAAAC,OAAA,CAAAC,OAAA,GAEA;EACAC,IAAA;EACAC,UAAA;IAAAC,gBAAA,EAAAA;EAAA;EACAC,IAAA,WAAAA,KAAA;IACA;MACAC,SAAA,EAAAC,SAAA;MAAA;MACAC,OAAA;MACAC,WAAA;MACAC,oBAAA;MACAC,gBAAA,EAAAC,qBAAA;MACAC,WAAA;QACAC,UAAA;QACAC,YAAA;QACAC,YAAA;QACAC,MAAA;QACAC,gBAAA;QACAC,eAAA,GAAAC,mBAAA,EAAAC,gBAAA;MACA;MACAC,KAAA;QACAF,wBAAA,EAAAA,mBAAA;QACAC,qBAAA,EAAAA;MACA;MACA;MACAE,KAAA;IACA;EACA;EACAC,OAAA,WAAAA,QAAA;IAAA,IAAAC,KAAA;IACA;IACA,IAAAC,OAAA,QAAAC,MAAA,CAAAC,KAAA,SAAAD,MAAA,CAAAC,KAAA,CAAAF,OAAA;IACA,IAAAA,OAAA;MACA,IAAAG,eAAA,EAAAH,OAAA,EAAAI,IAAA,WAAAC,QAAA;QACAN,KAAA,CAAAnB,SAAA,GAAAyB,QAAA,CAAA1B,IAAA,CAAA2B,OAAA;QACAP,KAAA,CAAAF,KAAA,OAAAU,cAAA,CAAAhC,OAAA,MAAAgC,cAAA,CAAAhC,OAAA,MACA8B,QAAA,CAAA1B,IAAA;UACA2B,OAAA,EAAAzB,SAAA;QAAA,EACA;QACA;MACA;IACA;EACA;EACA2B,OAAA;IACAC,WAAA,WAAAA,YAAA3B,OAAA;MAAA,IAAA4B,MAAA;MACAC,UAAA;QACAD,MAAA,CAAA5B,OAAA,GAAAA,OAAA;QACA8B,OAAA,CAAAC,GAAA,CAAA/B,OAAA;MACA;IACA;IACAgC,IAAA,WAAAA,KAAAR,OAAA;MAAA,IAAAS,MAAA;MACA,IAAApC,IAAA,OAAA4B,cAAA,CAAAhC,OAAA,MAAAgC,cAAA,CAAAhC,OAAA,MACA,KAAAsB,KAAA;QACAS,OAAA,EAAAA,OAAA;MAAA,EACA;;MAEA;MACA,IAAA3B,IAAA,CAAAqC,EAAA;QACA,IAAAC,kBAAA,EAAAtC,IAAA,EAAAyB,IAAA,WAAAC,QAAA;UACAU,MAAA,CAAAG,MAAA,CAAAC,UAAA;UACA;UACAJ,MAAA,CAAAK,KAAA;QACA;QACA;MACA;MACA;MACA,IAAAC,kBAAA,EAAA1C,IAAA,EAAAyB,IAAA,WAAAC,QAAA;QACAU,MAAA,CAAAG,MAAA,CAAAC,UAAA;QACA;QACAJ,MAAA,CAAAK,KAAA;MACA;IACA;IACA,WACAA,KAAA,WAAAA,MAAA;MACA,KAAAE,IAAA,CAAAC,aAAA;QAAAC,IAAA;MAAA;IACA;EACA;AACA"}]}