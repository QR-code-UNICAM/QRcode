{"remainingRequest":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\src\\views\\sso.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\src\\views\\sso.vue","mtime":1704630438057},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\babel.config.js","mtime":1704630437199},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKdmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKCJDOi9Vc2Vycy84OTQyNS9JZGVhUHJvamVjdHMvcXItY29kZS12dWUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvaW50ZXJvcFJlcXVpcmVEZWZhdWx0LmpzIikuZGVmYXVsdDsKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7CnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5wdXNoLmpzIik7CnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5maWx0ZXIuanMiKTsKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiKTsKdmFyIF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgiQzovVXNlcnMvODk0MjUvSWRlYVByb2plY3RzL3FyLWNvZGUtdnVlL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIuanMiKSk7CnZhciBfbG9naW4gPSByZXF1aXJlKCJAL2FwaS9sb2dpbiIpOwp2YXIgX2RlZmF1bHQgPSBleHBvcnRzLmRlZmF1bHQgPSB7CiAgbmFtZTogIkxvZ2luIiwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgbG9naW5Gb3JtOiB7CiAgICAgICAgc2NvcGVzOiBbXSAvLyDlt7LpgInkuK3nmoQgc2NvcGUg5pWw57uECiAgICAgIH0sCiAgICAgIHBhcmFtczogewogICAgICAgIC8vIFVSTCDkuIrnmoQgY2xpZW50X2lk44CBc2NvcGUg562J5Y+C5pWwCiAgICAgICAgcmVzcG9uc2VUeXBlOiB1bmRlZmluZWQsCiAgICAgICAgY2xpZW50SWQ6IHVuZGVmaW5lZCwKICAgICAgICByZWRpcmVjdFVyaTogdW5kZWZpbmVkLAogICAgICAgIHN0YXRlOiB1bmRlZmluZWQsCiAgICAgICAgc2NvcGVzOiBbXSAvLyDkvJjlhYjku44gcXVlcnkg5Y+C5pWw6I635Y+W77yb5aaC5p6c5pyq5Lyg6YCS77yM5LuO5ZCO56uv6I635Y+WCiAgICAgIH0sCiAgICAgIGNsaWVudDogewogICAgICAgIC8vIOWuouaIt+err+S/oeaBrwogICAgICAgIG5hbWU6ICcnLAogICAgICAgIGxvZ286ICcnCiAgICAgIH0sCiAgICAgIGxvYWRpbmc6IGZhbHNlCiAgICB9OwogIH0sCiAgY3JlYXRlZDogZnVuY3Rpb24gY3JlYXRlZCgpIHsKICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAvLyDop6PmnpDlj4LmlbAKICAgIC8vIOS+i+WmguivtOOAkOiHquWKqOaOiOadg+S4jemAmui/h+OAke+8mmNsaWVudF9pZD1kZWZhdWx0JnJlZGlyZWN0X3VyaT1odHRwcyUzQSUyRiUyRnd3dy5pb2NvZGVyLmNuJnJlc3BvbnNlX3R5cGU9Y29kZSZzY29wZT11c2VyLnJlYWQlMjB1c2VyLndyaXRlCiAgICAvLyDkvovlpoLor7TjgJDoh6rliqjmjojmnYPpgJrov4fjgJHvvJpjbGllbnRfaWQ9ZGVmYXVsdCZyZWRpcmVjdF91cmk9aHR0cHMlM0ElMkYlMkZ3d3cuaW9jb2Rlci5jbiZyZXNwb25zZV90eXBlPWNvZGUmc2NvcGU9dXNlci5yZWFkCiAgICB0aGlzLnBhcmFtcy5yZXNwb25zZVR5cGUgPSB0aGlzLiRyb3V0ZS5xdWVyeS5yZXNwb25zZV90eXBlOwogICAgdGhpcy5wYXJhbXMuY2xpZW50SWQgPSB0aGlzLiRyb3V0ZS5xdWVyeS5jbGllbnRfaWQ7CiAgICB0aGlzLnBhcmFtcy5yZWRpcmVjdFVyaSA9IHRoaXMuJHJvdXRlLnF1ZXJ5LnJlZGlyZWN0X3VyaTsKICAgIHRoaXMucGFyYW1zLnN0YXRlID0gdGhpcy4kcm91dGUucXVlcnkuc3RhdGU7CiAgICBpZiAodGhpcy4kcm91dGUucXVlcnkuc2NvcGUpIHsKICAgICAgdGhpcy5wYXJhbXMuc2NvcGVzID0gdGhpcy4kcm91dGUucXVlcnkuc2NvcGUuc3BsaXQoJyAnKTsKICAgIH0KCiAgICAvLyDlpoLmnpzmnIkgc2NvcGUg5Y+C5pWw77yM5YWI5omn6KGM5LiA5qyh6Ieq5Yqo5o6I5p2D77yM55yL55yL5piv5ZCm5LmL5YmN6YO95o6I5p2D6L+H5LqG44CCCiAgICBpZiAodGhpcy5wYXJhbXMuc2NvcGVzLmxlbmd0aCA+IDApIHsKICAgICAgdGhpcy5kb0F1dGhvcml6ZSh0cnVlLCB0aGlzLnBhcmFtcy5zY29wZXMsIFtdKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICB2YXIgaHJlZiA9IHJlcy5kYXRhOwogICAgICAgIGlmICghaHJlZikgewogICAgICAgICAgY29uc29sZS5sb2coJ+iHquWKqOaOiOadg+acqumAmui/h++8gScpOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBsb2NhdGlvbi5ocmVmID0gaHJlZjsKICAgICAgfSk7CiAgICB9CgogICAgLy8g6I635Y+W5o6I5p2D6aG155qE5Z+65pys5L+h5oGvCiAgICAoMCwgX2xvZ2luLmdldEF1dGhvcml6ZSkodGhpcy5wYXJhbXMuY2xpZW50SWQpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICBfdGhpcy5jbGllbnQgPSByZXMuZGF0YS5jbGllbnQ7CiAgICAgIC8vIOino+aekCBzY29wZQogICAgICB2YXIgc2NvcGVzOwogICAgICAvLyAxLjEg5aaC5p6cIHBhcmFtcy5zY29wZSDpnZ7nqbrvvIzliJnov4fmu6TkuIvov5Tlm57nmoQgc2NvcGVzCiAgICAgIGlmIChfdGhpcy5wYXJhbXMuc2NvcGVzLmxlbmd0aCA+IDApIHsKICAgICAgICBzY29wZXMgPSBbXTsKICAgICAgICB2YXIgX2l0ZXJhdG9yID0gKDAsIF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyMi5kZWZhdWx0KShyZXMuZGF0YS5zY29wZXMpLAogICAgICAgICAgX3N0ZXA7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIGZvciAoX2l0ZXJhdG9yLnMoKTsgIShfc3RlcCA9IF9pdGVyYXRvci5uKCkpLmRvbmU7KSB7CiAgICAgICAgICAgIHZhciBzY29wZSA9IF9zdGVwLnZhbHVlOwogICAgICAgICAgICBpZiAoX3RoaXMucGFyYW1zLnNjb3Blcy5pbmRleE9mKHNjb3BlLmtleSkgPj0gMCkgewogICAgICAgICAgICAgIHNjb3Blcy5wdXNoKHNjb3BlKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgLy8gMS4yIOWmguaenCBwYXJhbXMuc2NvcGUg5Li656m677yM5YiZ5L2/55So6L+U5Zue55qEIHNjb3BlcyDorr7nva7lroMKICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgIF9pdGVyYXRvci5lKGVycik7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgIF9pdGVyYXRvci5mKCk7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHNjb3BlcyA9IHJlcy5kYXRhLnNjb3BlczsKICAgICAgICB2YXIgX2l0ZXJhdG9yMiA9ICgwLCBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcjIuZGVmYXVsdCkoc2NvcGVzKSwKICAgICAgICAgIF9zdGVwMjsKICAgICAgICB0cnkgewogICAgICAgICAgZm9yIChfaXRlcmF0b3IyLnMoKTsgIShfc3RlcDIgPSBfaXRlcmF0b3IyLm4oKSkuZG9uZTspIHsKICAgICAgICAgICAgdmFyIF9zY29wZSA9IF9zdGVwMi52YWx1ZTsKICAgICAgICAgICAgX3RoaXMucGFyYW1zLnNjb3Blcy5wdXNoKF9zY29wZS5rZXkpOwogICAgICAgICAgfQogICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgX2l0ZXJhdG9yMi5lKGVycik7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgIF9pdGVyYXRvcjIuZigpOwogICAgICAgIH0KICAgICAgfQogICAgICAvLyDnlJ/miJDlt7LpgInkuK3nmoQgY2hlY2tlZFNjb3BlcwogICAgICB2YXIgX2l0ZXJhdG9yMyA9ICgwLCBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcjIuZGVmYXVsdCkoc2NvcGVzKSwKICAgICAgICBfc3RlcDM7CiAgICAgIHRyeSB7CiAgICAgICAgZm9yIChfaXRlcmF0b3IzLnMoKTsgIShfc3RlcDMgPSBfaXRlcmF0b3IzLm4oKSkuZG9uZTspIHsKICAgICAgICAgIHZhciBfc2NvcGUyID0gX3N0ZXAzLnZhbHVlOwogICAgICAgICAgaWYgKF9zY29wZTIudmFsdWUpIHsKICAgICAgICAgICAgX3RoaXMubG9naW5Gb3JtLnNjb3Blcy5wdXNoKF9zY29wZTIua2V5KTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgIF9pdGVyYXRvcjMuZShlcnIpOwogICAgICB9IGZpbmFsbHkgewogICAgICAgIF9pdGVyYXRvcjMuZigpOwogICAgICB9CiAgICB9KTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGhhbmRsZUF1dGhvcml6ZTogZnVuY3Rpb24gaGFuZGxlQXV0aG9yaXplKGFwcHJvdmVkKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwogICAgICB0aGlzLiRyZWZzLmxvZ2luRm9ybS52YWxpZGF0ZShmdW5jdGlvbiAodmFsaWQpIHsKICAgICAgICBpZiAoIXZhbGlkKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIF90aGlzMi5sb2FkaW5nID0gdHJ1ZTsKICAgICAgICAvLyDorqHnrpcgY2hlY2tlZFNjb3BlcyArIHVuY2hlY2tlZFNjb3BlcwogICAgICAgIHZhciBjaGVja2VkU2NvcGVzOwogICAgICAgIHZhciB1bmNoZWNrZWRTY29wZXM7CiAgICAgICAgaWYgKGFwcHJvdmVkKSB7CiAgICAgICAgICAvLyDlkIzmhI/mjojmnYPvvIzmjInnhafnlKjmiLfnmoTpgInmi6kKICAgICAgICAgIGNoZWNrZWRTY29wZXMgPSBfdGhpczIubG9naW5Gb3JtLnNjb3BlczsKICAgICAgICAgIHVuY2hlY2tlZFNjb3BlcyA9IF90aGlzMi5wYXJhbXMuc2NvcGVzLmZpbHRlcihmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgICByZXR1cm4gY2hlY2tlZFNjb3Blcy5pbmRleE9mKGl0ZW0pID09PSAtMTsKICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAvLyDmi5Lnu53vvIzliJnpg73mmK/lj5bmtogKICAgICAgICAgIGNoZWNrZWRTY29wZXMgPSBbXTsKICAgICAgICAgIHVuY2hlY2tlZFNjb3BlcyA9IF90aGlzMi5wYXJhbXMuc2NvcGVzOwogICAgICAgIH0KICAgICAgICAvLyDmj5DkuqTmjojmnYPnmoTor7fmsYIKICAgICAgICBfdGhpczIuZG9BdXRob3JpemUoZmFsc2UsIGNoZWNrZWRTY29wZXMsIHVuY2hlY2tlZFNjb3BlcykudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgICB2YXIgaHJlZiA9IHJlcy5kYXRhOwogICAgICAgICAgaWYgKCFocmVmKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KICAgICAgICAgIGxvY2F0aW9uLmhyZWYgPSBocmVmOwogICAgICAgIH0pLmZpbmFsbHkoZnVuY3Rpb24gKCkgewogICAgICAgICAgX3RoaXMyLmxvYWRpbmcgPSBmYWxzZTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9LAogICAgZG9BdXRob3JpemU6IGZ1bmN0aW9uIGRvQXV0aG9yaXplKGF1dG9BcHByb3ZlLCBjaGVja2VkU2NvcGVzLCB1bmNoZWNrZWRTY29wZXMpIHsKICAgICAgcmV0dXJuICgwLCBfbG9naW4uYXV0aG9yaXplKSh0aGlzLnBhcmFtcy5yZXNwb25zZVR5cGUsIHRoaXMucGFyYW1zLmNsaWVudElkLCB0aGlzLnBhcmFtcy5yZWRpcmVjdFVyaSwgdGhpcy5wYXJhbXMuc3RhdGUsIGF1dG9BcHByb3ZlLCBjaGVja2VkU2NvcGVzLCB1bmNoZWNrZWRTY29wZXMpOwogICAgfSwKICAgIGZvcm1hdFNjb3BlOiBmdW5jdGlvbiBmb3JtYXRTY29wZShzY29wZSkgewogICAgICAvLyDmoLzlvI/ljJYgc2NvcGUg5o6I5p2D6IyD5Zu077yM5pa55L6/55So5oi355CG6Kej44CCCiAgICAgIC8vIOi/memHjOS7heS7heaYr+S4gOS4qiBkZW1v77yM5Y+v5Lul6ICD6JmR5b2V5YWl5Yiw5a2X5YW45pWw5o2u5Lit77yM5L6L5aaC6K+05a2X5YW457G75Z6LICJzeXN0ZW1fb2F1dGgyX3Njb3BlIu+8jOWug+eahOavj+S4qiBzY29wZSDpg73mmK/kuIDmnaHlrZflhbjmlbDmja7jgIIKICAgICAgc3dpdGNoIChzY29wZSkgewogICAgICAgIGNhc2UgJ3VzZXIucmVhZCc6CiAgICAgICAgICByZXR1cm4gJ+iuv+mXruS9oOeahOS4quS6uuS/oeaBryc7CiAgICAgICAgY2FzZSAndXNlci53cml0ZSc6CiAgICAgICAgICByZXR1cm4gJ+S/ruaUueS9oOeahOS4quS6uuS/oeaBryc7CiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgIHJldHVybiBzY29wZTsKICAgICAgfQogICAgfQogIH0KfTs="},{"version":3,"names":["_login","require","_default","exports","default","name","data","loginForm","scopes","params","responseType","undefined","clientId","redirectUri","state","client","logo","loading","created","_this","$route","query","response_type","client_id","redirect_uri","scope","split","length","doAuthorize","then","res","href","console","log","location","getAuthorize","_iterator","_createForOfIteratorHelper2","_step","s","n","done","value","indexOf","key","push","err","e","f","_iterator2","_step2","_iterator3","_step3","methods","handleAuthorize","approved","_this2","$refs","validate","valid","checkedScopes","uncheckedScopes","filter","item","finally","autoApprove","authorize","formatScope"],"sources":["src/views/sso.vue"],"sourcesContent":["<template>\r\n  <div class=\"container\">\r\n    <div class=\"logo\"></div>\r\n    <!-- 登录区域 -->\r\n    <div class=\"content\">\r\n      <!-- 配图 -->\r\n      <div class=\"pic\"></div>\r\n      <!-- 表单 -->\r\n      <div class=\"field\">\r\n        <!-- [移动端]标题 -->\r\n        <h2 class=\"mobile-title\">\r\n          <h3 class=\"title\">芋道后台管理系统</h3>\r\n        </h2>\r\n\r\n        <!-- 表单 -->\r\n        <div class=\"form-cont\">\r\n          <el-tabs class=\"form\" style=\" float:none;\" value=\"uname\">\r\n            <el-tab-pane :label=\"'三方授权（' + client.name + ')'\" name=\"uname\">\r\n            </el-tab-pane>\r\n          </el-tabs>\r\n          <div>\r\n            <el-form ref=\"loginForm\" :model=\"loginForm\" class=\"login-form\">\r\n              <!-- 授权范围的选择 -->\r\n              此第三方应用请求获得以下权限：\r\n              <el-form-item prop=\"scopes\">\r\n                <el-checkbox-group v-model=\"loginForm.scopes\">\r\n                  <el-checkbox v-for=\"scope in params.scopes\" :label=\"scope\" :key=\"scope\"\r\n                               style=\"display: block; margin-bottom: -10px;\">{{formatScope(scope)}}</el-checkbox>\r\n                </el-checkbox-group>\r\n              </el-form-item>\r\n              <!-- 下方的登录按钮 -->\r\n              <el-form-item style=\"width:100%;\">\r\n                <el-button :loading=\"loading\" size=\"medium\" type=\"primary\" style=\"width:60%;\"\r\n                           @click.native.prevent=\"handleAuthorize(true)\">\r\n                  <span v-if=\"!loading\">同意授权</span>\r\n                  <span v-else>授 权 中...</span>\r\n                </el-button>\r\n                <el-button size=\"medium\" style=\"width:36%\"\r\n                           @click.native.prevent=\"handleAuthorize(false)\">拒绝</el-button>\r\n              </el-form-item>\r\n            </el-form>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <!-- footer -->\r\n    <div class=\"footer\">\r\n      Copyright © 2020-2022 iocoder.cn All Rights Reserved.\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {authorize, getAuthorize} from \"@/api/login\";\r\n\r\nexport default {\r\n  name: \"Login\",\r\n  data() {\r\n    return {\r\n      loginForm: {\r\n        scopes: [], // 已选中的 scope 数组\r\n      },\r\n      params: { // URL 上的 client_id、scope 等参数\r\n        responseType: undefined,\r\n        clientId: undefined,\r\n        redirectUri: undefined,\r\n        state: undefined,\r\n        scopes: [], // 优先从 query 参数获取；如果未传递，从后端获取\r\n      },\r\n      client: { // 客户端信息\r\n        name: '',\r\n        logo: '',\r\n      },\r\n      loading: false\r\n    };\r\n  },\r\n  created() {\r\n    // 解析参数\r\n    // 例如说【自动授权不通过】：client_id=default&redirect_uri=https%3A%2F%2Fwww.iocoder.cn&response_type=code&scope=user.read%20user.write\r\n    // 例如说【自动授权通过】：client_id=default&redirect_uri=https%3A%2F%2Fwww.iocoder.cn&response_type=code&scope=user.read\r\n    this.params.responseType = this.$route.query.response_type\r\n    this.params.clientId = this.$route.query.client_id\r\n    this.params.redirectUri = this.$route.query.redirect_uri\r\n    this.params.state = this.$route.query.state\r\n    if (this.$route.query.scope) {\r\n      this.params.scopes = this.$route.query.scope.split(' ')\r\n    }\r\n\r\n    // 如果有 scope 参数，先执行一次自动授权，看看是否之前都授权过了。\r\n    if (this.params.scopes.length > 0) {\r\n      this.doAuthorize(true, this.params.scopes, []).then(res => {\r\n        const href = res.data\r\n        if (!href) {\r\n          console.log('自动授权未通过！')\r\n          return;\r\n        }\r\n        location.href = href\r\n      })\r\n    }\r\n\r\n    // 获取授权页的基本信息\r\n    getAuthorize(this.params.clientId).then(res => {\r\n      this.client = res.data.client\r\n      // 解析 scope\r\n      let scopes\r\n      // 1.1 如果 params.scope 非空，则过滤下返回的 scopes\r\n      if (this.params.scopes.length > 0) {\r\n        scopes = []\r\n        for (const scope of res.data.scopes) {\r\n          if (this.params.scopes.indexOf(scope.key) >= 0) {\r\n            scopes.push(scope)\r\n          }\r\n        }\r\n      // 1.2 如果 params.scope 为空，则使用返回的 scopes 设置它\r\n      } else {\r\n        scopes = res.data.scopes\r\n        for (const scope of scopes) {\r\n          this.params.scopes.push(scope.key)\r\n        }\r\n      }\r\n      // 生成已选中的 checkedScopes\r\n      for (const scope of scopes) {\r\n        if (scope.value) {\r\n          this.loginForm.scopes.push(scope.key)\r\n        }\r\n      }\r\n    })\r\n  },\r\n  methods: {\r\n    handleAuthorize(approved) {\r\n      this.$refs.loginForm.validate(valid => {\r\n        if (!valid) {\r\n          return\r\n        }\r\n        this.loading = true\r\n        // 计算 checkedScopes + uncheckedScopes\r\n        let checkedScopes;\r\n        let uncheckedScopes;\r\n        if (approved) { // 同意授权，按照用户的选择\r\n          checkedScopes = this.loginForm.scopes\r\n          uncheckedScopes = this.params.scopes.filter(item => checkedScopes.indexOf(item) === -1)\r\n        } else { // 拒绝，则都是取消\r\n          checkedScopes = []\r\n          uncheckedScopes = this.params.scopes\r\n        }\r\n        // 提交授权的请求\r\n        this.doAuthorize(false, checkedScopes, uncheckedScopes).then(res => {\r\n          const href = res.data\r\n          if (!href) {\r\n            return;\r\n          }\r\n          location.href = href\r\n        }).finally(() => {\r\n          this.loading = false\r\n        })\r\n      })\r\n    },\r\n    doAuthorize(autoApprove, checkedScopes, uncheckedScopes) {\r\n      return authorize(this.params.responseType, this.params.clientId, this.params.redirectUri, this.params.state,\r\n          autoApprove, checkedScopes, uncheckedScopes)\r\n    },\r\n    formatScope(scope) {\r\n      // 格式化 scope 授权范围，方便用户理解。\r\n      // 这里仅仅是一个 demo，可以考虑录入到字典数据中，例如说字典类型 \"system_oauth2_scope\"，它的每个 scope 都是一条字典数据。\r\n      switch (scope) {\r\n        case 'user.read': return '访问你的个人信息'\r\n        case 'user.write': return '修改你的个人信息'\r\n        default: return scope\r\n      }\r\n    }\r\n  }\r\n};\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n@import \"~@/assets/styles/login.scss\";\r\n.oauth-login {\r\n  display: flex;\r\n  align-items: center;\r\n  cursor:pointer;\r\n}\r\n.oauth-login-item {\r\n  display: flex;\r\n  align-items: center;\r\n  margin-right: 10px;\r\n}\r\n.oauth-login-item img {\r\n  height: 25px;\r\n  width: 25px;\r\n}\r\n.oauth-login-item span:hover {\r\n  text-decoration: underline red;\r\n  color: red;\r\n}\r\n</style>\r\n"],"mappings":"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"}]}