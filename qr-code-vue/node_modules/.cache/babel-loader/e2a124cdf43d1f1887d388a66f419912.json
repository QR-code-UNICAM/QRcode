{"remainingRequest":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\src\\views\\bpm\\definition\\index.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\src\\views\\bpm\\definition\\index.vue","mtime":1704630437835},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\babel.config.js","mtime":1704630437199},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKdmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKCJDOi9Vc2Vycy84OTQyNS9JZGVhUHJvamVjdHMvcXItY29kZS12dWUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvaW50ZXJvcFJlcXVpcmVEZWZhdWx0LmpzIikuZGVmYXVsdDsKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7CnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3Qua2V5cy5qcyIpOwpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyIpOwp2YXIgX29iamVjdFNwcmVhZDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIkM6L1VzZXJzLzg5NDI1L0lkZWFQcm9qZWN0cy9xci1jb2RlLXZ1ZS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9vYmplY3RTcHJlYWQyLmpzIikpOwp2YXIgX2RlZmluaXRpb24gPSByZXF1aXJlKCJAL2FwaS9icG0vZGVmaW5pdGlvbiIpOwp2YXIgX2RpY3QgPSByZXF1aXJlKCJAL3V0aWxzL2RpY3QiKTsKdmFyIF9mb3JtR2VuZXJhdG9yID0gcmVxdWlyZSgiQC91dGlscy9mb3JtR2VuZXJhdG9yIik7CnZhciBfUGFyc2VyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJAL2NvbXBvbmVudHMvcGFyc2VyL1BhcnNlciIpKTsKdmFyIF90YXNrQXNzaWduUnVsZURpYWxvZyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgiLi4vdGFza0Fzc2lnblJ1bGUvdGFza0Fzc2lnblJ1bGVEaWFsb2ciKSk7CnZhciBfZGVmYXVsdCA9IGV4cG9ydHMuZGVmYXVsdCA9IHsKICBuYW1lOiAiQnBtUHJvY2Vzc0RlZmluaXRpb24iLAogIGNvbXBvbmVudHM6IHsKICAgIFBhcnNlcjogX1BhcnNlci5kZWZhdWx0LAogICAgdGFza0Fzc2lnblJ1bGVEaWFsb2c6IF90YXNrQXNzaWduUnVsZURpYWxvZy5kZWZhdWx0CiAgfSwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgLy8g6YGu572p5bGCCiAgICAgIGxvYWRpbmc6IHRydWUsCiAgICAgIC8vIOaAu+adoeaVsAogICAgICB0b3RhbDogMCwKICAgICAgLy8g6KGo5qC85pWw5o2uCiAgICAgIGxpc3Q6IFtdLAogICAgICAvLyDmn6Xor6Llj4LmlbAKICAgICAgcXVlcnlQYXJhbXM6IHsKICAgICAgICBwYWdlTm86IDEsCiAgICAgICAgcGFnZVNpemU6IDEwCiAgICAgIH0sCiAgICAgIC8vIOa1geeoi+ihqOWNleivpuaDhQogICAgICBkZXRhaWxPcGVuOiBmYWxzZSwKICAgICAgZGV0YWlsRm9ybTogewogICAgICAgIGZpZWxkczogW10KICAgICAgfSwKICAgICAgLy8gQlBNTiDmlbDmja4KICAgICAgc2hvd0JwbW5PcGVuOiBmYWxzZSwKICAgICAgYnBtblhNTDogbnVsbCwKICAgICAgYnBtbkNvbnRyb2xGb3JtOiB7CiAgICAgICAgcHJlZml4OiAiZmxvd2FibGUiCiAgICAgIH0sCiAgICAgIC8vIOaVsOaNruWtl+WFuAogICAgICBjYXRlZ29yeURpY3REYXRhczogKDAsIF9kaWN0LmdldERpY3REYXRhcykoX2RpY3QuRElDVF9UWVBFLkJQTV9NT0RFTF9DQVRFR09SWSkKICAgIH07CiAgfSwKICBjcmVhdGVkOiBmdW5jdGlvbiBjcmVhdGVkKCkgewogICAgdmFyIGtleSA9IHRoaXMuJHJvdXRlLnF1ZXJ5ICYmIHRoaXMuJHJvdXRlLnF1ZXJ5LmtleTsKICAgIGlmIChrZXkpIHsKICAgICAgdGhpcy5xdWVyeVBhcmFtc1sna2V5J10gPSBrZXk7CiAgICB9CiAgICB0aGlzLmdldExpc3QoKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIC8qKiDmn6Xor6LmtYHnqIvlrprkuYnliJfooaggKi9nZXRMaXN0OiBmdW5jdGlvbiBnZXRMaXN0KCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlOwogICAgICAoMCwgX2RlZmluaXRpb24uZ2V0UHJvY2Vzc0RlZmluaXRpb25QYWdlKSh0aGlzLnF1ZXJ5UGFyYW1zKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIF90aGlzLmxpc3QgPSByZXNwb25zZS5kYXRhLmxpc3Q7CiAgICAgICAgX3RoaXMudG90YWwgPSByZXNwb25zZS5kYXRhLnRvdGFsOwogICAgICAgIF90aGlzLmxvYWRpbmcgPSBmYWxzZTsKICAgICAgfSk7CiAgICB9LAogICAgLyoqIOa1geeoi+ihqOWNleeahOivpuaDheaMiemSruaTjeS9nCAqL2hhbmRsZUZvcm1EZXRhaWw6IGZ1bmN0aW9uIGhhbmRsZUZvcm1EZXRhaWwocm93KSB7CiAgICAgIC8vIOa1geeoi+ihqOWNlQogICAgICBpZiAocm93LmZvcm1JZCkgewogICAgICAgIC8vIOiuvue9ruWAvAogICAgICAgIHRoaXMuZGV0YWlsRm9ybSA9ICgwLCBfb2JqZWN0U3ByZWFkMi5kZWZhdWx0KSgoMCwgX29iamVjdFNwcmVhZDIuZGVmYXVsdCkoe30sIEpTT04ucGFyc2Uocm93LmZvcm1Db25mKSksIHt9LCB7CiAgICAgICAgICBmaWVsZHM6ICgwLCBfZm9ybUdlbmVyYXRvci5kZWNvZGVGaWVsZHMpKHJvdy5mb3JtRmllbGRzKQogICAgICAgIH0pOwogICAgICAgIC8vIOW8ueeql+aJk+W8gAogICAgICAgIHRoaXMuZGV0YWlsT3BlbiA9IHRydWU7CiAgICAgICAgLy8g5Lia5Yqh6KGo5Y2VCiAgICAgIH0gZWxzZSBpZiAocm93LmZvcm1DdXN0b21DcmVhdGVQYXRoKSB7CiAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goewogICAgICAgICAgcGF0aDogcm93LmZvcm1DdXN0b21DcmVhdGVQYXRoCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgICAvKiog5rWB56iL5Zu+55qE6K+m5oOF5oyJ6ZKu5pON5L2cICovaGFuZGxlQnBtbkRldGFpbDogZnVuY3Rpb24gaGFuZGxlQnBtbkRldGFpbChyb3cpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CiAgICAgICgwLCBfZGVmaW5pdGlvbi5nZXRQcm9jZXNzRGVmaW5pdGlvbkJwbW5YTUwpKHJvdy5pZCkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICBfdGhpczIuYnBtblhNTCA9IHJlc3BvbnNlLmRhdGE7CiAgICAgICAgLy8g5by556qX5omT5byACiAgICAgICAgX3RoaXMyLnNob3dCcG1uT3BlbiA9IHRydWU7CiAgICAgIH0pOwogICAgfSwKICAgIC8qKiDlpITnkIbku7vliqHliIbphY3op4TliJnliJfooajnmoTmjInpkq7mk43kvZwgKi9oYW5kbGVBc3NpZ25SdWxlOiBmdW5jdGlvbiBoYW5kbGVBc3NpZ25SdWxlKHJvdykgewogICAgICB0aGlzLiRyZWZzWyd0YXNrQXNzaWduUnVsZURpYWxvZyddLmluaXRQcm9jZXNzRGVmaW5pdGlvbihyb3cuaWQpOwogICAgfQogIH0KfTs="},{"version":3,"names":["_definition","require","_dict","_formGenerator","_Parser","_interopRequireDefault","_taskAssignRuleDialog","_default","exports","default","name","components","Parser","taskAssignRuleDialog","data","loading","total","list","queryParams","pageNo","pageSize","detailOpen","detailForm","fields","showBpmnOpen","bpmnXML","bpmnControlForm","prefix","categoryDictDatas","getDictDatas","DICT_TYPE","BPM_MODEL_CATEGORY","created","key","$route","query","getList","methods","_this","getProcessDefinitionPage","then","response","handleFormDetail","row","formId","_objectSpread2","JSON","parse","formConf","decodeFields","formFields","formCustomCreatePath","$router","push","path","handleBpmnDetail","_this2","getProcessDefinitionBpmnXML","id","handleAssignRule","$refs","initProcessDefinition"],"sources":["src/views/bpm/definition/index.vue"],"sourcesContent":["<template>\r\n  <div class=\"app-container\">\r\n    <doc-alert title=\"工作流\" url=\"https://doc.iocoder.cn/bpm\" />\r\n\r\n    <!-- 列表 -->\r\n    <el-table v-loading=\"loading\" :data=\"list\">\r\n      <el-table-column label=\"定义编号\" align=\"center\" prop=\"id\" width=\"400\" />\r\n      <el-table-column label=\"定义名称\" align=\"center\" prop=\"name\" width=\"100\">\r\n        <template v-slot=\"scope\">\r\n          <el-button type=\"text\" @click=\"handleBpmnDetail(scope.row)\">\r\n            <span>{{ scope.row.name }}</span>\r\n          </el-button>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"定义分类\" align=\"center\" prop=\"category\" width=\"100\">\r\n        <template v-slot=\"scope\">\r\n          <dict-tag :type=\"DICT_TYPE.BPM_MODEL_CATEGORY\" :value=\"scope.row.category\" />\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"表单信息\" align=\"center\" prop=\"formType\" width=\"200\">\r\n        <template v-slot=\"scope\">\r\n          <el-button v-if=\"scope.row.formId\" type=\"text\" @click=\"handleFormDetail(scope.row)\">\r\n            <span>{{ scope.row.formName }}</span>\r\n          </el-button>\r\n          <el-button v-else-if=\"scope.row.formCustomCreatePath\" type=\"text\" @click=\"handleFormDetail(scope.row)\">\r\n            <span>{{ scope.row.formCustomCreatePath }}</span>\r\n          </el-button>\r\n          <label v-else>暂无表单</label>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"流程版本\" align=\"center\" prop=\"processDefinition.version\" width=\"80\">\r\n        <template v-slot=\"scope\">\r\n          <el-tag size=\"medium\" v-if=\"scope.row\">v{{ scope.row.version }}</el-tag>\r\n          <el-tag size=\"medium\" type=\"warning\" v-else>未部署</el-tag>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"状态\" align=\"center\" prop=\"version\" width=\"80\">\r\n        <template v-slot=\"scope\">\r\n            <el-tag type=\"success\" v-if=\"scope.row.suspensionState === 1\">激活</el-tag>\r\n            <el-tag type=\"warning\" v-if=\"scope.row.suspensionState === 2\">挂起</el-tag>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"部署时间\" align=\"center\" prop=\"deploymentTime\" width=\"180\">\r\n        <template v-slot=\"scope\">\r\n          <span>{{ parseTime(scope.row.deploymentTime) }}</span>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"定义描述\" align=\"center\" prop=\"description\" width=\"300\" show-overflow-tooltip />\r\n      <el-table-column label=\"操作\" align=\"center\" width=\"150\" fixed=\"right\">\r\n        <template v-slot=\"scope\">\r\n          <el-button size=\"mini\" type=\"text\" icon=\"el-icon-s-custom\" @click=\"handleAssignRule(scope.row)\"\r\n                     v-hasPermi=\"['bpm:task-assign-rule:update']\">分配规则</el-button>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n\r\n    <!-- 流程表单配置详情 -->\r\n    <el-dialog title=\"表单详情\" :visible.sync=\"detailOpen\" width=\"50%\" append-to-body>\r\n      <parser :key=\"new Date().getTime()\" :form-conf=\"detailForm\" />\r\n    </el-dialog>\r\n\r\n    <!-- 流程模型图的预览 -->\r\n    <el-dialog title=\"流程图\" :visible.sync=\"showBpmnOpen\" width=\"80%\" append-to-body>\r\n      <my-process-viewer key=\"designer\" v-model=\"bpmnXML\" v-bind=\"bpmnControlForm\" />\r\n    </el-dialog>\r\n\r\n    <!-- 分页组件 -->\r\n    <pagination v-show=\"total>0\" :total=\"total\" :page.sync=\"queryParams.pageNo\" :limit.sync=\"queryParams.pageSize\"\r\n                @pagination=\"getList\"/>\r\n\r\n    <!-- ========== 流程任务分配规则 ========== -->\r\n    <taskAssignRuleDialog ref=\"taskAssignRuleDialog\" />\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {getProcessDefinitionBpmnXML, getProcessDefinitionPage} from \"@/api/bpm/definition\";\r\nimport {DICT_TYPE, getDictDatas} from \"@/utils/dict\";\r\nimport {decodeFields} from \"@/utils/formGenerator\";\r\nimport Parser from '@/components/parser/Parser'\r\nimport taskAssignRuleDialog from \"../taskAssignRule/taskAssignRuleDialog\";\r\n\r\nexport default {\r\n  name: \"BpmProcessDefinition\",\r\n  components: {\r\n    Parser,\r\n    taskAssignRuleDialog\r\n  },\r\n  data() {\r\n    return {\r\n      // 遮罩层\r\n      loading: true,\r\n      // 总条数\r\n      total: 0,\r\n      // 表格数据\r\n      list: [],\r\n      // 查询参数\r\n      queryParams: {\r\n        pageNo: 1,\r\n        pageSize: 10\r\n      },\r\n\r\n      // 流程表单详情\r\n      detailOpen: false,\r\n      detailForm: {\r\n        fields: []\r\n      },\r\n\r\n      // BPMN 数据\r\n      showBpmnOpen: false,\r\n      bpmnXML: null,\r\n      bpmnControlForm: {\r\n        prefix: \"flowable\"\r\n      },\r\n\r\n      // 数据字典\r\n      categoryDictDatas: getDictDatas(DICT_TYPE.BPM_MODEL_CATEGORY),\r\n    };\r\n  },\r\n  created() {\r\n    const key = this.$route.query && this.$route.query.key\r\n    if (key) {\r\n      this.queryParams['key'] = key\r\n    }\r\n    this.getList();\r\n  },\r\n  methods: {\r\n    /** 查询流程定义列表 */\r\n    getList() {\r\n      this.loading = true;\r\n      getProcessDefinitionPage(this.queryParams).then(response => {\r\n          this.list = response.data.list;\r\n          this.total = response.data.total;\r\n          this.loading = false;\r\n        }\r\n      );\r\n    },\r\n    /** 流程表单的详情按钮操作 */\r\n    handleFormDetail(row) {\r\n      // 流程表单\r\n      if (row.formId) {\r\n        // 设置值\r\n        this.detailForm = {\r\n          ...JSON.parse(row.formConf),\r\n          fields: decodeFields(row.formFields)\r\n        }\r\n        // 弹窗打开\r\n        this.detailOpen = true\r\n        // 业务表单\r\n      } else if (row.formCustomCreatePath) {\r\n        this.$router.push({ path: row.formCustomCreatePath});\r\n      }\r\n    },\r\n    /** 流程图的详情按钮操作 */\r\n    handleBpmnDetail(row) {\r\n      getProcessDefinitionBpmnXML(row.id).then(response => {\r\n        this.bpmnXML = response.data\r\n        // 弹窗打开\r\n        this.showBpmnOpen = true\r\n      })\r\n    },\r\n    /** 处理任务分配规则列表的按钮操作 */\r\n    handleAssignRule(row) {\r\n      this.$refs['taskAssignRuleDialog'].initProcessDefinition(row.id);\r\n    },\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n.my-process-designer {\r\n  height: calc(100vh - 200px);\r\n}\r\n</style>\r\n"],"mappings":";;;;;;;;;;AA4EA,IAAAA,WAAA,GAAAC,OAAA;AACA,IAAAC,KAAA,GAAAD,OAAA;AACA,IAAAE,cAAA,GAAAF,OAAA;AACA,IAAAG,OAAA,GAAAC,sBAAA,CAAAJ,OAAA;AACA,IAAAK,qBAAA,GAAAD,sBAAA,CAAAJ,OAAA;AAAA,IAAAM,QAAA,GAAAC,OAAA,CAAAC,OAAA,GAEA;EACAC,IAAA;EACAC,UAAA;IACAC,MAAA,EAAAA,eAAA;IACAC,oBAAA,EAAAA;EACA;EACAC,IAAA,WAAAA,KAAA;IACA;MACA;MACAC,OAAA;MACA;MACAC,KAAA;MACA;MACAC,IAAA;MACA;MACAC,WAAA;QACAC,MAAA;QACAC,QAAA;MACA;MAEA;MACAC,UAAA;MACAC,UAAA;QACAC,MAAA;MACA;MAEA;MACAC,YAAA;MACAC,OAAA;MACAC,eAAA;QACAC,MAAA;MACA;MAEA;MACAC,iBAAA,MAAAC,kBAAA,EAAAC,eAAA,CAAAC,kBAAA;IACA;EACA;EACAC,OAAA,WAAAA,QAAA;IACA,IAAAC,GAAA,QAAAC,MAAA,CAAAC,KAAA,SAAAD,MAAA,CAAAC,KAAA,CAAAF,GAAA;IACA,IAAAA,GAAA;MACA,KAAAf,WAAA,UAAAe,GAAA;IACA;IACA,KAAAG,OAAA;EACA;EACAC,OAAA;IACA,eACAD,OAAA,WAAAA,QAAA;MAAA,IAAAE,KAAA;MACA,KAAAvB,OAAA;MACA,IAAAwB,oCAAA,OAAArB,WAAA,EAAAsB,IAAA,WAAAC,QAAA;QACAH,KAAA,CAAArB,IAAA,GAAAwB,QAAA,CAAA3B,IAAA,CAAAG,IAAA;QACAqB,KAAA,CAAAtB,KAAA,GAAAyB,QAAA,CAAA3B,IAAA,CAAAE,KAAA;QACAsB,KAAA,CAAAvB,OAAA;MACA,CACA;IACA;IACA,kBACA2B,gBAAA,WAAAA,iBAAAC,GAAA;MACA;MACA,IAAAA,GAAA,CAAAC,MAAA;QACA;QACA,KAAAtB,UAAA,OAAAuB,cAAA,CAAApC,OAAA,MAAAoC,cAAA,CAAApC,OAAA,MACAqC,IAAA,CAAAC,KAAA,CAAAJ,GAAA,CAAAK,QAAA;UACAzB,MAAA,MAAA0B,2BAAA,EAAAN,GAAA,CAAAO,UAAA;QAAA,EACA;QACA;QACA,KAAA7B,UAAA;QACA;MACA,WAAAsB,GAAA,CAAAQ,oBAAA;QACA,KAAAC,OAAA,CAAAC,IAAA;UAAAC,IAAA,EAAAX,GAAA,CAAAQ;QAAA;MACA;IACA;IACA,iBACAI,gBAAA,WAAAA,iBAAAZ,GAAA;MAAA,IAAAa,MAAA;MACA,IAAAC,uCAAA,EAAAd,GAAA,CAAAe,EAAA,EAAAlB,IAAA,WAAAC,QAAA;QACAe,MAAA,CAAA/B,OAAA,GAAAgB,QAAA,CAAA3B,IAAA;QACA;QACA0C,MAAA,CAAAhC,YAAA;MACA;IACA;IACA,sBACAmC,gBAAA,WAAAA,iBAAAhB,GAAA;MACA,KAAAiB,KAAA,yBAAAC,qBAAA,CAAAlB,GAAA,CAAAe,EAAA;IACA;EACA;AACA"}]}