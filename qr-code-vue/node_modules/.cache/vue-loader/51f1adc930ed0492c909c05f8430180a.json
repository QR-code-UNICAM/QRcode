{"remainingRequest":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\src\\components\\bpmnProcessDesigner\\package\\penal\\signal-message\\SignalAndMessage.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\src\\components\\bpmnProcessDesigner\\package\\penal\\signal-message\\SignalAndMessage.vue","mtime":1704630437726},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICJTaWduYWxBbmRNYXNzYWdlIiwNCiAgZGF0YSgpIHsNCiAgICByZXR1cm4gew0KICAgICAgc2lnbmFsTGlzdDogW10sDQogICAgICBtZXNzYWdlTGlzdDogW10sDQogICAgICBtb2RlbFZpc2libGU6IGZhbHNlLA0KICAgICAgbW9kZWxUeXBlOiAiIiwNCiAgICAgIG1vZGVsT2JqZWN0Rm9ybToge30NCiAgICB9Ow0KICB9LA0KICBjb21wdXRlZDogew0KICAgIG1vZGVsQ29uZmlnKCkgew0KICAgICAgaWYgKHRoaXMubW9kZWxUeXBlID09PSAibWVzc2FnZSIpIHsNCiAgICAgICAgcmV0dXJuIHsgdGl0bGU6ICLliJvlu7rmtojmga8iLCBpZExhYmVsOiAi5raI5oGvSUQiLCBuYW1lTGFiZWw6ICLmtojmga/lkI3np7AiIH07DQogICAgICB9IGVsc2Ugew0KICAgICAgICByZXR1cm4geyB0aXRsZTogIuWIm+W7uuS/oeWPtyIsIGlkTGFiZWw6ICLkv6Hlj7dJRCIsIG5hbWVMYWJlbDogIuS/oeWPt+WQjeensCIgfTsNCiAgICAgIH0NCiAgICB9DQogIH0sDQogIG1vdW50ZWQoKSB7DQogICAgdGhpcy5pbml0RGF0YUxpc3QoKTsNCiAgfSwNCiAgbWV0aG9kczogew0KICAgIGluaXREYXRhTGlzdCgpIHsNCiAgICAgIHRoaXMucm9vdEVsZW1lbnRzID0gd2luZG93LmJwbW5JbnN0YW5jZXMubW9kZWxlci5nZXREZWZpbml0aW9ucygpLnJvb3RFbGVtZW50czsNCiAgICAgIHRoaXMubWVzc2FnZUlkTWFwID0ge307DQogICAgICB0aGlzLnNpZ25hbElkTWFwID0ge307DQogICAgICB0aGlzLm1lc3NhZ2VMaXN0ID0gW107DQogICAgICB0aGlzLnNpZ25hbExpc3QgPSBbXTsNCiAgICAgIHRoaXMucm9vdEVsZW1lbnRzLmZvckVhY2goZWwgPT4gew0KICAgICAgICBpZiAoZWwuJHR5cGUgPT09ICJicG1uOk1lc3NhZ2UiKSB7DQogICAgICAgICAgdGhpcy5tZXNzYWdlSWRNYXBbZWwuaWRdID0gdHJ1ZTsNCiAgICAgICAgICB0aGlzLm1lc3NhZ2VMaXN0LnB1c2goeyAuLi5lbCB9KTsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoZWwuJHR5cGUgPT09ICJicG1uOlNpZ25hbCIpIHsNCiAgICAgICAgICB0aGlzLnNpZ25hbElkTWFwW2VsLmlkXSA9IHRydWU7DQogICAgICAgICAgdGhpcy5zaWduYWxMaXN0LnB1c2goeyAuLi5lbCB9KTsNCiAgICAgICAgfQ0KICAgICAgfSk7DQogICAgfSwNCiAgICBvcGVuTW9kZWwodHlwZSkgew0KICAgICAgdGhpcy5tb2RlbFR5cGUgPSB0eXBlOw0KICAgICAgdGhpcy5tb2RlbE9iamVjdEZvcm0gPSB7fTsNCiAgICAgIHRoaXMubW9kZWxWaXNpYmxlID0gdHJ1ZTsNCiAgICB9LA0KICAgIGFkZE5ld09iamVjdCgpIHsNCiAgICAgIGlmICh0aGlzLm1vZGVsVHlwZSA9PT0gIm1lc3NhZ2UiKSB7DQogICAgICAgIGlmICh0aGlzLm1lc3NhZ2VJZE1hcFt0aGlzLm1vZGVsT2JqZWN0Rm9ybS5pZF0pIHsNCiAgICAgICAgICByZXR1cm4gdGhpcy4kbWVzc2FnZS5lcnJvcigi6K+l5raI5oGv5bey5a2Y5Zyo77yM6K+35L+u5pS5aWTlkI7ph43mlrDkv53lrZgiKTsNCiAgICAgICAgfQ0KICAgICAgICBjb25zdCBtZXNzYWdlUmVmID0gd2luZG93LmJwbW5JbnN0YW5jZXMubW9kZGxlLmNyZWF0ZSgiYnBtbjpNZXNzYWdlIiwgdGhpcy5tb2RlbE9iamVjdEZvcm0pOw0KICAgICAgICB0aGlzLnJvb3RFbGVtZW50cy5wdXNoKG1lc3NhZ2VSZWYpOw0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgaWYgKHRoaXMuc2lnbmFsSWRNYXBbdGhpcy5tb2RlbE9iamVjdEZvcm0uaWRdKSB7DQogICAgICAgICAgcmV0dXJuIHRoaXMuJG1lc3NhZ2UuZXJyb3IoIuivpeS/oeWPt+W3suWtmOWcqO+8jOivt+S/ruaUuWlk5ZCO6YeN5paw5L+d5a2YIik7DQogICAgICAgIH0NCiAgICAgICAgY29uc3Qgc2lnbmFsUmVmID0gd2luZG93LmJwbW5JbnN0YW5jZXMubW9kZGxlLmNyZWF0ZSgiYnBtbjpTaWduYWwiLCB0aGlzLm1vZGVsT2JqZWN0Rm9ybSk7DQogICAgICAgIHRoaXMucm9vdEVsZW1lbnRzLnB1c2goc2lnbmFsUmVmKTsNCiAgICAgIH0NCiAgICAgIHRoaXMubW9kZWxWaXNpYmxlID0gZmFsc2U7DQogICAgICB0aGlzLmluaXREYXRhTGlzdCgpOw0KICAgIH0NCiAgfQ0KfTsNCg=="},{"version":3,"sources":["SignalAndMessage.vue"],"names":[],"mappings":";AAsCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"SignalAndMessage.vue","sourceRoot":"src/components/bpmnProcessDesigner/package/penal/signal-message","sourcesContent":["<template>\r\n  <div class=\"panel-tab__content\">\r\n    <div class=\"panel-tab__content--title\">\r\n      <span><i class=\"el-icon-menu\" style=\"margin-right: 8px; color: #555555\"></i>消息列表</span>\r\n      <el-button size=\"mini\" type=\"primary\" icon=\"el-icon-plus\" @click=\"openModel('message')\">创建新消息</el-button>\r\n    </div>\r\n    <el-table :data=\"messageList\" size=\"mini\" border>\r\n      <el-table-column type=\"index\" label=\"序号\" width=\"60px\" />\r\n      <el-table-column label=\"消息ID\" prop=\"id\" max-width=\"300px\" show-overflow-tooltip />\r\n      <el-table-column label=\"消息名称\" prop=\"name\" max-width=\"300px\" show-overflow-tooltip />\r\n    </el-table>\r\n    <div class=\"panel-tab__content--title\" style=\"padding-top: 8px; margin-top: 8px; border-top: 1px solid #eeeeee\">\r\n      <span><i class=\"el-icon-menu\" style=\"margin-right: 8px; color: #555555\"></i>信号列表</span>\r\n      <el-button size=\"mini\" type=\"primary\" icon=\"el-icon-plus\" @click=\"openModel('signal')\">创建新信号</el-button>\r\n    </div>\r\n    <el-table :data=\"signalList\" size=\"mini\" border>\r\n      <el-table-column type=\"index\" label=\"序号\" width=\"60px\" />\r\n      <el-table-column label=\"信号ID\" prop=\"id\" max-width=\"300px\" show-overflow-tooltip />\r\n      <el-table-column label=\"信号名称\" prop=\"name\" max-width=\"300px\" show-overflow-tooltip />\r\n    </el-table>\r\n\r\n    <el-dialog :visible.sync=\"modelVisible\" :title=\"modelConfig.title\" :close-on-click-modal=\"false\" width=\"400px\" append-to-body destroy-on-close>\r\n      <el-form :model=\"modelObjectForm\" size=\"mini\" label-width=\"90px\" @submit.native.prevent>\r\n        <el-form-item :label=\"modelConfig.idLabel\">\r\n          <el-input v-model=\"modelObjectForm.id\" clearable />\r\n        </el-form-item>\r\n        <el-form-item :label=\"modelConfig.nameLabel\">\r\n          <el-input v-model=\"modelObjectForm.name\" clearable />\r\n        </el-form-item>\r\n      </el-form>\r\n      <template slot=\"footer\">\r\n        <el-button size=\"mini\" @click=\"modelVisible = false\">取 消</el-button>\r\n        <el-button size=\"mini\" type=\"primary\" @click=\"addNewObject\">保 存</el-button>\r\n      </template>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n<script>\r\nexport default {\r\n  name: \"SignalAndMassage\",\r\n  data() {\r\n    return {\r\n      signalList: [],\r\n      messageList: [],\r\n      modelVisible: false,\r\n      modelType: \"\",\r\n      modelObjectForm: {}\r\n    };\r\n  },\r\n  computed: {\r\n    modelConfig() {\r\n      if (this.modelType === \"message\") {\r\n        return { title: \"创建消息\", idLabel: \"消息ID\", nameLabel: \"消息名称\" };\r\n      } else {\r\n        return { title: \"创建信号\", idLabel: \"信号ID\", nameLabel: \"信号名称\" };\r\n      }\r\n    }\r\n  },\r\n  mounted() {\r\n    this.initDataList();\r\n  },\r\n  methods: {\r\n    initDataList() {\r\n      this.rootElements = window.bpmnInstances.modeler.getDefinitions().rootElements;\r\n      this.messageIdMap = {};\r\n      this.signalIdMap = {};\r\n      this.messageList = [];\r\n      this.signalList = [];\r\n      this.rootElements.forEach(el => {\r\n        if (el.$type === \"bpmn:Message\") {\r\n          this.messageIdMap[el.id] = true;\r\n          this.messageList.push({ ...el });\r\n        }\r\n        if (el.$type === \"bpmn:Signal\") {\r\n          this.signalIdMap[el.id] = true;\r\n          this.signalList.push({ ...el });\r\n        }\r\n      });\r\n    },\r\n    openModel(type) {\r\n      this.modelType = type;\r\n      this.modelObjectForm = {};\r\n      this.modelVisible = true;\r\n    },\r\n    addNewObject() {\r\n      if (this.modelType === \"message\") {\r\n        if (this.messageIdMap[this.modelObjectForm.id]) {\r\n          return this.$message.error(\"该消息已存在，请修改id后重新保存\");\r\n        }\r\n        const messageRef = window.bpmnInstances.moddle.create(\"bpmn:Message\", this.modelObjectForm);\r\n        this.rootElements.push(messageRef);\r\n      } else {\r\n        if (this.signalIdMap[this.modelObjectForm.id]) {\r\n          return this.$message.error(\"该信号已存在，请修改id后重新保存\");\r\n        }\r\n        const signalRef = window.bpmnInstances.moddle.create(\"bpmn:Signal\", this.modelObjectForm);\r\n        this.rootElements.push(signalRef);\r\n      }\r\n      this.modelVisible = false;\r\n      this.initDataList();\r\n    }\r\n  }\r\n};\r\n</script>\r\n"]}]}