{"remainingRequest":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\src\\views\\mall\\product\\spu\\index.vue?vue&type=style&index=0&id=088e380c&lang=scss","dependencies":[{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\src\\views\\mall\\product\\spu\\index.vue","mtime":1704630437937},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQouYXBwLWNvbnRhaW5lciB7DQogIC5lbC10YWcgKyAuZWwtdGFnIHsNCiAgICBtYXJnaW4tbGVmdDogMTBweDsNCiAgfQ0KDQogIC5wcm9kdWN0LWluZm8gew0KICAgIGRpc3BsYXk6IGZsZXg7DQoNCiAgICAuaW1nLWhlaWdodCB7DQogICAgICBoZWlnaHQ6IDUwcHg7DQogICAgICB3aWR0aDogNTBweDsNCiAgICB9DQoNCiAgICAubWVzc2FnZSB7DQogICAgICBtYXJnaW4tbGVmdDogMTBweDsNCiAgICAgIHRleHQtb3ZlcmZsb3c6IGVsbGlwc2lzOw0KICAgICAgZGlzcGxheTogLXdlYmtpdC1ib3g7DQogICAgICAtd2Via2l0LWxpbmUtY2xhbXA6IDI7DQogICAgICB3b3JkLWJyZWFrOiBicmVhay1hbGw7DQogICAgICAtd2Via2l0LWJveC1vcmllbnQ6IHZlcnRpY2FsOw0KICAgICAgd2hpdGUtc3BhY2U6IG5vcm1hbDsNCiAgICAgIG92ZXJmbG93OiBoaWRkZW47DQogICAgICBoZWlnaHQ6IDUwcHg7DQogICAgICBsaW5lLWhlaWdodDogMjVweDsNCiAgICB9DQogIH0NCg0KfQ0K"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";AA2WA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA","file":"index.vue","sourceRoot":"src/views/mall/product/spu","sourcesContent":["<template>\r\n  <div class=\"app-container\">\r\n    <doc-alert title=\"功能开启\" url=\"https://doc.iocoder.cn/mall/build/\" />\r\n\r\n    <el-form :model=\"queryParams\" ref=\"queryForm\" size=\"small\" :inline=\"true\" v-show=\"showSearch\" label-width=\"68px\">\r\n      <el-form-item label=\"商品名称\" prop=\"name\">\r\n        <el-input v-model=\"queryParams.name\" placeholder=\"请输入商品名称\" clearable @keyup.enter.native=\"handleQuery\"/>\r\n      </el-form-item>\r\n      <el-form-item label=\"商品编码\" prop=\"code\">\r\n        <el-input v-model=\"queryParams.code\" placeholder=\"请输入商品编码\" clearable @keyup.enter.native=\"handleQuery\"/>\r\n      </el-form-item>\r\n      <el-form-item label=\"商品分类\" prop=\"categoryIds\">\r\n        <el-cascader v-model=\"queryParams.categoryIds\" placeholder=\"请输入商品分类\"\r\n                     :options=\"categoryList\" :props=\"propName\" clearable ref=\"category\"/>\r\n      </el-form-item>\r\n      <el-form-item label=\"商品品牌\" prop=\"brandId\">\r\n        <el-select v-model=\"queryParams.brandId\" placeholder=\"请输入商品品牌\" clearable @keyup.enter.native=\"handleQuery\">\r\n          <el-option v-for=\"item in brandList\" :key=\"item.id\" :label=\"item.name\" :value=\"item.id\"/>\r\n        </el-select>\r\n      </el-form-item>\r\n      <!-- TODO 待实现：商品类型 -->\r\n      <!-- TODO 待实现：商品标签 -->\r\n      <!-- TODO 待实现：营销活动 -->\r\n      <!-- TODO 前端优化：商品销量、商品价格，排的整齐一点 -->\r\n      <el-form-item label=\"商品销量\">\r\n        <el-col :span=\"7\" style=\"padding-left:0\">\r\n          <el-form-item prop=\"salesCountMin\">\r\n            <el-input v-model=\"queryParams.salesCountMin\" placeholder=\"最低销量\" clearable @keyup.enter.native=\"handleQuery\"/>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"1\">-</el-col>\r\n        <el-col :span=\"7\" style=\"padding-left:0\">\r\n          <el-form-item prop=\"salesCountMax\">\r\n            <el-input v-model=\"queryParams.salesCountMax\" placeholder=\"最高销量\" clearable @keyup.enter.native=\"handleQuery\"/>\r\n          </el-form-item>\r\n        </el-col>\r\n      </el-form-item>\r\n      <el-form-item label=\"商品价格\" prop=\"code\">\r\n        <el-col :span=\"7\" style=\"padding-left:0\">\r\n          <el-form-item prop=\"marketPriceMin\">\r\n            <el-input v-model=\"queryParams.marketPriceMin\" placeholder=\"最低价格\" clearable @keyup.enter.native=\"handleQuery\"/>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"1\">-</el-col>\r\n        <el-col :span=\"7\" style=\"padding-left:0\">\r\n          <el-form-item prop=\"marketPriceMax\">\r\n            <el-input v-model=\"queryParams.marketPriceMax\" placeholder=\"最高价格\" clearable @keyup.enter.native=\"handleQuery\"/>\r\n          </el-form-item>\r\n        </el-col>\r\n      </el-form-item>\r\n      <el-form-item>\r\n        <el-button type=\"primary\" icon=\"el-icon-search\" @click=\"handleQuery\">搜索</el-button>\r\n        <el-button icon=\"el-icon-refresh\" @click=\"resetQuery\">重置</el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n\r\n    <!-- 操作工具栏 -->\r\n    <el-row :gutter=\"10\" class=\"mb8\">\r\n      <el-col :span=\"1.5\">\r\n        <el-button type=\"primary\" plain icon=\"el-icon-plus\" size=\"mini\" @click=\"handleAdd\"\r\n                   v-hasPermi=\"['product:spu:create']\">添加商品</el-button>\r\n      </el-col>\r\n      <right-toolbar :showSearch.sync=\"showSearch\" @queryTable=\"getList\"/>\r\n    </el-row>\r\n\r\n    <el-tabs v-model=\"activeTabs\" type=\"card\" @tab-click=\"handleClick\">\r\n      <!-- 全部 -->\r\n      <el-tab-pane label=\"全部\" name=\"all\">\r\n        <!-- 列表 -->\r\n        <el-table v-loading=\"loading\" :data=\"list\">\r\n          <el-table-column label=\"商品信息\" align=\"center\" width=\"260\">\r\n            <template v-slot=\"scope\">\r\n              <div class=\"product-info\">\r\n                <img v-if=\"scope.row.picUrls\" :src=\"scope.row.picUrls[0]\" alt=\"分类图片\" class=\"img-height\" />\r\n                <div class=\"message\">{{ scope.row.name }}</div>\r\n              </div>\r\n            </template>\r\n            <!-- TODO 前端优化：可以有个 + 号，点击后，展示每个 sku -->\r\n          </el-table-column>\r\n          <el-table-column label=\"价格\" align=\"center\" prop=\"marketPrice\" :formatter=\"formatPrice\"/>\r\n          <el-table-column label=\"库存\" align=\"center\" prop=\"totalStock\"/>\r\n          <el-table-column label=\"销量\" align=\"center\" prop=\"salesCount\"/>\r\n          <el-table-column label=\"排序\" align=\"center\" prop=\"sort\"/>\r\n          <el-table-column label=\"创建时间\" align=\"center\" prop=\"createTime\" width=\"180\">\r\n            <template v-slot=\"scope\">\r\n              <span>{{ parseTime(scope.row.createTime) }}</span>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column label=\"状态\" align=\"center\" prop=\"status\">\r\n            <template v-slot=\"scope\">\r\n              <dict-tag :type=\"DICT_TYPE.PRODUCT_SPU_STATUS\" :value=\"scope.row.status\"/>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column label=\"操作\" align=\"center\" class-name=\"small-padding fixed-width\">\r\n            <template v-slot=\"scope\">\r\n              <el-button size=\"mini\" type=\"text\" icon=\"el-icon-edit\" @click=\"handleUpdate(scope.row)\"\r\n                         v-hasPermi=\"['product:spu:update']\">修改</el-button>\r\n              <el-button size=\"mini\" type=\"text\" icon=\"el-icon-delete\" @click=\"handleDelete(scope.row)\"\r\n                         v-hasPermi=\"['product:spu:delete']\">删除</el-button>\r\n            </template>\r\n          </el-table-column>\r\n        </el-table>\r\n      </el-tab-pane>\r\n\r\n      <!-- 销售中 -->\r\n      <el-tab-pane label=\"销售中\" name=\"on\">\r\n        <!-- 列表 -->\r\n        <el-table v-loading=\"loading\" :data=\"list\">\r\n          <el-table-column label=\"商品信息\" align=\"center\" width=\"260\">\r\n            <template v-slot=\"scope\">\r\n              <div class=\"product-info\">\r\n                <img v-if=\"scope.row.picUrls\" :src=\"scope.row.picUrls[0]\" alt=\"分类图片\" class=\"img-height\"/>\r\n                <div class=\"message\">{{ scope.row.name }}</div>\r\n              </div>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column label=\"价格\" align=\"center\" prop=\"marketPrice\" :formatter=\"formatPrice\"/>\r\n          <el-table-column label=\"库存\" align=\"center\" prop=\"totalStock\"/>\r\n          <el-table-column label=\"销量\" align=\"center\" prop=\"salesCount\"/>\r\n          <el-table-column label=\"排序\" align=\"center\" prop=\"sort\"/>\r\n          <el-table-column label=\"创建时间\" align=\"center\" prop=\"createTime\" width=\"180\">\r\n            <template v-slot=\"scope\">\r\n              <span>{{ parseTime(scope.row.createTime) }}</span>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column label=\"状态\" align=\"center\" prop=\"status\">\r\n            <template v-slot=\"scope\">\r\n              <dict-tag :type=\"DICT_TYPE.PRODUCT_SPU_STATUS\" :value=\"scope.row.status\"/>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column label=\"操作\" align=\"center\" class-name=\"small-padding fixed-width\">\r\n            <template v-slot=\"scope\">\r\n              <el-button size=\"mini\" type=\"text\" icon=\"el-icon-edit\" @click=\"handleUpdate(scope.row)\"\r\n                         v-hasPermi=\"['product:spu:update']\">修改</el-button>\r\n              <el-button size=\"mini\" type=\"text\" icon=\"el-icon-delete\" @click=\"handleDelete(scope.row)\"\r\n                         v-hasPermi=\"['product:spu:delete']\">删除</el-button>\r\n            </template>\r\n          </el-table-column>\r\n        </el-table>\r\n      </el-tab-pane>\r\n\r\n      <!-- 仓库中 -->\r\n      <el-tab-pane label=\"仓库中\" name=\"off\">\r\n        <!-- 列表 -->\r\n        <el-table v-loading=\"loading\" :data=\"list\">\r\n          <el-table-column label=\"商品信息\" align=\"center\" width=\"260\">\r\n            <template v-slot=\"scope\">\r\n              <div class=\"product-info\">\r\n                <img v-if=\"scope.row.picUrls\" :src=\"scope.row.picUrls[0]\" alt=\"分类图片\" class=\"img-height\"/>\r\n                <div class=\"message\">{{ scope.row.name }}</div>\r\n              </div>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column label=\"价格\" align=\"center\" prop=\"marketPrice\" :formatter=\"formatPrice\"/>\r\n          <el-table-column label=\"库存\" align=\"center\" prop=\"totalStock\"/>\r\n          <el-table-column label=\"销量\" align=\"center\" prop=\"salesCount\"/>\r\n          <el-table-column label=\"排序\" align=\"center\" prop=\"sort\"/>\r\n          <el-table-column label=\"创建时间\" align=\"center\" prop=\"createTime\" width=\"180\">\r\n            <template v-slot=\"scope\">\r\n              <span>{{ parseTime(scope.row.createTime) }}</span>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column label=\"状态\" align=\"center\" prop=\"status\">\r\n            <template v-slot=\"scope\">\r\n              <dict-tag :type=\"DICT_TYPE.PRODUCT_SPU_STATUS\" :value=\"scope.row.status\"/>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column label=\"操作\" align=\"center\" class-name=\"small-padding fixed-width\">\r\n            <template v-slot=\"scope\">\r\n              <el-button size=\"mini\" type=\"text\" icon=\"el-icon-edit\" @click=\"handleUpdate(scope.row)\"\r\n                         v-hasPermi=\"['product:spu:update']\">修改</el-button>\r\n              <el-button size=\"mini\" type=\"text\" icon=\"el-icon-delete\" @click=\"handleDelete(scope.row)\"\r\n                         v-hasPermi=\"['product:spu:delete']\">删除</el-button>\r\n            </template>\r\n          </el-table-column>\r\n        </el-table>\r\n      </el-tab-pane>\r\n\r\n      <!-- 预警中 -->\r\n      <el-tab-pane label=\"预警中\" name=\"remind\">\r\n        <!-- 列表 -->\r\n        <el-table v-loading=\"loading\" :data=\"list\">\r\n          <el-table-column label=\"商品信息\" align=\"center\" width=\"260\">\r\n            <template v-slot=\"scope\">\r\n              <div class=\"product-info\">\r\n                <img v-if=\"scope.row.picUrls\" :src=\"scope.row.picUrls[0]\" alt=\"分类图片\" class=\"img-height\"/>\r\n                <div class=\"message\">{{ scope.row.name }}</div>\r\n              </div>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column label=\"价格\" align=\"center\" prop=\"marketPrice\" :formatter=\"formatPrice\"/>\r\n          <el-table-column label=\"库存\" align=\"center\" prop=\"totalStock\"/>\r\n          <el-table-column label=\"销量\" align=\"center\" prop=\"salesCount\"/>\r\n          <el-table-column label=\"排序\" align=\"center\" prop=\"sort\"/>\r\n          <el-table-column label=\"创建时间\" align=\"center\" prop=\"createTime\" width=\"180\">\r\n            <template v-slot=\"scope\">\r\n              <span>{{ parseTime(scope.row.createTime) }}</span>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column label=\"状态\" align=\"center\" prop=\"status\">\r\n            <template v-slot=\"scope\">\r\n              <dict-tag :type=\"DICT_TYPE.PRODUCT_SPU_STATUS\" :value=\"scope.row.status\"/>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column label=\"操作\" align=\"center\" class-name=\"small-padding fixed-width\">\r\n            <template v-slot=\"scope\">\r\n              <el-button size=\"mini\" type=\"text\" icon=\"el-icon-edit\" @click=\"handleUpdate(scope.row)\"\r\n                         v-hasPermi=\"['product:spu:update']\">修改</el-button>\r\n              <el-button size=\"mini\" type=\"text\" icon=\"el-icon-delete\" @click=\"handleDelete(scope.row)\"\r\n                         v-hasPermi=\"['product:spu:delete']\">删除</el-button>\r\n            </template>\r\n          </el-table-column>\r\n        </el-table>\r\n      </el-tab-pane>\r\n    </el-tabs>\r\n\r\n    <!-- 分页组件 -->\r\n    <pagination v-show=\"total > 0\" :total=\"total\" :page.sync=\"queryParams.pageNo\" :limit.sync=\"queryParams.pageSize\"\r\n                @pagination=\"getList\"/>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {deleteSpu, getSpuPage,} from \"@/api/mall/product/spu\";\r\nimport {getProductCategoryList} from \"@/api/mall/product/category\";\r\nimport {getBrandList} from \"@/api/mall/product/brand\";\r\nimport {ProductSpuStatusEnum} from \"@/utils/constants\";\r\n\r\nexport default {\r\n  name: \"ProductSpu\",\r\n  data() {\r\n    return {\r\n      activeTabs: \"all\",\r\n      propName: {\r\n        checkStrictly: true,\r\n        label: \"name\",\r\n        value: \"id\",\r\n      },\r\n      brandList: [],\r\n      categoryList: [],\r\n      // 遮罩层\r\n      loading: true,\r\n      // 导出遮罩层\r\n      exportLoading: false,\r\n      // 显示搜索条件\r\n      showSearch: true,\r\n      // 总条数\r\n      total: 0,\r\n      // 商品spu列表\r\n      list: [],\r\n      dateRangeCreateTime: [],\r\n      // 查询参数\r\n      queryParams: {\r\n        pageNo: 1,\r\n        pageSize: 10,\r\n        name: null,\r\n        code: null,\r\n        categoryIds: [],\r\n        categoryId: null,\r\n        brandId: null,\r\n        status: null,\r\n        salesCountMin: null,\r\n        salesCountMax: null,\r\n        marketPriceMin: null,\r\n        marketPriceMax: null,\r\n      },\r\n    };\r\n  },\r\n  created() {\r\n    this.getList();\r\n    this.getListCategory()\r\n    this.getListBrand()\r\n  },\r\n  methods: {\r\n    /** 查询分类列表 */\r\n    getListCategory() {\r\n      // 执行查询\r\n      getProductCategoryList().then((response) => {\r\n        this.categoryList = this.handleTree(response.data, \"id\", \"parentId\");\r\n      });\r\n    },\r\n    /** 查询品牌列表 */\r\n    getListBrand() {\r\n      // 执行查询\r\n      getBrandList().then((response) => {\r\n        this.brandList = response.data;\r\n      });\r\n    },\r\n    /** 查询列表 */\r\n    getList() {\r\n      this.loading = true;\r\n      // 处理查询参数\r\n      let params = {...this.queryParams};\r\n      params.marketPriceMin = this.queryParams.marketPriceMin === null ? null : params.marketPriceMin * 100;\r\n      params.marketPriceMax = this.queryParams.marketPriceMax === null ? null : params.marketPriceMax * 100;\r\n      params.categoryId = this.queryParams.categoryIds[this.queryParams.categoryIds.length - 1];\r\n      this.addBeginAndEndTime(params, this.dateRangeCreateTime, \"createTime\");\r\n      // 执行查询\r\n      getSpuPage(params).then((response) => {\r\n        this.list = response.data.list;\r\n        this.total = response.data.total;\r\n        this.loading = false;\r\n      });\r\n    },\r\n    /** 搜索按钮操作 */\r\n    handleQuery() {\r\n      this.queryParams.pageNo = 1;\r\n      this.getList();\r\n    },\r\n    /** 重置按钮操作 */\r\n    resetQuery() {\r\n      this.dateRangeCreateTime = [];\r\n      this.$refs.category.$refs.panel.checkedValue = [];//也可以是指定的值，默认返回值是数组，也可以返回单个值\r\n      this.$refs.category.$refs.panel.activePath = [];\r\n      this.$refs.category.$refs.panel.syncActivePath();\r\n      this.resetForm(\"queryForm\");\r\n      this.handleQuery();\r\n    },\r\n    /** 新增按钮操作 */\r\n    handleAdd() {\r\n      this.$router.push({ name: 'ProductSpuCreate'})\r\n    },\r\n    /** 修改按钮操作 */\r\n    handleUpdate(row) {\r\n      this.$router.push({ name: 'ProductSpuUpdate', params: { spuId: row.id }})\r\n    },\r\n    /** 删除按钮操作 */\r\n    handleDelete(row) {\r\n      const id = row.id;\r\n      this.$modal\r\n        .confirm('是否确认删除商品spu编号为\"' + id + '\"的数据项?')\r\n        .then(function () {\r\n          return deleteSpu(id);\r\n        }).then(() => {\r\n          this.getList();\r\n          this.$modal.msgSuccess(\"删除成功\");\r\n        }).catch(() => {\r\n        });\r\n    },\r\n    formatPrice(row, column, cellValue) {\r\n      return '￥' + this.divide(cellValue, 100);\r\n    },\r\n    // 选中 tab\r\n    handleClick(val) {\r\n      if (val.name === \"all\") {\r\n        this.queryParams.status = undefined;\r\n        this.queryParams.alarmStock = undefined;\r\n      } else if (val.name === \"on\") {\r\n        this.queryParams.status = ProductSpuStatusEnum.ENABLE.status;\r\n        this.queryParams.alarmStock = undefined;\r\n      } else if (val.name === \"off\") {\r\n        this.queryParams.status = ProductSpuStatusEnum.DISABLE.status;\r\n        this.queryParams.alarmStock = undefined;\r\n      } else if (val.name === \"remind\") {\r\n        this.queryParams.status = undefined;\r\n        this.queryParams.alarmStock = true;\r\n      }\r\n      this.getList();\r\n    }\r\n  },\r\n};\r\n</script>\r\n<style lang=\"scss\">\r\n.app-container {\r\n  .el-tag + .el-tag {\r\n    margin-left: 10px;\r\n  }\r\n\r\n  .product-info {\r\n    display: flex;\r\n\r\n    .img-height {\r\n      height: 50px;\r\n      width: 50px;\r\n    }\r\n\r\n    .message {\r\n      margin-left: 10px;\r\n      text-overflow: ellipsis;\r\n      display: -webkit-box;\r\n      -webkit-line-clamp: 2;\r\n      word-break: break-all;\r\n      -webkit-box-orient: vertical;\r\n      white-space: normal;\r\n      overflow: hidden;\r\n      height: 50px;\r\n      line-height: 25px;\r\n    }\r\n  }\r\n\r\n}\r\n</style>\r\n"]}]}