{"remainingRequest":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\src\\views\\pay\\app\\components\\alipayChannelForm.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\src\\views\\pay\\app\\components\\alipayChannelForm.vue","mtime":1704630438039},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQgeyBjcmVhdGVDaGFubmVsLCBnZXRDaGFubmVsLCB1cGRhdGVDaGFubmVsIH0gZnJvbSAiQC9hcGkvcGF5L2NoYW5uZWwiOw0KaW1wb3J0IHsgQ29tbW9uU3RhdHVzRW51bSB9IGZyb20gIkAvdXRpbHMvY29uc3RhbnRzIjsNCg0KZXhwb3J0IGRlZmF1bHQgew0KICBuYW1lOiAiYWxpcGF5Q2hhbm5lbEZvcm0iLA0KICBkYXRhKCkgew0KICAgIHJldHVybiB7DQogICAgICBkaWFsb2dWaXNpYmxlOiBmYWxzZSwNCiAgICAgIGZvcm1Mb2FkaW5nOiBmYWxzZSwNCiAgICAgIHRpdGxlOicnLA0KICAgICAgZm9ybURhdGE6IHsNCiAgICAgICAgYXBwSWQ6ICcnLA0KICAgICAgICBjb2RlOiAnJywNCiAgICAgICAgc3RhdHVzOiB1bmRlZmluZWQsDQogICAgICAgIGZlZVJhdGU6IHVuZGVmaW5lZCwNCiAgICAgICAgcmVtYXJrOiAnJywNCiAgICAgICAgY29uZmlnOiB7DQogICAgICAgICAgYXBwSWQ6ICcnLA0KICAgICAgICAgIHNlcnZlclVybDogbnVsbCwNCiAgICAgICAgICBzaWduVHlwZTogJycsDQogICAgICAgICAgbW9kZTogbnVsbCwNCiAgICAgICAgICBwcml2YXRlS2V5OiAnJywNCiAgICAgICAgICBhbGlwYXlQdWJsaWNLZXk6ICcnLA0KICAgICAgICAgIGFwcENlcnRDb250ZW50OiAnJywNCiAgICAgICAgICBhbGlwYXlQdWJsaWNDZXJ0Q29udGVudDogJycsDQogICAgICAgICAgcm9vdENlcnRDb250ZW50OiAnJw0KICAgICAgICB9DQogICAgICB9LA0KICAgICAgcnVsZXM6IHsNCiAgICAgICAgZmVlUmF0ZTogW3sgcmVxdWlyZWQ6IHRydWUsICBtZXNzYWdlOiAn6K+36L6T5YWl5rig6YGT6LS5546HJywgdHJpZ2dlcjogJ2JsdXInIH1dLA0KICAgICAgICBzdGF0dXM6IFt7IHJlcXVpcmVkOiB0cnVlLCAgbWVzc2FnZTogJ+a4oOmBk+eKtuaAgeS4jeiDveS4uuepuicsICB0cmlnZ2VyOiAnYmx1cicgfV0sDQogICAgICAgICdjb25maWcuYXBwSWQnOiBbeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogJ+ivt+i+k+WFpeW8gOaUvuW5s+WPsOS4iuWIm+W7uueahOW6lOeUqOeahCBJRCcsIHRyaWdnZXI6ICdibHVyJyB9XSwNCiAgICAgICAgJ2NvbmZpZy5zZXJ2ZXJVcmwnOiBbeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogJ+ivt+S8oOWFpee9keWFs+WcsOWdgCcsIHRyaWdnZXI6ICdibHVyJyB9XSwNCiAgICAgICAgJ2NvbmZpZy5zaWduVHlwZSc6IFt7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAn6K+35Lyg5YWl562+5ZCN566X5rOV57G75Z6LJywgdHJpZ2dlcjogJ2JsdXInIH1dLA0KICAgICAgICAnY29uZmlnLm1vZGUnOiBbeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogJ+WFrOmSpeexu+Wei+S4jeiDveS4uuepuicsIHRyaWdnZXI6ICdibHVyJ31dLA0KICAgICAgICAnY29uZmlnLnByaXZhdGVLZXknOiBbeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogJ+ivt+i+k+WFpeWVhuaIt+engemSpScsIHRyaWdnZXI6ICdibHVyJyB9XSwNCiAgICAgICAgJ2NvbmZpZy5hbGlwYXlQdWJsaWNLZXknOiBbeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogJ+ivt+i+k+WFpeaUr+S7mOWuneWFrOmSpeWtl+espuS4sicsIHRyaWdnZXI6ICdibHVyJyB9XSwNCiAgICAgICAgJ2NvbmZpZy5hcHBDZXJ0Q29udGVudCc6IFt7IHJlcXVpcmVkOiB0cnVlLCAgbWVzc2FnZTogJ+ivt+S4iuS8oOWVhuaIt+WFrOmSpeW6lOeUqOivgeS5picsIHRyaWdnZXI6ICdibHVyJyB9XSwNCiAgICAgICAgJ2NvbmZpZy5hbGlwYXlQdWJsaWNDZXJ0Q29udGVudCc6IFt7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAn6K+35LiK5Lyg5pSv5LuY5a6d5YWs6ZKl6K+B5LmmJywgdHJpZ2dlcjogJ2JsdXInfV0sDQogICAgICAgICdjb25maWcucm9vdENlcnRDb250ZW50JzogW3sgcmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICfor7fkuIrkvKDmjIflrprmoLnor4HkuaYnLCB0cmlnZ2VyOiAnYmx1cicgfV0sDQogICAgICB9LA0KICAgICAgZmlsZUFjY2VwdDogIi5jcnQiLA0KICAgIH0NCiAgfSwNCiAgbWV0aG9kczogew0KICAgIG9wZW4oYXBwSWQsIGNvZGUpIHsNCiAgICAgIHRoaXMuZGlhbG9nVmlzaWJsZSA9IHRydWU7DQogICAgICB0aGlzLmZvcm1Mb2FkaW5nID0gdHJ1ZTsNCiAgICAgIHRoaXMucmVzZXQoYXBwSWQsIGNvZGUpOw0KICAgICAgZ2V0Q2hhbm5lbChhcHBJZCwgY29kZSkudGhlbihyZXNwb25zZSA9PiB7DQogICAgICAgIGlmIChyZXNwb25zZS5kYXRhICYmIHJlc3BvbnNlLmRhdGEuaWQpIHsNCiAgICAgICAgICB0aGlzLmZvcm1EYXRhID0gcmVzcG9uc2UuZGF0YTsNCiAgICAgICAgICB0aGlzLmZvcm1EYXRhLmNvbmZpZyA9IEpTT04ucGFyc2UocmVzcG9uc2UuZGF0YS5jb25maWcpOw0KICAgICAgICB9DQogICAgICAgIHRoaXMudGl0bGUgPSAhdGhpcy5mb3JtRGF0YS5pZCA/ICfliJvlu7rmlK/ku5jmuKDpgZMnIDogJ+e8lui+keaUr+S7mOa4oOmBkycNCiAgICAgIH0pLmZpbmFsbHkoKCkgPT4gew0KICAgICAgICB0aGlzLmZvcm1Mb2FkaW5nID0gZmFsc2U7DQogICAgICB9KTsNCiAgICB9LA0KICAgIGNsb3NlKCkgew0KICAgICAgdGhpcy5kaWFsb2dWaXNpYmxlID0gZmFsc2U7DQogICAgICB0aGlzLnJlc2V0KHVuZGVmaW5lZCwgdW5kZWZpbmVkKTsNCiAgICB9LA0KICAgIHN1Ym1pdEZvcm0oKSB7DQogICAgICB0aGlzLiRyZWZzWydmb3JtJ10udmFsaWRhdGUodmFsaWQgPT4gew0KICAgICAgICBpZiAoIXZhbGlkKSB7DQogICAgICAgICAgcmV0dXJuDQogICAgICAgIH0NCiAgICAgICAgY29uc3QgZGF0YSA9IHsgLi4udGhpcy5mb3JtRGF0YSB9Ow0KICAgICAgICBkYXRhLmNvbmZpZyA9IEpTT04uc3RyaW5naWZ5KHRoaXMuZm9ybURhdGEuY29uZmlnKTsNCiAgICAgICAgaWYgKCFkYXRhLmlkKSB7DQogICAgICAgICAgY3JlYXRlQ2hhbm5lbChkYXRhKS50aGVuKHJlc3BvbnNlID0+IHsNCiAgICAgICAgICAgIHRoaXMuJG1vZGFsLm1zZ1N1Y2Nlc3MoIuaWsOWinuaIkOWKnyIpOw0KICAgICAgICAgICAgdGhpcy4kZW1pdCgnc3VjY2VzcycpDQogICAgICAgICAgICB0aGlzLmNsb3NlKCk7DQogICAgICAgICAgfSk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgdXBkYXRlQ2hhbm5lbChkYXRhKS50aGVuKHJlc3BvbnNlID0+IHsNCiAgICAgICAgICAgIHRoaXMuJG1vZGFsLm1zZ1N1Y2Nlc3MoIuS/ruaUueaIkOWKnyIpOw0KICAgICAgICAgICAgdGhpcy4kZW1pdCgnc3VjY2VzcycpDQogICAgICAgICAgICB0aGlzLmNsb3NlKCk7DQogICAgICAgICAgfSkNCiAgICAgICAgfQ0KICAgICAgfSk7DQogICAgfSwNCiAgICAvKiog6YeN572u6KGo5Y2VICovDQogICAgcmVzZXQoYXBwSWQsIGNvZGUpIHsNCiAgICAgIHRoaXMuZm9ybURhdGEgPSB7DQogICAgICAgIGFwcElkOiBhcHBJZCwNCiAgICAgICAgY29kZTogY29kZSwNCiAgICAgICAgc3RhdHVzOiBDb21tb25TdGF0dXNFbnVtLkVOQUJMRSwNCiAgICAgICAgcmVtYXJrOiAnJywNCiAgICAgICAgZmVlUmF0ZTogbnVsbCwNCiAgICAgICAgY29uZmlnOiB7DQogICAgICAgICAgYXBwSWQ6ICcnLA0KICAgICAgICAgIHNlcnZlclVybDogbnVsbCwNCiAgICAgICAgICBzaWduVHlwZTogJ1JTQTInLA0KICAgICAgICAgIG1vZGU6IG51bGwsDQogICAgICAgICAgcHJpdmF0ZUtleTogJycsDQogICAgICAgICAgYWxpcGF5UHVibGljS2V5OiAnJywNCiAgICAgICAgICBhcHBDZXJ0Q29udGVudDogJycsDQogICAgICAgICAgYWxpcGF5UHVibGljQ2VydENvbnRlbnQ6ICcnLA0KICAgICAgICAgIHJvb3RDZXJ0Q29udGVudDogJycNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgICAgdGhpcy5yZXNldEZvcm0oJ2Zvcm0nKQ0KICAgIH0sDQogICAgZmlsZUJlZm9yZVVwbG9hZChmaWxlKSB7DQogICAgICBsZXQgZm9ybWF0ID0gJy4nICsgZmlsZS5uYW1lLnNwbGl0KCIuIilbMV07DQogICAgICBpZiAoZm9ybWF0ICE9PSB0aGlzLmZpbGVBY2NlcHQpIHsNCiAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcign6K+35LiK5Lyg5oyH5a6a5qC85byPIicgKyB0aGlzLmZpbGVBY2NlcHQgKyAnIuaWh+S7ticpOw0KICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICB9DQogICAgICBsZXQgaXNSaWdodFNpemUgPSBmaWxlLnNpemUgLyAxMDI0IC8gMTAyNCA8IDINCiAgICAgIGlmICghaXNSaWdodFNpemUpIHsNCiAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcign5paH5Lu25aSn5bCP6LaF6L+HIDJNQicpDQogICAgICB9DQogICAgICByZXR1cm4gaXNSaWdodFNpemUNCiAgICB9LA0KICAgIGFwcENlcnRVcGxvYWQoZXZlbnQpIHsNCiAgICAgIGNvbnN0IHJlYWRGaWxlID0gbmV3IEZpbGVSZWFkZXIoKQ0KICAgICAgcmVhZEZpbGUub25sb2FkID0gKGUpID0+IHsNCiAgICAgICAgdGhpcy5mb3JtRGF0YS5jb25maWcuYXBwQ2VydENvbnRlbnQgPSBlLnRhcmdldC5yZXN1bHQNCiAgICAgIH0NCiAgICAgIHJlYWRGaWxlLnJlYWRBc1RleHQoZXZlbnQuZmlsZSk7DQogICAgfSwNCiAgICBhbGlwYXlQdWJsaWNDZXJ0VXBsb2FkKGV2ZW50KSB7DQogICAgICBjb25zdCByZWFkRmlsZSA9IG5ldyBGaWxlUmVhZGVyKCkNCiAgICAgIHJlYWRGaWxlLm9ubG9hZCA9IChlKSA9PiB7DQogICAgICAgIHRoaXMuZm9ybURhdGEuY29uZmlnLmFsaXBheVB1YmxpY0NlcnRDb250ZW50ID0gZS50YXJnZXQucmVzdWx0DQogICAgICB9DQogICAgICByZWFkRmlsZS5yZWFkQXNUZXh0KGV2ZW50LmZpbGUpOw0KICAgIH0sDQogICAgcm9vdENlcnRVcGxvYWQoZXZlbnQpIHsNCiAgICAgIGNvbnN0IHJlYWRGaWxlID0gbmV3IEZpbGVSZWFkZXIoKQ0KICAgICAgcmVhZEZpbGUub25sb2FkID0gKGUpID0+IHsNCiAgICAgICAgdGhpcy5mb3JtRGF0YS5jb25maWcucm9vdENlcnRDb250ZW50ID0gZS50YXJnZXQucmVzdWx0DQogICAgICB9DQogICAgICByZWFkRmlsZS5yZWFkQXNUZXh0KGV2ZW50LmZpbGUpOw0KICAgIH0NCiAgfQ0KfQ0K"},{"version":3,"sources":["alipayChannelForm.vue"],"names":[],"mappings":";AAwHA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"alipayChannelForm.vue","sourceRoot":"src/views/pay/app/components","sourcesContent":["<template>\r\n  <div>\r\n    <el-dialog :visible.sync=\"dialogVisible\" :title=\"title\" @closed=\"close\" append-to-body width=\"800px\">\r\n      <el-form ref=\"form\" :model=\"formData\" :rules=\"rules\" size=\"medium\" label-width=\"100px\" v-loading=\"formLoading\">\r\n        <el-form-item label-width=\"180px\" label=\"渠道费率\" prop=\"feeRate\">\r\n          <el-input v-model=\"formData.feeRate\" placeholder=\"请输入渠道费率\" clearable :style=\"{width: '100%'}\">\r\n            <template slot=\"append\">%</template>\r\n          </el-input>\r\n        </el-form-item>\r\n        <el-form-item label-width=\"180px\" label=\"开放平台 APPID\" prop=\"config.appId\">\r\n          <el-input v-model=\"formData.config.appId\" placeholder=\"请输入开放平台 APPID\" clearable :style=\"{width: '100%'}\">\r\n          </el-input>\r\n        </el-form-item>\r\n        <el-form-item label-width=\"180px\" label=\"渠道状态\" prop=\"status\">\r\n          <el-radio-group v-model=\"formData.status\" size=\"medium\">\r\n            <el-radio v-for=\"dict in this.getDictDatas(DICT_TYPE.COMMON_STATUS)\" :key=\"parseInt(dict.value)\"\r\n                      :label=\"parseInt(dict.value)\">\r\n              {{ dict.label }}\r\n            </el-radio>\r\n          </el-radio-group>\r\n        </el-form-item>\r\n        <el-form-item label-width=\"180px\" label=\"网关地址\" prop=\"config.serverUrl\">\r\n          <el-radio-group v-model=\"formData.config.serverUrl\" size=\"medium\">\r\n            <el-radio label=\"https://openapi.alipay.com/gateway.do\">线上环境</el-radio>\r\n            <el-radio label=\"https://openapi-sandbox.dl.alipaydev.com/gateway.do\">沙箱环境</el-radio>\r\n          </el-radio-group>\r\n        </el-form-item>\r\n        <el-form-item label-width=\"180px\" label=\"算法类型\" prop=\"config.signType\">\r\n          <el-radio-group v-model=\"formData.config.signType\" size=\"medium\">\r\n            <el-radio key=\"RSA2\" label=\"RSA2\">RSA2</el-radio>\r\n          </el-radio-group>\r\n        </el-form-item>\r\n        <el-form-item label-width=\"180px\" label=\"公钥类型\" prop=\"config.mode\">\r\n          <el-radio-group v-model=\"formData.config.mode\" size=\"medium\">\r\n            <el-radio  key=\"公钥模式\" :label=\"1\">公钥模式</el-radio>\r\n            <el-radio  key=\"证书模式\" :label=\"2\">证书模式</el-radio>\r\n          </el-radio-group>\r\n        </el-form-item>\r\n        <div v-if=\"formData.config.mode === 1\">\r\n          <el-form-item label-width=\"180px\" label=\"应用私钥\" prop=\"config.privateKey\">\r\n            <el-input type=\"textarea\" :autosize=\"{minRows: 8, maxRows: 8}\" v-model=\"formData.config.privateKey\"\r\n                      placeholder=\"请输入应用私钥\" clearable :style=\"{width: '100%'}\">\r\n            </el-input>\r\n          </el-form-item>\r\n          <el-form-item label-width=\"180px\" label=\"支付宝公钥\" prop=\"config.alipayPublicKey\">\r\n            <el-input\r\n              type=\"textarea\"\r\n              :autosize=\"{minRows: 8, maxRows: 8}\"\r\n              v-model=\"formData.config.alipayPublicKey\"\r\n              placeholder=\"请输入支付宝公钥\" clearable\r\n              :style=\"{width: '100%'}\">\r\n            </el-input>\r\n          </el-form-item>\r\n        </div>\r\n        <div v-if=\"formData.config.mode === 2\">\r\n          <el-form-item label-width=\"180px\" label=\"商户公钥应用证书\" prop=\"config.appCertContent\">\r\n            <el-input v-model=\"formData.config.appCertContent\" type=\"textarea\"\r\n                      placeholder=\"请上传商户公钥应用证书\"\r\n                      readonly :autosize=\"{minRows: 8, maxRows: 8}\" :style=\"{width: '100%'}\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label-width=\"180px\" label=\"\">\r\n            <el-upload\r\n              action=\"\"\r\n              ref=\"privateKeyContentFile\"\r\n              :limit=\"1\"\r\n              :accept=\"fileAccept\"\r\n              :http-request=\"appCertUpload\"\r\n              :before-upload=\"fileBeforeUpload\">\r\n              <el-button size=\"small\" type=\"primary\" icon=\"el-icon-upload\">点击上传</el-button>\r\n            </el-upload>\r\n          </el-form-item>\r\n          <el-form-item label-width=\"180px\" label=\"支付宝公钥证书\" prop=\"config.alipayPublicCertContent\">\r\n            <el-input v-model=\"formData.config.alipayPublicCertContent\" type=\"textarea\"\r\n                      placeholder=\"请上传支付宝公钥证书\"\r\n                      readonly :autosize=\"{minRows: 8, maxRows: 8}\" :style=\"{width: '100%'}\"></el-input>\r\n          </el-form-item>\r\n          <el-form-item label-width=\"180px\" label=\"\">\r\n            <el-upload\r\n              ref=\"privateCertContentFile\"\r\n              action=\"\"\r\n              :limit=\"1\"\r\n              :accept=\"fileAccept\"\r\n              :before-upload=\"fileBeforeUpload\"\r\n              :http-request=\"alipayPublicCertUpload\">\r\n              <el-button size=\"small\" type=\"primary\" icon=\"el-icon-upload\">点击上传</el-button>\r\n            </el-upload>\r\n          </el-form-item>\r\n          <el-form-item label-width=\"180px\" label=\"根证书\" prop=\"config.rootCertContent\">\r\n            <el-input\r\n              v-model=\"formData.config.rootCertContent\"\r\n              type=\"textarea\"\r\n              placeholder=\"请上传根证书\"\r\n              readonly :autosize=\"{minRows: 8, maxRows: 8}\"\r\n              :style=\"{width: '100%'}\">\r\n            </el-input>\r\n          </el-form-item>\r\n          <el-form-item label-width=\"180px\" label=\"\">\r\n            <el-upload\r\n              ref=\"privateCertContentFile\"\r\n              :limit=\"1\"\r\n              :accept=\"fileAccept\"\r\n              action=\"\"\r\n              :before-upload=\"fileBeforeUpload\"\r\n              :http-request=\"rootCertUpload\">\r\n              <el-button size=\"small\" type=\"primary\" icon=\"el-icon-upload\">点击上传</el-button>\r\n            </el-upload>\r\n          </el-form-item>\r\n        </div>\r\n        <el-form-item label-width=\"180px\" label=\"备注\" prop=\"remark\">\r\n          <el-input v-model=\"formData.remark\" :style=\"{width: '100%'}\"></el-input>\r\n        </el-form-item>\r\n      </el-form>\r\n      <div slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"close\">取消</el-button>\r\n        <el-button type=\"primary\" @click=\"submitForm\">确定</el-button>\r\n      </div>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n<script>\r\nimport { createChannel, getChannel, updateChannel } from \"@/api/pay/channel\";\r\nimport { CommonStatusEnum } from \"@/utils/constants\";\r\n\r\nexport default {\r\n  name: \"alipayChannelForm\",\r\n  data() {\r\n    return {\r\n      dialogVisible: false,\r\n      formLoading: false,\r\n      title:'',\r\n      formData: {\r\n        appId: '',\r\n        code: '',\r\n        status: undefined,\r\n        feeRate: undefined,\r\n        remark: '',\r\n        config: {\r\n          appId: '',\r\n          serverUrl: null,\r\n          signType: '',\r\n          mode: null,\r\n          privateKey: '',\r\n          alipayPublicKey: '',\r\n          appCertContent: '',\r\n          alipayPublicCertContent: '',\r\n          rootCertContent: ''\r\n        }\r\n      },\r\n      rules: {\r\n        feeRate: [{ required: true,  message: '请输入渠道费率', trigger: 'blur' }],\r\n        status: [{ required: true,  message: '渠道状态不能为空',  trigger: 'blur' }],\r\n        'config.appId': [{ required: true, message: '请输入开放平台上创建的应用的 ID', trigger: 'blur' }],\r\n        'config.serverUrl': [{ required: true, message: '请传入网关地址', trigger: 'blur' }],\r\n        'config.signType': [{ required: true, message: '请传入签名算法类型', trigger: 'blur' }],\r\n        'config.mode': [{ required: true, message: '公钥类型不能为空', trigger: 'blur'}],\r\n        'config.privateKey': [{ required: true, message: '请输入商户私钥', trigger: 'blur' }],\r\n        'config.alipayPublicKey': [{ required: true, message: '请输入支付宝公钥字符串', trigger: 'blur' }],\r\n        'config.appCertContent': [{ required: true,  message: '请上传商户公钥应用证书', trigger: 'blur' }],\r\n        'config.alipayPublicCertContent': [{ required: true, message: '请上传支付宝公钥证书', trigger: 'blur'}],\r\n        'config.rootCertContent': [{ required: true, message: '请上传指定根证书', trigger: 'blur' }],\r\n      },\r\n      fileAccept: \".crt\",\r\n    }\r\n  },\r\n  methods: {\r\n    open(appId, code) {\r\n      this.dialogVisible = true;\r\n      this.formLoading = true;\r\n      this.reset(appId, code);\r\n      getChannel(appId, code).then(response => {\r\n        if (response.data && response.data.id) {\r\n          this.formData = response.data;\r\n          this.formData.config = JSON.parse(response.data.config);\r\n        }\r\n        this.title = !this.formData.id ? '创建支付渠道' : '编辑支付渠道'\r\n      }).finally(() => {\r\n        this.formLoading = false;\r\n      });\r\n    },\r\n    close() {\r\n      this.dialogVisible = false;\r\n      this.reset(undefined, undefined);\r\n    },\r\n    submitForm() {\r\n      this.$refs['form'].validate(valid => {\r\n        if (!valid) {\r\n          return\r\n        }\r\n        const data = { ...this.formData };\r\n        data.config = JSON.stringify(this.formData.config);\r\n        if (!data.id) {\r\n          createChannel(data).then(response => {\r\n            this.$modal.msgSuccess(\"新增成功\");\r\n            this.$emit('success')\r\n            this.close();\r\n          });\r\n        } else {\r\n          updateChannel(data).then(response => {\r\n            this.$modal.msgSuccess(\"修改成功\");\r\n            this.$emit('success')\r\n            this.close();\r\n          })\r\n        }\r\n      });\r\n    },\r\n    /** 重置表单 */\r\n    reset(appId, code) {\r\n      this.formData = {\r\n        appId: appId,\r\n        code: code,\r\n        status: CommonStatusEnum.ENABLE,\r\n        remark: '',\r\n        feeRate: null,\r\n        config: {\r\n          appId: '',\r\n          serverUrl: null,\r\n          signType: 'RSA2',\r\n          mode: null,\r\n          privateKey: '',\r\n          alipayPublicKey: '',\r\n          appCertContent: '',\r\n          alipayPublicCertContent: '',\r\n          rootCertContent: ''\r\n        }\r\n      }\r\n      this.resetForm('form')\r\n    },\r\n    fileBeforeUpload(file) {\r\n      let format = '.' + file.name.split(\".\")[1];\r\n      if (format !== this.fileAccept) {\r\n        this.$message.error('请上传指定格式\"' + this.fileAccept + '\"文件');\r\n        return false;\r\n      }\r\n      let isRightSize = file.size / 1024 / 1024 < 2\r\n      if (!isRightSize) {\r\n        this.$message.error('文件大小超过 2MB')\r\n      }\r\n      return isRightSize\r\n    },\r\n    appCertUpload(event) {\r\n      const readFile = new FileReader()\r\n      readFile.onload = (e) => {\r\n        this.formData.config.appCertContent = e.target.result\r\n      }\r\n      readFile.readAsText(event.file);\r\n    },\r\n    alipayPublicCertUpload(event) {\r\n      const readFile = new FileReader()\r\n      readFile.onload = (e) => {\r\n        this.formData.config.alipayPublicCertContent = e.target.result\r\n      }\r\n      readFile.readAsText(event.file);\r\n    },\r\n    rootCertUpload(event) {\r\n      const readFile = new FileReader()\r\n      readFile.onload = (e) => {\r\n        this.formData.config.rootCertContent = e.target.result\r\n      }\r\n      readFile.readAsText(event.file);\r\n    }\r\n  }\r\n}\r\n</script>\r\n"]}]}