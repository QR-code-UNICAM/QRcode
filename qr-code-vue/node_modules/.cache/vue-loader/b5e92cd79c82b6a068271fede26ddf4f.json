{"remainingRequest":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\src\\components\\bpmnProcessDesigner\\package\\penal\\base\\ElementBaseInfo.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\src\\components\\bpmnProcessDesigner\\package\\penal\\base\\ElementBaseInfo.vue","mtime":1704630437712},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQoNCmV4cG9ydCBkZWZhdWx0IHsNCiAgbmFtZTogIkVsZW1lbnRCYXNlSW5mbyIsDQogIHByb3BzOiB7DQogICAgYnVzaW5lc3NPYmplY3Q6IE9iamVjdCwNCiAgICBtb2RlbDogT2JqZWN0LCAvLyDmtYHnqIvmqKHlnovnmoTmlbDmja4NCiAgfSwNCiAgZGF0YSAoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIGVsZW1lbnRCYXNlSW5mbzoge30sDQogICAgICAvLyDmtYHnqIvooajljZXnmoTkuIvmi4nmoYbnmoTmlbDmja4NCiAgICAgIGZvcm1zOiBbXSwNCiAgICAgIC8vIOa1geeoi+aooeWei+eahOagoemqjA0KICAgICAgcnVsZXM6IHsNCiAgICAgICAga2V5OiBbeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogIua1geeoi+agh+ivhuS4jeiDveS4uuepuiIsIHRyaWdnZXI6ICJibHVyIiB9XSwNCiAgICAgICAgbmFtZTogW3sgcmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICLmtYHnqIvlkI3np7DkuI3og73kuLrnqboiLCB0cmlnZ2VyOiAiYmx1ciIgfV0sDQogICAgICB9LA0KICAgIH0NCiAgfSwNCiAgd2F0Y2g6IHsNCiAgICBidXNpbmVzc09iamVjdDogew0KICAgICAgaW1tZWRpYXRlOiBmYWxzZSwNCiAgICAgIGhhbmRsZXI6IGZ1bmN0aW9uICh2YWwpIHsNCiAgICAgICAgaWYgKHZhbCkgew0KICAgICAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHRoaXMucmVzZXRCYXNlSW5mbygpKQ0KICAgICAgICB9DQogICAgICB9DQogICAgfSwNCiAgICAvLyAnbW9kZWwua2V5Jzogew0KICAgIC8vICAgaW1tZWRpYXRlOiBmYWxzZSwNCiAgICAvLyAgIGhhbmRsZXI6IGZ1bmN0aW9uICh2YWwpIHsNCiAgICAvLyAgICAgdGhpcy5oYW5kbGVLZXlVcGRhdGUodmFsKQ0KICAgIC8vICAgfQ0KICAgIC8vIH0NCiAgfSwNCiAgY3JlYXRlZCAoKSB7DQogICAgLy8g6ZKI5a+55LiK5Lyg55qEIGJwbW4g5rWB56iL5Zu+5pe277yM6ZyA6KaB5bu26L+fIDEg56eS55qE5pe26Ze077yM5L+d6K+BIGtleSDlkowgbmFtZSDnmoTmm7TmlrANCiAgICBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgIHRoaXMuaGFuZGxlS2V5VXBkYXRlKHRoaXMubW9kZWwua2V5KQ0KICAgICAgdGhpcy5oYW5kbGVOYW1lVXBkYXRlKHRoaXMubW9kZWwubmFtZSkNCiAgICB9LCAxMDAwKQ0KICB9LA0KICBtZXRob2RzOiB7DQogICAgcmVzZXRCYXNlSW5mbyAoKSB7DQogICAgICB0aGlzLmJwbW5FbGVtZW50ID0gd2luZG93Py5icG1uSW5zdGFuY2VzPy5icG1uRWxlbWVudA0KICAgICAgdGhpcy5lbGVtZW50QmFzZUluZm8gPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHRoaXMuYnBtbkVsZW1lbnQuYnVzaW5lc3NPYmplY3QpKQ0KICAgIH0sDQogICAgaGFuZGxlS2V5VXBkYXRlICh2YWx1ZSkgew0KICAgICAgLy8g5qCh6aqMIHZhbHVlIOeahOWAvO+8jOWPquaciSBYTUwgTkNOYW1lIOmAmui/h+eahOaDheWGteS4i++8jOaJjei/m+ihjOi1i+WAvOOAguWQpuWIme+8jOS8muWvvOiHtOa1geeoi+WbvuaKpemUme+8jOaXoOazlee7mOWItueahOmXrumimA0KICAgICAgaWYgKCF2YWx1ZSkgew0KICAgICAgICByZXR1cm4NCiAgICAgIH0NCiAgICAgIGlmICghdmFsdWUubWF0Y2goL1thLXpBLVpfXVtcLV8uMC05YS16QS1aJF0qLykpIHsNCiAgICAgICAgY29uc29sZS5sb2coJ2tleSDkuI3mu6HotrMgWE1MIE5DTmFtZSDop4TliJnvvIzmiYDku6XkuI3ov5vooYzotYvlgLwnKQ0KICAgICAgICByZXR1cm4NCiAgICAgIH0NCiAgICAgIGNvbnNvbGUubG9nKCdrZXkg5ruh6LazIFhNTCBOQ05hbWUg6KeE5YiZ77yM5omA5Lul6L+b6KGM6LWL5YC8JykNCg0KICAgICAgLy8g5ZyoIEJQTU4g55qEIFhNTCDkuK3vvIzmtYHnqIvmoIfor4Yga2V577yM5YW25a6e5a+55bqU55qE5pivIGlkIOiKgueCuQ0KICAgICAgdGhpcy5lbGVtZW50QmFzZUluZm9bJ2lkJ10gPSB2YWx1ZQ0KICAgICAgdGhpcy51cGRhdGVCYXNlSW5mbygnaWQnKQ0KICAgIH0sDQogICAgaGFuZGxlTmFtZVVwZGF0ZSAodmFsdWUpIHsNCiAgICAgIGlmICghdmFsdWUpIHsNCiAgICAgICAgcmV0dXJuDQogICAgICB9DQogICAgICB0aGlzLmVsZW1lbnRCYXNlSW5mb1snbmFtZSddID0gdmFsdWUNCiAgICAgIHRoaXMudXBkYXRlQmFzZUluZm8oJ25hbWUnKQ0KICAgIH0sDQogICAgaGFuZGxlRGVzY3JpcHRpb25VcGRhdGUgKHZhbHVlKSB7DQogICAgICAvLyBUT0RPIOiKi+iJv++8mmRvY3VtZW50YXRpb24g5pqC5pe25peg5rOV5L+u5pS577yM5ZCO57ut5Zyo55yL55yLDQogICAgICAvLyB0aGlzLmVsZW1lbnRCYXNlSW5mb1snZG9jdW1lbnRhdGlvbiddID0gdmFsdWU7DQogICAgICAvLyB0aGlzLnVwZGF0ZUJhc2VJbmZvKCdkb2N1bWVudGF0aW9uJyk7DQogICAgfSwNCiAgICB1cGRhdGVCYXNlSW5mbyAoa2V5KSB7DQogICAgICAvLyDop6blj5EgZWxlbWVudEJhc2VJbmZvIOWvueW6lOeahOWtl+autQ0KICAgICAgY29uc3QgYXR0ck9iaiA9IE9iamVjdC5jcmVhdGUobnVsbCkNCiAgICAgIGF0dHJPYmpba2V5XSA9IHRoaXMuZWxlbWVudEJhc2VJbmZvW2tleV0NCiAgICAgIGlmIChrZXkgPT09ICJpZCIpIHsNCiAgICAgICAgd2luZG93LmJwbW5JbnN0YW5jZXMubW9kZWxpbmcudXBkYXRlUHJvcGVydGllcyh0aGlzLmJwbW5FbGVtZW50LCB7DQogICAgICAgICAgaWQ6IHRoaXMuZWxlbWVudEJhc2VJbmZvW2tleV0sDQogICAgICAgICAgZGk6IHsgaWQ6IGAke3RoaXMuZWxlbWVudEJhc2VJbmZvW2tleV19X2RpYCB9DQogICAgICAgIH0pDQogICAgICB9IGVsc2Ugew0KICAgICAgICB3aW5kb3cuYnBtbkluc3RhbmNlcy5tb2RlbGluZy51cGRhdGVQcm9wZXJ0aWVzKHRoaXMuYnBtbkVsZW1lbnQsIGF0dHJPYmopDQogICAgICB9DQogICAgfQ0KICB9LA0KICBiZWZvcmVEZXN0cm95ICgpIHsNCiAgICB0aGlzLmJwbW5FbGVtZW50ID0gbnVsbA0KICB9DQp9Ow0K"},{"version":3,"sources":["ElementBaseInfo.vue"],"names":[],"mappings":";;AAuDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ElementBaseInfo.vue","sourceRoot":"src/components/bpmnProcessDesigner/package/penal/base","sourcesContent":["<template>\r\n  <div class=\"panel-tab__content\">\r\n    <el-form\r\n      size=\"mini\"\r\n      label-width=\"90px\"\r\n      :model=\"model\"\r\n      :rules=\"rules\"\r\n      @submit.native.prevent\r\n    >\r\n      <div v-if=\"elementBaseInfo.$type === 'bpmn:Process'\">\r\n        <!-- 如果是 Process 信息的时候，使用自定义表单 -->\r\n        <el-link\r\n          href=\"https://doc.iocoder.cn/bpm/#_3-%E6%B5%81%E7%A8%8B%E5%9B%BE%E7%A4%BA%E4%BE%8B\"\r\n          type=\"danger\"\r\n          target=\"_blank\"\r\n          >如何实现实现会签、或签？</el-link\r\n        >\r\n        <el-form-item label=\"流程标识\" prop=\"key\">\r\n          <el-input\r\n            v-model=\"model.key\"\r\n            placeholder=\"请输入流标标识\"\r\n            :disabled=\"model.id !== undefined && model.id.length > 0\"\r\n            @change=\"handleKeyUpdate\"\r\n          />\r\n        </el-form-item>\r\n        <el-form-item label=\"流程名称\" prop=\"name\">\r\n          <el-input\r\n            v-model=\"model.name\"\r\n            placeholder=\"请输入流程名称\"\r\n            clearable\r\n            @change=\"handleNameUpdate\"\r\n          />\r\n        </el-form-item>\r\n      </div>\r\n      <div v-else>\r\n        <el-form-item label=\"ID\">\r\n          <el-input\r\n            v-model=\"elementBaseInfo.id\"\r\n            clearable\r\n            @change=\"updateBaseInfo('id')\"\r\n          />\r\n        </el-form-item>\r\n        <el-form-item label=\"名称\">\r\n          <el-input\r\n            v-model=\"elementBaseInfo.name\"\r\n            clearable\r\n            @change=\"updateBaseInfo('name')\"\r\n          />\r\n        </el-form-item>\r\n      </div>\r\n    </el-form>\r\n  </div>\r\n</template>\r\n<script>\r\n\r\nexport default {\r\n  name: \"ElementBaseInfo\",\r\n  props: {\r\n    businessObject: Object,\r\n    model: Object, // 流程模型的数据\r\n  },\r\n  data () {\r\n    return {\r\n      elementBaseInfo: {},\r\n      // 流程表单的下拉框的数据\r\n      forms: [],\r\n      // 流程模型的校验\r\n      rules: {\r\n        key: [{ required: true, message: \"流程标识不能为空\", trigger: \"blur\" }],\r\n        name: [{ required: true, message: \"流程名称不能为空\", trigger: \"blur\" }],\r\n      },\r\n    }\r\n  },\r\n  watch: {\r\n    businessObject: {\r\n      immediate: false,\r\n      handler: function (val) {\r\n        if (val) {\r\n          this.$nextTick(() => this.resetBaseInfo())\r\n        }\r\n      }\r\n    },\r\n    // 'model.key': {\r\n    //   immediate: false,\r\n    //   handler: function (val) {\r\n    //     this.handleKeyUpdate(val)\r\n    //   }\r\n    // }\r\n  },\r\n  created () {\r\n    // 针对上传的 bpmn 流程图时，需要延迟 1 秒的时间，保证 key 和 name 的更新\r\n    setTimeout(() => {\r\n      this.handleKeyUpdate(this.model.key)\r\n      this.handleNameUpdate(this.model.name)\r\n    }, 1000)\r\n  },\r\n  methods: {\r\n    resetBaseInfo () {\r\n      this.bpmnElement = window?.bpmnInstances?.bpmnElement\r\n      this.elementBaseInfo = JSON.parse(JSON.stringify(this.bpmnElement.businessObject))\r\n    },\r\n    handleKeyUpdate (value) {\r\n      // 校验 value 的值，只有 XML NCName 通过的情况下，才进行赋值。否则，会导致流程图报错，无法绘制的问题\r\n      if (!value) {\r\n        return\r\n      }\r\n      if (!value.match(/[a-zA-Z_][\\-_.0-9a-zA-Z$]*/)) {\r\n        console.log('key 不满足 XML NCName 规则，所以不进行赋值')\r\n        return\r\n      }\r\n      console.log('key 满足 XML NCName 规则，所以进行赋值')\r\n\r\n      // 在 BPMN 的 XML 中，流程标识 key，其实对应的是 id 节点\r\n      this.elementBaseInfo['id'] = value\r\n      this.updateBaseInfo('id')\r\n    },\r\n    handleNameUpdate (value) {\r\n      if (!value) {\r\n        return\r\n      }\r\n      this.elementBaseInfo['name'] = value\r\n      this.updateBaseInfo('name')\r\n    },\r\n    handleDescriptionUpdate (value) {\r\n      // TODO 芋艿：documentation 暂时无法修改，后续在看看\r\n      // this.elementBaseInfo['documentation'] = value;\r\n      // this.updateBaseInfo('documentation');\r\n    },\r\n    updateBaseInfo (key) {\r\n      // 触发 elementBaseInfo 对应的字段\r\n      const attrObj = Object.create(null)\r\n      attrObj[key] = this.elementBaseInfo[key]\r\n      if (key === \"id\") {\r\n        window.bpmnInstances.modeling.updateProperties(this.bpmnElement, {\r\n          id: this.elementBaseInfo[key],\r\n          di: { id: `${this.elementBaseInfo[key]}_di` }\r\n        })\r\n      } else {\r\n        window.bpmnInstances.modeling.updateProperties(this.bpmnElement, attrObj)\r\n      }\r\n    }\r\n  },\r\n  beforeDestroy () {\r\n    this.bpmnElement = null\r\n  }\r\n};\r\n</script>\r\n"]}]}