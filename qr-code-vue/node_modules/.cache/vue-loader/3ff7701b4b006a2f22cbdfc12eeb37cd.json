{"remainingRequest":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\src\\views\\mp\\components\\wx-material-select\\main.vue?vue&type=style&index=0&id=02be4e7b&lang=scss&scoped=true","dependencies":[{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\src\\views\\mp\\components\\wx-material-select\\main.vue","mtime":1704630438004},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQovKueAkeW4g+a1geagt+W8jyovDQoud2F0ZXJmYWxsIHsNCiAgd2lkdGg6IDEwMCU7DQogIGNvbHVtbi1nYXA6MTBweDsNCiAgY29sdW1uLWNvdW50OiA1Ow0KICBtYXJnaW46IDAgYXV0bzsNCn0NCi53YXRlcmZhbGwtaXRlbSB7DQogIHBhZGRpbmc6IDEwcHg7DQogIG1hcmdpbi1ib3R0b206IDEwcHg7DQogIGJyZWFrLWluc2lkZTogYXZvaWQ7DQogIGJvcmRlcjogMXB4IHNvbGlkICNlYWVhZWE7DQp9DQoubWF0ZXJpYWwtaW1nIHsNCiAgd2lkdGg6IDEwMCU7DQp9DQpwIHsNCiAgbGluZS1oZWlnaHQ6IDMwcHg7DQp9DQpAbWVkaWEgKG1pbi13aWR0aDogOTkycHgpIGFuZCAobWF4LXdpZHRoOiAxMzAwcHgpIHsNCiAgLndhdGVyZmFsbCB7DQogICAgY29sdW1uLWNvdW50OiAzOw0KICB9DQogIHAgew0KICAgIGNvbG9yOnJlZDsNCiAgfQ0KfQ0KQG1lZGlhIChtaW4td2lkdGg6IDc2OHB4KSBhbmQgKG1heC13aWR0aDogOTkxcHgpIHsNCiAgLndhdGVyZmFsbCB7DQogICAgY29sdW1uLWNvdW50OiAyOw0KICB9DQogIHAgew0KICAgIGNvbG9yOiBvcmFuZ2U7DQogIH0NCn0NCkBtZWRpYSAobWF4LXdpZHRoOiA3NjdweCkgew0KICAud2F0ZXJmYWxsIHsNCiAgICBjb2x1bW4tY291bnQ6IDE7DQogIH0NCn0NCi8q54CR5biD5rWB5qC35byPKi8NCg=="},{"version":3,"sources":["main.vue"],"names":[],"mappings":";AA6MA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"main.vue","sourceRoot":"src/views/mp/components/wx-material-select","sourcesContent":["<!--\r\n  - Copyright (C) 2018-2019\r\n  - All rights reserved, Designed By www.joolun.com\r\n  芋道源码：\r\n  ① 移除 avue 组件，使用 ElementUI 原生组件\r\n-->\r\n<template>\r\n  <!-- 类型：图片 -->\r\n  <div v-if=\"objData.type === 'image'\">\r\n    <div class=\"waterfall\" v-loading=\"loading\">\r\n      <div class=\"waterfall-item\" v-for=\"item in list\" :key=\"item.mediaId\">\r\n        <img class=\"material-img\" :src=\"item.url\">\r\n        <p class=\"item-name\">{{item.name}}</p>\r\n        <el-row class=\"ope-row\">\r\n          <el-button size=\"mini\" type=\"success\" @click=\"selectMaterial(item)\">选择\r\n            <i class=\"el-icon-circle-check el-icon--right\"></i>\r\n          </el-button>\r\n        </el-row>\r\n      </div>\r\n    </div>\r\n    <!-- 分页组件 -->\r\n    <pagination v-show=\"total > 0\" :total=\"total\" :page.sync=\"queryParams.pageNo\" :limit.sync=\"queryParams.pageSize\"\r\n                @pagination=\"getMaterialPage\"/>\r\n  </div>\r\n  <!-- 类型：语音 -->\r\n  <div v-else-if=\"objData.type === 'voice'\">\r\n    <!-- 列表 -->\r\n    <el-table v-loading=\"loading\" :data=\"list\">\r\n      <el-table-column label=\"编号\" align=\"center\" prop=\"mediaId\" />\r\n      <el-table-column label=\"文件名\" align=\"center\" prop=\"name\" />\r\n      <el-table-column label=\"语音\" align=\"center\">\r\n        <template v-slot=\"scope\">\r\n          <wx-voice-player :url=\"scope.row.url\" />\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"上传时间\" align=\"center\" prop=\"createTime\" width=\"180\">\r\n        <template v-slot=\"scope\">\r\n          <span>{{ parseTime(scope.row.createTime) }}</span>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"操作\" align=\"center\" fixed=\"right\" class-name=\"small-padding fixed-width\">\r\n        <template v-slot=\"scope\">\r\n          <el-button size=\"mini\" type=\"text\" icon=\"el-icon-circle-plus\"\r\n                     @click=\"selectMaterial(scope.row)\">选择</el-button>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n    <!-- 分页组件 -->\r\n    <pagination v-show=\"total > 0\" :total=\"total\" :page.sync=\"queryParams.pageNo\" :limit.sync=\"queryParams.pageSize\"\r\n                @pagination=\"getPage\"/>\r\n  </div>\r\n  <div v-else-if=\"objData.type === 'video'\">\r\n    <!-- 列表 -->\r\n    <el-table v-loading=\"loading\" :data=\"list\">\r\n      <el-table-column label=\"编号\" align=\"center\" prop=\"mediaId\" />\r\n      <el-table-column label=\"文件名\" align=\"center\" prop=\"name\" />\r\n      <el-table-column label=\"标题\" align=\"center\" prop=\"title\" />\r\n      <el-table-column label=\"介绍\" align=\"center\" prop=\"introduction\" />\r\n      <el-table-column label=\"视频\" align=\"center\">\r\n        <template v-slot=\"scope\">\r\n          <wx-video-player :url=\"scope.row.url\" />\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"上传时间\" align=\"center\" prop=\"createTime\" width=\"180\">\r\n        <template v-slot=\"scope\">\r\n          <span>{{ parseTime(scope.row.createTime) }}</span>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column label=\"操作\" align=\"center\" fixed=\"right\" class-name=\"small-padding fixed-width\">\r\n        <template v-slot=\"scope\">\r\n          <el-button size=\"mini\" type=\"text\" icon=\"el-icon-circle-plus\"\r\n                     @click=\"selectMaterial(scope.row)\">选择</el-button>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n    <!-- 分页组件 -->\r\n    <pagination v-show=\"total > 0\" :total=\"total\" :page.sync=\"queryParams.pageNo\" :limit.sync=\"queryParams.pageSize\"\r\n                @pagination=\"getMaterialPage\"/>\r\n  </div>\r\n  <div v-else-if=\"objData.type === 'news'\">\r\n    <div class=\"waterfall\" v-loading=\"loading\">\r\n      <div class=\"waterfall-item\" v-for=\"item in list\" :key=\"item.mediaId\" v-if=\"item.content && item.content.newsItem\">\r\n        <wx-news :articles=\"item.content.newsItem\" />\r\n        <el-row class=\"ope-row\">\r\n          <el-button size=\"mini\" type=\"success\" @click=\"selectMaterial(item)\">\r\n            选择<i class=\"el-icon-circle-check el-icon--right\"></i>\r\n          </el-button>\r\n        </el-row>\r\n      </div>\r\n    </div>\r\n    <!-- 分页组件 -->\r\n    <pagination v-show=\"total > 0\" :total=\"total\" :page.sync=\"queryParams.pageNo\" :limit.sync=\"queryParams.pageSize\"\r\n                @pagination=\"getMaterialPage\"/>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport WxNews from '@/views/mp/components/wx-news/main.vue';\r\nimport WxVoicePlayer from '@/views/mp/components/wx-voice-play/main.vue';\r\nimport WxVideoPlayer from '@/views/mp/components/wx-video-play/main.vue';\r\nimport { getMaterialPage } from \"@/api/mp/material\";\r\nimport { getFreePublishPage } from \"@/api/mp/freePublish\";\r\nimport { getDraftPage } from \"@/api/mp/draft\";\r\n\r\nexport default {\r\n  name: \"wxMaterialSelect\",\r\n  components: {\r\n    WxNews,\r\n    WxVoicePlayer,\r\n    WxVideoPlayer\r\n  },\r\n  props: {\r\n    objData: {\r\n      type: Object, // type - 类型；accountId - 公众号账号编号\r\n      required: true\r\n    },\r\n    newsType:{ // 图文类型：1、已发布图文；2、草稿箱图文\r\n      type: String,\r\n      default: \"1\"\r\n    },\r\n  },\r\n  data() {\r\n    return {\r\n      // 遮罩层\r\n      loading: false,\r\n      // 总条数\r\n      total: 0,\r\n      // 数据列表\r\n      list: [],\r\n      // 查询参数\r\n      queryParams: {\r\n        pageNo: 1,\r\n        pageSize: 10,\r\n        accountId: this.objData.accountId,\r\n      },\r\n    }\r\n  },\r\n  created() {\r\n    this.getPage()\r\n  },\r\n  methods:{\r\n    selectMaterial(item) {\r\n      this.$emit('selectMaterial', item)\r\n    },\r\n    /** 搜索按钮操作 */\r\n    handleQuery() {\r\n      this.queryParams.pageNo = 1\r\n      this.getPage()\r\n    },\r\n    getPage() {\r\n      this.loading = true\r\n      if (this.objData.type === 'news' && this.newsType === '1') { // 【图文】+ 【已发布】\r\n        this.getFreePublishPage();\r\n      } else if (this.objData.type === 'news' && this.newsType === '2') { // 【图文】+ 【草稿】\r\n        this.getDraftPage();\r\n      } else { // 【素材】\r\n        this.getMaterialPage();\r\n      }\r\n    },\r\n    getMaterialPage() {\r\n      getMaterialPage({\r\n        ...this.queryParams,\r\n        type: this.objData.type\r\n      }).then(response => {\r\n        this.list = response.data.list\r\n        this.total = response.data.total\r\n      }).finally(() => {\r\n        this.loading = false\r\n      })\r\n    },\r\n    getFreePublishPage() {\r\n      getFreePublishPage(this.queryParams).then(response => {\r\n        // 将 thumbUrl 转成 picUrl，保证 wx-news 组件可以预览封面\r\n        response.data.list.forEach(item => {\r\n          const newsItem = item.content.newsItem;\r\n          newsItem.forEach(article => {\r\n            article.picUrl = article.thumbUrl;\r\n          })\r\n        })\r\n        this.list = response.data.list\r\n        this.total = response.data.total\r\n      }).finally(() => {\r\n        this.loading = false\r\n      })\r\n    },\r\n    getDraftPage() {\r\n      getDraftPage((this.queryParams)).then(response => {\r\n        // 将 thumbUrl 转成 picUrl，保证 wx-news 组件可以预览封面\r\n        response.data.list.forEach(item => {\r\n          const newsItem = item.content.newsItem;\r\n          newsItem.forEach(article => {\r\n            article.picUrl = article.thumbUrl;\r\n          })\r\n        })\r\n        this.list = response.data.list\r\n        this.total = response.data.total\r\n      }).finally(() => {\r\n        this.loading = false\r\n      })\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n/*瀑布流样式*/\r\n.waterfall {\r\n  width: 100%;\r\n  column-gap:10px;\r\n  column-count: 5;\r\n  margin: 0 auto;\r\n}\r\n.waterfall-item {\r\n  padding: 10px;\r\n  margin-bottom: 10px;\r\n  break-inside: avoid;\r\n  border: 1px solid #eaeaea;\r\n}\r\n.material-img {\r\n  width: 100%;\r\n}\r\np {\r\n  line-height: 30px;\r\n}\r\n@media (min-width: 992px) and (max-width: 1300px) {\r\n  .waterfall {\r\n    column-count: 3;\r\n  }\r\n  p {\r\n    color:red;\r\n  }\r\n}\r\n@media (min-width: 768px) and (max-width: 991px) {\r\n  .waterfall {\r\n    column-count: 2;\r\n  }\r\n  p {\r\n    color: orange;\r\n  }\r\n}\r\n@media (max-width: 767px) {\r\n  .waterfall {\r\n    column-count: 1;\r\n  }\r\n}\r\n/*瀑布流样式*/\r\n</style>\r\n"]}]}