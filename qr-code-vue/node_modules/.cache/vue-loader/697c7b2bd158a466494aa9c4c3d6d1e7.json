{"remainingRequest":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\src\\views\\bpm\\model\\modelEditor.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\src\\views\\bpm\\model\\modelEditor.vue","mtime":1704630437841},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQgdHJhbnNsYXRpb25zIGZyb20gIkAvY29tcG9uZW50cy9icG1uUHJvY2Vzc0Rlc2lnbmVyL3NyYy90cmFuc2xhdGlvbnMiOw0KLy8g6Ieq5a6a5LmJ5YWD57Sg6YCJ5Lit5pe255qE5by55Ye66I+c5Y2V77yI5L+u5pS5IOm7mOiupOS7u+WKoSDkuLog55So5oi35Lu75Yqh77yJDQppbXBvcnQgQ3VzdG9tQ29udGVudFBhZFByb3ZpZGVyIGZyb20gIkAvY29tcG9uZW50cy9icG1uUHJvY2Vzc0Rlc2lnbmVyL3BhY2thZ2UvZGVzaWduZXIvcGx1Z2lucy9jb250ZW50LXBhZCI7DQovLyDoh6rlrprkuYnlt6bkvqfoj5zljZXvvIjkv67mlLkg6buY6K6k5Lu75YqhIOS4uiDnlKjmiLfku7vliqHvvIkNCmltcG9ydCBDdXN0b21QYWxldHRlUHJvdmlkZXIgZnJvbSAiQC9jb21wb25lbnRzL2JwbW5Qcm9jZXNzRGVzaWduZXIvcGFja2FnZS9kZXNpZ25lci9wbHVnaW5zL3BhbGV0dGUiOw0KLy8gaW1wb3J0IHhtbE9iajJqc29uIGZyb20gIi4vdXRpbHMveG1sMmpzb24iOw0KaW1wb3J0IE15UHJvY2Vzc1BhbGV0dGUgZnJvbSAiQC9jb21wb25lbnRzL2JwbW5Qcm9jZXNzRGVzaWduZXIvcGFja2FnZS9wYWxldHRlL1Byb2Nlc3NQYWxldHRlIjsNCmltcG9ydCB7Y3JlYXRlTW9kZWwsIGdldE1vZGVsLCB1cGRhdGVNb2RlbH0gZnJvbSAiQC9hcGkvYnBtL21vZGVsIjsNCi8vIOiHquWumuS5ieS+p+i+ueagjw0KLy8gaW1wb3J0IE15UHJvY2Vzc1BhbmVsIGZyb20gIi4uL3BhY2thZ2UvcHJvY2Vzcy1wYW5lbC9Qcm9jZXNzUGFuZWwiOw0KDQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICJCcG1Nb2RlbEVkaXRvciIsDQogIGNvbXBvbmVudHM6IHsgTXlQcm9jZXNzUGFsZXR0ZSB9LA0KICBkYXRhKCkgew0KICAgIHJldHVybiB7DQogICAgICB4bWxTdHJpbmc6IHVuZGVmaW5lZCwgLy8gQlBNTiBYTUwNCiAgICAgIG1vZGVsZXI6IG51bGwsDQogICAgICByZWxvYWRJbmRleDogMCwNCiAgICAgIGNvbnRyb2xEcmF3ZXJWaXNpYmxlOiBmYWxzZSwNCiAgICAgIHRyYW5zbGF0aW9uc1NlbGY6IHRyYW5zbGF0aW9ucywNCiAgICAgIGNvbnRyb2xGb3JtOiB7DQogICAgICAgIHNpbXVsYXRpb246IHRydWUsDQogICAgICAgIGxhYmVsRWRpdGluZzogZmFsc2UsDQogICAgICAgIGxhYmVsVmlzaWJsZTogZmFsc2UsDQogICAgICAgIHByZWZpeDogImZsb3dhYmxlIiwNCiAgICAgICAgaGVhZGVyQnV0dG9uU2l6ZTogIm1pbmkiLA0KICAgICAgICBhZGRpdGlvbmFsTW9kZWw6IFtDdXN0b21Db250ZW50UGFkUHJvdmlkZXIsIEN1c3RvbVBhbGV0dGVQcm92aWRlcl0NCiAgICAgIH0sDQogICAgICBhZGRpczogew0KICAgICAgICBDdXN0b21Db250ZW50UGFkUHJvdmlkZXIsDQogICAgICAgIEN1c3RvbVBhbGV0dGVQcm92aWRlcg0KICAgICAgfSwNCiAgICAgIC8vIOa1geeoi+aooeWei+eahOS/oeaBrw0KICAgICAgbW9kZWw6IHt9LA0KICAgIH07DQogIH0sDQogIGNyZWF0ZWQoKSB7DQogICAgLy8g5aaC5p6cIG1vZGVsSWQg6Z2e56m677yM6K+05piO5piv5L+u5pS55rWB56iL5qih5Z6LDQogICAgY29uc3QgbW9kZWxJZCA9IHRoaXMuJHJvdXRlLnF1ZXJ5ICYmIHRoaXMuJHJvdXRlLnF1ZXJ5Lm1vZGVsSWQNCiAgICBpZiAobW9kZWxJZCkgew0KICAgICAgZ2V0TW9kZWwobW9kZWxJZCkudGhlbihyZXNwb25zZSA9PiB7DQogICAgICAgIHRoaXMueG1sU3RyaW5nID0gcmVzcG9uc2UuZGF0YS5icG1uWG1sDQogICAgICAgIHRoaXMubW9kZWwgPSB7DQogICAgICAgICAgLi4ucmVzcG9uc2UuZGF0YSwNCiAgICAgICAgICBicG1uWG1sOiB1bmRlZmluZWQsIC8vIOa4heepuiBicG1uWG1sIOWxnuaApw0KICAgICAgICB9DQogICAgICAgIC8vIHRoaXMuY29udHJvbEZvcm0ucHJvY2Vzc0lkID0gcmVzcG9uc2UuZGF0YS5rZXkNCiAgICAgIH0pDQogICAgfQ0KICB9LA0KICBtZXRob2RzOiB7DQogICAgaW5pdE1vZGVsZXIobW9kZWxlcikgew0KICAgICAgc2V0VGltZW91dCgoKSA9PiB7DQogICAgICAgIHRoaXMubW9kZWxlciA9IG1vZGVsZXI7DQogICAgICAgIGNvbnNvbGUubG9nKG1vZGVsZXIpOw0KICAgICAgfSwgMTApOw0KICAgIH0sDQogICAgc2F2ZShicG1uWG1sKSB7DQogICAgICBjb25zdCBkYXRhID0gew0KICAgICAgICAuLi50aGlzLm1vZGVsLA0KICAgICAgICBicG1uWG1sOiBicG1uWG1sLCAvLyB0aGlzLmJwbW5YbWwg5Y+q5piv5Yid5aeL5YyW5rWB56iL5Zu+77yM5ZCO57ut5L+u5pS55peg5rOV6YCa6L+H5a6D6I635b6XDQogICAgICB9DQoNCiAgICAgIC8vIOS/ruaUueeahOaPkOS6pA0KICAgICAgaWYgKGRhdGEuaWQpIHsNCiAgICAgICAgdXBkYXRlTW9kZWwoZGF0YSkudGhlbihyZXNwb25zZSA9PiB7DQogICAgICAgICAgdGhpcy4kbW9kYWwubXNnU3VjY2Vzcygi5L+u5pS55oiQ5YqfIikNCiAgICAgICAgICAvLyDot7Povazlm57ljrsNCiAgICAgICAgICB0aGlzLmNsb3NlKCkNCiAgICAgICAgfSkNCiAgICAgICAgcmV0dXJuDQogICAgICB9DQogICAgICAvLyDmt7vliqDnmoTmj5DkuqQNCiAgICAgIGNyZWF0ZU1vZGVsKGRhdGEpLnRoZW4ocmVzcG9uc2UgPT4gew0KICAgICAgICB0aGlzLiRtb2RhbC5tc2dTdWNjZXNzKCLkv53lrZjmiJDlip8iKQ0KICAgICAgICAvLyDot7Povazlm57ljrsNCiAgICAgICAgdGhpcy5jbG9zZSgpDQogICAgICB9KQ0KICAgIH0sDQogICAgLyoqIOWFs+mXreaMiemSriAqLw0KICAgIGNsb3NlKCkgew0KICAgICAgdGhpcy4kdGFiLmNsb3NlT3BlblBhZ2UoeyBwYXRoOiAiL2JwbS9tYW5hZ2VyL21vZGVsIiB9KTsNCiAgICB9LA0KICB9DQp9Ow0K"},{"version":3,"sources":["modelEditor.vue"],"names":[],"mappings":";AAgBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"modelEditor.vue","sourceRoot":"src/views/bpm/model","sourcesContent":["<template>\r\n  <div class=\"app-container\">\r\n\r\n    <!-- 流程设计器，负责绘制流程等 -->\r\n    <my-process-designer v-if=\"xmlString !== undefined\" :key=\"`designer-${reloadIndex}`\" v-model=\"xmlString\" v-bind=\"controlForm\"\r\n      keyboard ref=\"processDesigner\" @init-finished=\"initModeler\"\r\n      @save=\"save\"/>\r\n\r\n    <!-- 流程属性器，负责编辑每个流程节点的属性 -->\r\n    <my-properties-panel :key=\"`penal-${reloadIndex}`\" :bpmn-modeler=\"modeler\" :prefix=\"controlForm.prefix\" class=\"process-panel\"\r\n      :model=\"model\" />\r\n\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport translations from \"@/components/bpmnProcessDesigner/src/translations\";\r\n// 自定义元素选中时的弹出菜单（修改 默认任务 为 用户任务）\r\nimport CustomContentPadProvider from \"@/components/bpmnProcessDesigner/package/designer/plugins/content-pad\";\r\n// 自定义左侧菜单（修改 默认任务 为 用户任务）\r\nimport CustomPaletteProvider from \"@/components/bpmnProcessDesigner/package/designer/plugins/palette\";\r\n// import xmlObj2json from \"./utils/xml2json\";\r\nimport MyProcessPalette from \"@/components/bpmnProcessDesigner/package/palette/ProcessPalette\";\r\nimport {createModel, getModel, updateModel} from \"@/api/bpm/model\";\r\n// 自定义侧边栏\r\n// import MyProcessPanel from \"../package/process-panel/ProcessPanel\";\r\n\r\nexport default {\r\n  name: \"BpmModelEditor\",\r\n  components: { MyProcessPalette },\r\n  data() {\r\n    return {\r\n      xmlString: undefined, // BPMN XML\r\n      modeler: null,\r\n      reloadIndex: 0,\r\n      controlDrawerVisible: false,\r\n      translationsSelf: translations,\r\n      controlForm: {\r\n        simulation: true,\r\n        labelEditing: false,\r\n        labelVisible: false,\r\n        prefix: \"flowable\",\r\n        headerButtonSize: \"mini\",\r\n        additionalModel: [CustomContentPadProvider, CustomPaletteProvider]\r\n      },\r\n      addis: {\r\n        CustomContentPadProvider,\r\n        CustomPaletteProvider\r\n      },\r\n      // 流程模型的信息\r\n      model: {},\r\n    };\r\n  },\r\n  created() {\r\n    // 如果 modelId 非空，说明是修改流程模型\r\n    const modelId = this.$route.query && this.$route.query.modelId\r\n    if (modelId) {\r\n      getModel(modelId).then(response => {\r\n        this.xmlString = response.data.bpmnXml\r\n        this.model = {\r\n          ...response.data,\r\n          bpmnXml: undefined, // 清空 bpmnXml 属性\r\n        }\r\n        // this.controlForm.processId = response.data.key\r\n      })\r\n    }\r\n  },\r\n  methods: {\r\n    initModeler(modeler) {\r\n      setTimeout(() => {\r\n        this.modeler = modeler;\r\n        console.log(modeler);\r\n      }, 10);\r\n    },\r\n    save(bpmnXml) {\r\n      const data = {\r\n        ...this.model,\r\n        bpmnXml: bpmnXml, // this.bpmnXml 只是初始化流程图，后续修改无法通过它获得\r\n      }\r\n\r\n      // 修改的提交\r\n      if (data.id) {\r\n        updateModel(data).then(response => {\r\n          this.$modal.msgSuccess(\"修改成功\")\r\n          // 跳转回去\r\n          this.close()\r\n        })\r\n        return\r\n      }\r\n      // 添加的提交\r\n      createModel(data).then(response => {\r\n        this.$modal.msgSuccess(\"保存成功\")\r\n        // 跳转回去\r\n        this.close()\r\n      })\r\n    },\r\n    /** 关闭按钮 */\r\n    close() {\r\n      this.$tab.closeOpenPage({ path: \"/bpm/manager/model\" });\r\n    },\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n//body {\r\n//  overflow: hidden;\r\n//  margin: 0;\r\n//  box-sizing: border-box;\r\n//}\r\n//.app {\r\n//  width: 100%;\r\n//  height: 100%;\r\n//  box-sizing: border-box;\r\n//  display: inline-grid;\r\n//  grid-template-columns: 100px auto max-content;\r\n//}\r\n.demo-control-bar {\r\n  position: fixed;\r\n  right: 8px;\r\n  bottom: 8px;\r\n  z-index: 1;\r\n  .open-control-dialog {\r\n    width: 48px;\r\n    height: 48px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    border-radius: 4px;\r\n    font-size: 32px;\r\n    background: rgba(64, 158, 255, 1);\r\n    color: #ffffff;\r\n    cursor: pointer;\r\n  }\r\n}\r\n\r\n// TODO 芋艿：去掉多余的 faq\r\n//.info-tip {\r\n//  position: fixed;\r\n//  top: 40px;\r\n//  right: 500px;\r\n//  z-index: 10;\r\n//  color: #999999;\r\n//}\r\n\r\n.control-form {\r\n  .el-radio {\r\n    width: 100%;\r\n    line-height: 32px;\r\n  }\r\n}\r\n.element-overlays {\r\n  box-sizing: border-box;\r\n  padding: 8px;\r\n  background: rgba(0, 0, 0, 0.6);\r\n  border-radius: 4px;\r\n  color: #fafafa;\r\n}\r\n\r\n.my-process-designer {\r\n  height: calc(100vh - 84px);\r\n}\r\n.process-panel__container {\r\n  position: absolute;\r\n  right: 0;\r\n  top: 55px;\r\n  height: calc(100vh - 84px);\r\n}\r\n\r\n</style>\r\n"]}]}