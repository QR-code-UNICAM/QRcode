{"remainingRequest":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\src\\views\\bpm\\model\\modelEditor.vue?vue&type=style&index=0&id=3232eb94&lang=scss","dependencies":[{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\src\\views\\bpm\\model\\modelEditor.vue","mtime":1704630437841},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQovL2JvZHkgew0KLy8gIG92ZXJmbG93OiBoaWRkZW47DQovLyAgbWFyZ2luOiAwOw0KLy8gIGJveC1zaXppbmc6IGJvcmRlci1ib3g7DQovL30NCi8vLmFwcCB7DQovLyAgd2lkdGg6IDEwMCU7DQovLyAgaGVpZ2h0OiAxMDAlOw0KLy8gIGJveC1zaXppbmc6IGJvcmRlci1ib3g7DQovLyAgZGlzcGxheTogaW5saW5lLWdyaWQ7DQovLyAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxMDBweCBhdXRvIG1heC1jb250ZW50Ow0KLy99DQouZGVtby1jb250cm9sLWJhciB7DQogIHBvc2l0aW9uOiBmaXhlZDsNCiAgcmlnaHQ6IDhweDsNCiAgYm90dG9tOiA4cHg7DQogIHotaW5kZXg6IDE7DQogIC5vcGVuLWNvbnRyb2wtZGlhbG9nIHsNCiAgICB3aWR0aDogNDhweDsNCiAgICBoZWlnaHQ6IDQ4cHg7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOw0KICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICBmb250LXNpemU6IDMycHg7DQogICAgYmFja2dyb3VuZDogcmdiYSg2NCwgMTU4LCAyNTUsIDEpOw0KICAgIGNvbG9yOiAjZmZmZmZmOw0KICAgIGN1cnNvcjogcG9pbnRlcjsNCiAgfQ0KfQ0KDQovLyBUT0RPIOiKi+iJv++8muWOu+aOieWkmuS9meeahCBmYXENCi8vLmluZm8tdGlwIHsNCi8vICBwb3NpdGlvbjogZml4ZWQ7DQovLyAgdG9wOiA0MHB4Ow0KLy8gIHJpZ2h0OiA1MDBweDsNCi8vICB6LWluZGV4OiAxMDsNCi8vICBjb2xvcjogIzk5OTk5OTsNCi8vfQ0KDQouY29udHJvbC1mb3JtIHsNCiAgLmVsLXJhZGlvIHsNCiAgICB3aWR0aDogMTAwJTsNCiAgICBsaW5lLWhlaWdodDogMzJweDsNCiAgfQ0KfQ0KLmVsZW1lbnQtb3ZlcmxheXMgew0KICBib3gtc2l6aW5nOiBib3JkZXItYm94Ow0KICBwYWRkaW5nOiA4cHg7DQogIGJhY2tncm91bmQ6IHJnYmEoMCwgMCwgMCwgMC42KTsNCiAgYm9yZGVyLXJhZGl1czogNHB4Ow0KICBjb2xvcjogI2ZhZmFmYTsNCn0NCg0KLm15LXByb2Nlc3MtZGVzaWduZXIgew0KICBoZWlnaHQ6IGNhbGMoMTAwdmggLSA4NHB4KTsNCn0NCi5wcm9jZXNzLXBhbmVsX19jb250YWluZXIgew0KICBwb3NpdGlvbjogYWJzb2x1dGU7DQogIHJpZ2h0OiAwOw0KICB0b3A6IDU1cHg7DQogIGhlaWdodDogY2FsYygxMDB2aCAtIDg0cHgpOw0KfQ0KDQo="},{"version":3,"sources":["modelEditor.vue"],"names":[],"mappings":";AAyGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"modelEditor.vue","sourceRoot":"src/views/bpm/model","sourcesContent":["<template>\r\n  <div class=\"app-container\">\r\n\r\n    <!-- 流程设计器，负责绘制流程等 -->\r\n    <my-process-designer v-if=\"xmlString !== undefined\" :key=\"`designer-${reloadIndex}`\" v-model=\"xmlString\" v-bind=\"controlForm\"\r\n      keyboard ref=\"processDesigner\" @init-finished=\"initModeler\"\r\n      @save=\"save\"/>\r\n\r\n    <!-- 流程属性器，负责编辑每个流程节点的属性 -->\r\n    <my-properties-panel :key=\"`penal-${reloadIndex}`\" :bpmn-modeler=\"modeler\" :prefix=\"controlForm.prefix\" class=\"process-panel\"\r\n      :model=\"model\" />\r\n\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport translations from \"@/components/bpmnProcessDesigner/src/translations\";\r\n// 自定义元素选中时的弹出菜单（修改 默认任务 为 用户任务）\r\nimport CustomContentPadProvider from \"@/components/bpmnProcessDesigner/package/designer/plugins/content-pad\";\r\n// 自定义左侧菜单（修改 默认任务 为 用户任务）\r\nimport CustomPaletteProvider from \"@/components/bpmnProcessDesigner/package/designer/plugins/palette\";\r\n// import xmlObj2json from \"./utils/xml2json\";\r\nimport MyProcessPalette from \"@/components/bpmnProcessDesigner/package/palette/ProcessPalette\";\r\nimport {createModel, getModel, updateModel} from \"@/api/bpm/model\";\r\n// 自定义侧边栏\r\n// import MyProcessPanel from \"../package/process-panel/ProcessPanel\";\r\n\r\nexport default {\r\n  name: \"BpmModelEditor\",\r\n  components: { MyProcessPalette },\r\n  data() {\r\n    return {\r\n      xmlString: undefined, // BPMN XML\r\n      modeler: null,\r\n      reloadIndex: 0,\r\n      controlDrawerVisible: false,\r\n      translationsSelf: translations,\r\n      controlForm: {\r\n        simulation: true,\r\n        labelEditing: false,\r\n        labelVisible: false,\r\n        prefix: \"flowable\",\r\n        headerButtonSize: \"mini\",\r\n        additionalModel: [CustomContentPadProvider, CustomPaletteProvider]\r\n      },\r\n      addis: {\r\n        CustomContentPadProvider,\r\n        CustomPaletteProvider\r\n      },\r\n      // 流程模型的信息\r\n      model: {},\r\n    };\r\n  },\r\n  created() {\r\n    // 如果 modelId 非空，说明是修改流程模型\r\n    const modelId = this.$route.query && this.$route.query.modelId\r\n    if (modelId) {\r\n      getModel(modelId).then(response => {\r\n        this.xmlString = response.data.bpmnXml\r\n        this.model = {\r\n          ...response.data,\r\n          bpmnXml: undefined, // 清空 bpmnXml 属性\r\n        }\r\n        // this.controlForm.processId = response.data.key\r\n      })\r\n    }\r\n  },\r\n  methods: {\r\n    initModeler(modeler) {\r\n      setTimeout(() => {\r\n        this.modeler = modeler;\r\n        console.log(modeler);\r\n      }, 10);\r\n    },\r\n    save(bpmnXml) {\r\n      const data = {\r\n        ...this.model,\r\n        bpmnXml: bpmnXml, // this.bpmnXml 只是初始化流程图，后续修改无法通过它获得\r\n      }\r\n\r\n      // 修改的提交\r\n      if (data.id) {\r\n        updateModel(data).then(response => {\r\n          this.$modal.msgSuccess(\"修改成功\")\r\n          // 跳转回去\r\n          this.close()\r\n        })\r\n        return\r\n      }\r\n      // 添加的提交\r\n      createModel(data).then(response => {\r\n        this.$modal.msgSuccess(\"保存成功\")\r\n        // 跳转回去\r\n        this.close()\r\n      })\r\n    },\r\n    /** 关闭按钮 */\r\n    close() {\r\n      this.$tab.closeOpenPage({ path: \"/bpm/manager/model\" });\r\n    },\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n//body {\r\n//  overflow: hidden;\r\n//  margin: 0;\r\n//  box-sizing: border-box;\r\n//}\r\n//.app {\r\n//  width: 100%;\r\n//  height: 100%;\r\n//  box-sizing: border-box;\r\n//  display: inline-grid;\r\n//  grid-template-columns: 100px auto max-content;\r\n//}\r\n.demo-control-bar {\r\n  position: fixed;\r\n  right: 8px;\r\n  bottom: 8px;\r\n  z-index: 1;\r\n  .open-control-dialog {\r\n    width: 48px;\r\n    height: 48px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    border-radius: 4px;\r\n    font-size: 32px;\r\n    background: rgba(64, 158, 255, 1);\r\n    color: #ffffff;\r\n    cursor: pointer;\r\n  }\r\n}\r\n\r\n// TODO 芋艿：去掉多余的 faq\r\n//.info-tip {\r\n//  position: fixed;\r\n//  top: 40px;\r\n//  right: 500px;\r\n//  z-index: 10;\r\n//  color: #999999;\r\n//}\r\n\r\n.control-form {\r\n  .el-radio {\r\n    width: 100%;\r\n    line-height: 32px;\r\n  }\r\n}\r\n.element-overlays {\r\n  box-sizing: border-box;\r\n  padding: 8px;\r\n  background: rgba(0, 0, 0, 0.6);\r\n  border-radius: 4px;\r\n  color: #fafafa;\r\n}\r\n\r\n.my-process-designer {\r\n  height: calc(100vh - 84px);\r\n}\r\n.process-panel__container {\r\n  position: absolute;\r\n  right: 0;\r\n  top: 55px;\r\n  height: calc(100vh - 84px);\r\n}\r\n\r\n</style>\r\n"]}]}