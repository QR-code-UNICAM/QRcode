{"remainingRequest":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\src\\components\\bpmnProcessDesigner\\package\\penal\\task\\task-components\\ScriptTask.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\src\\components\\bpmnProcessDesigner\\package\\penal\\task\\task-components\\ScriptTask.vue","mtime":1704630437729},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\89425\\IdeaProjects\\qr-code-vue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICJTY3JpcHRUYXNrIiwNCiAgcHJvcHM6IHsNCiAgICBpZDogU3RyaW5nLA0KICAgIHR5cGU6IFN0cmluZw0KICB9LA0KICBkYXRhKCkgew0KICAgIHJldHVybiB7DQogICAgICBkZWZhdWx0VGFza0Zvcm06IHsNCiAgICAgICAgc2NyaXB0Rm9ybWF0OiAiIiwNCiAgICAgICAgc2NyaXB0OiAiIiwNCiAgICAgICAgcmVzb3VyY2U6ICIiLA0KICAgICAgICByZXN1bHRWYXJpYWJsZTogIiINCiAgICAgIH0sDQogICAgICBzY3JpcHRUYXNrRm9ybToge30NCiAgICB9Ow0KICB9LA0KICB3YXRjaDogew0KICAgIGlkOiB7DQogICAgICBpbW1lZGlhdGU6IHRydWUsDQogICAgICBoYW5kbGVyKCkgew0KICAgICAgICB0aGlzLmJwbW5FbGVtZW50ID0gd2luZG93LmJwbW5JbnN0YW5jZXMuYnBtbkVsZW1lbnQ7DQogICAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHRoaXMucmVzZXRUYXNrRm9ybSgpKTsNCiAgICAgIH0NCiAgICB9DQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICByZXNldFRhc2tGb3JtKCkgew0KICAgICAgZm9yIChsZXQga2V5IGluIHRoaXMuZGVmYXVsdFRhc2tGb3JtKSB7DQogICAgICAgIGxldCB2YWx1ZSA9IHRoaXMuYnBtbkVsZW1lbnQ/LmJ1c2luZXNzT2JqZWN0W2tleV0gfHwgdGhpcy5kZWZhdWx0VGFza0Zvcm1ba2V5XTsNCiAgICAgICAgdGhpcy4kc2V0KHRoaXMuc2NyaXB0VGFza0Zvcm0sIGtleSwgdmFsdWUpOw0KICAgICAgfQ0KICAgICAgdGhpcy4kc2V0KHRoaXMuc2NyaXB0VGFza0Zvcm0sICJzY3JpcHRUeXBlIiwgdGhpcy5zY3JpcHRUYXNrRm9ybS5zY3JpcHQgPyAiaW5saW5lIiA6ICJleHRlcm5hbCIpOw0KICAgIH0sDQogICAgdXBkYXRlRWxlbWVudFRhc2soKSB7DQogICAgICBsZXQgdGFza0F0dHIgPSBPYmplY3QuY3JlYXRlKG51bGwpOw0KICAgICAgdGFza0F0dHIuc2NyaXB0Rm9ybWF0ID0gdGhpcy5zY3JpcHRUYXNrRm9ybS5zY3JpcHRGb3JtYXQgfHwgbnVsbDsNCiAgICAgIHRhc2tBdHRyLnJlc3VsdFZhcmlhYmxlID0gdGhpcy5zY3JpcHRUYXNrRm9ybS5yZXN1bHRWYXJpYWJsZSB8fCBudWxsOw0KICAgICAgaWYgKHRoaXMuc2NyaXB0VGFza0Zvcm0uc2NyaXB0VHlwZSA9PT0gImlubGluZSIpIHsNCiAgICAgICAgdGFza0F0dHIuc2NyaXB0ID0gdGhpcy5zY3JpcHRUYXNrRm9ybS5zY3JpcHQgfHwgbnVsbDsNCiAgICAgICAgdGFza0F0dHIucmVzb3VyY2UgPSBudWxsOw0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgdGFza0F0dHIucmVzb3VyY2UgPSB0aGlzLnNjcmlwdFRhc2tGb3JtLnJlc291cmNlIHx8IG51bGw7DQogICAgICAgIHRhc2tBdHRyLnNjcmlwdCA9IG51bGw7DQogICAgICB9DQogICAgICB3aW5kb3cuYnBtbkluc3RhbmNlcy5tb2RlbGluZy51cGRhdGVQcm9wZXJ0aWVzKHRoaXMuYnBtbkVsZW1lbnQsIHRhc2tBdHRyKTsNCiAgICB9DQogIH0sDQogIGJlZm9yZURlc3Ryb3koKSB7DQogICAgdGhpcy5icG1uRWxlbWVudCA9IG51bGw7DQogIH0NCn07DQo="},{"version":3,"sources":["ScriptTask.vue"],"names":[],"mappings":";AAgCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ScriptTask.vue","sourceRoot":"src/components/bpmnProcessDesigner/package/penal/task/task-components","sourcesContent":["<template>\r\n  <div style=\"margin-top: 16px\">\r\n    <el-form-item label=\"脚本格式\">\r\n      <el-input v-model=\"scriptTaskForm.scriptFormat\" clearable @input=\"updateElementTask()\" @change=\"updateElementTask()\" />\r\n    </el-form-item>\r\n    <el-form-item label=\"脚本类型\">\r\n      <el-select v-model=\"scriptTaskForm.scriptType\">\r\n        <el-option label=\"内联脚本\" value=\"inline\" />\r\n        <el-option label=\"外部资源\" value=\"external\" />\r\n      </el-select>\r\n    </el-form-item>\r\n    <el-form-item label=\"脚本\" v-show=\"scriptTaskForm.scriptType === 'inline'\">\r\n      <el-input\r\n        v-model=\"scriptTaskForm.script\"\r\n        type=\"textarea\"\r\n        resize=\"vertical\"\r\n        :autosize=\"{ minRows: 2, maxRows: 4 }\"\r\n        clearable\r\n        @input=\"updateElementTask()\"\r\n        @change=\"updateElementTask()\"\r\n      />\r\n    </el-form-item>\r\n    <el-form-item label=\"资源地址\" v-show=\"scriptTaskForm.scriptType === 'external'\">\r\n      <el-input v-model=\"scriptTaskForm.resource\" clearable @input=\"updateElementTask()\" @change=\"updateElementTask()\" />\r\n    </el-form-item>\r\n    <el-form-item label=\"结果变量\">\r\n      <el-input v-model=\"scriptTaskForm.resultVariable\" clearable @input=\"updateElementTask()\" @change=\"updateElementTask()\" />\r\n    </el-form-item>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: \"ScriptTask\",\r\n  props: {\r\n    id: String,\r\n    type: String\r\n  },\r\n  data() {\r\n    return {\r\n      defaultTaskForm: {\r\n        scriptFormat: \"\",\r\n        script: \"\",\r\n        resource: \"\",\r\n        resultVariable: \"\"\r\n      },\r\n      scriptTaskForm: {}\r\n    };\r\n  },\r\n  watch: {\r\n    id: {\r\n      immediate: true,\r\n      handler() {\r\n        this.bpmnElement = window.bpmnInstances.bpmnElement;\r\n        this.$nextTick(() => this.resetTaskForm());\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    resetTaskForm() {\r\n      for (let key in this.defaultTaskForm) {\r\n        let value = this.bpmnElement?.businessObject[key] || this.defaultTaskForm[key];\r\n        this.$set(this.scriptTaskForm, key, value);\r\n      }\r\n      this.$set(this.scriptTaskForm, \"scriptType\", this.scriptTaskForm.script ? \"inline\" : \"external\");\r\n    },\r\n    updateElementTask() {\r\n      let taskAttr = Object.create(null);\r\n      taskAttr.scriptFormat = this.scriptTaskForm.scriptFormat || null;\r\n      taskAttr.resultVariable = this.scriptTaskForm.resultVariable || null;\r\n      if (this.scriptTaskForm.scriptType === \"inline\") {\r\n        taskAttr.script = this.scriptTaskForm.script || null;\r\n        taskAttr.resource = null;\r\n      } else {\r\n        taskAttr.resource = this.scriptTaskForm.resource || null;\r\n        taskAttr.script = null;\r\n      }\r\n      window.bpmnInstances.modeling.updateProperties(this.bpmnElement, taskAttr);\r\n    }\r\n  },\r\n  beforeDestroy() {\r\n    this.bpmnElement = null;\r\n  }\r\n};\r\n</script>\r\n"]}]}